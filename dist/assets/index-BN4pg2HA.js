var Ip=Object.defineProperty;var Dp=(t,e,r)=>e in t?Ip(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Me=(t,e,r)=>Dp(t,typeof e!="symbol"?e+"":e,r);function Oh(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();function Lp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Up(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var Ah={exports:{}},zi={},Ih={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oo=Symbol.for("react.element"),$p=Symbol.for("react.portal"),Mp=Symbol.for("react.fragment"),Bp=Symbol.for("react.strict_mode"),Fp=Symbol.for("react.profiler"),zp=Symbol.for("react.provider"),Wp=Symbol.for("react.context"),Vp=Symbol.for("react.forward_ref"),Gp=Symbol.for("react.suspense"),Hp=Symbol.for("react.memo"),qp=Symbol.for("react.lazy"),ju=Symbol.iterator;function Kp(t){return t===null||typeof t!="object"?null:(t=ju&&t[ju]||t["@@iterator"],typeof t=="function"?t:null)}var Dh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lh=Object.assign,Uh={};function ts(t,e,r){this.props=t,this.context=e,this.refs=Uh,this.updater=r||Dh}ts.prototype.isReactComponent={};ts.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ts.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $h(){}$h.prototype=ts.prototype;function gc(t,e,r){this.props=t,this.context=e,this.refs=Uh,this.updater=r||Dh}var pc=gc.prototype=new $h;pc.constructor=gc;Lh(pc,ts.prototype);pc.isPureReactComponent=!0;var Cu=Array.isArray,Mh=Object.prototype.hasOwnProperty,vc={current:null},Bh={key:!0,ref:!0,__self:!0,__source:!0};function Fh(t,e,r){var n,s={},o=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Mh.call(e,n)&&!Bh.hasOwnProperty(n)&&(s[n]=e[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:oo,type:t,key:o,ref:i,props:s,_owner:vc.current}}function Jp(t,e){return{$$typeof:oo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function yc(t){return typeof t=="object"&&t!==null&&t.$$typeof===oo}function Qp(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Nu=/\/+/g;function ma(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Qp(""+t.key):e.toString(36)}function Ko(t,e,r,n,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case oo:case $p:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+ma(i,0):n,Cu(s)?(r="",t!=null&&(r=t.replace(Nu,"$&/")+"/"),Ko(s,e,r,"",function(u){return u})):s!=null&&(yc(s)&&(s=Jp(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Nu,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Cu(t))for(var a=0;a<t.length;a++){o=t[a];var c=n+ma(o,a);i+=Ko(o,e,r,c,s)}else if(c=Kp(t),typeof c=="function")for(t=c.call(t),a=0;!(o=t.next()).done;)o=o.value,c=n+ma(o,a++),i+=Ko(o,e,r,c,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function yo(t,e,r){if(t==null)return t;var n=[],s=0;return Ko(t,n,"","",function(o){return e.call(r,o,s++)}),n}function Yp(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var nt={current:null},Jo={transition:null},Xp={ReactCurrentDispatcher:nt,ReactCurrentBatchConfig:Jo,ReactCurrentOwner:vc};function zh(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:yo,forEach:function(t,e,r){yo(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return yo(t,function(){e++}),e},toArray:function(t){return yo(t,function(e){return e})||[]},only:function(t){if(!yc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=ts;se.Fragment=Mp;se.Profiler=Fp;se.PureComponent=gc;se.StrictMode=Bp;se.Suspense=Gp;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xp;se.act=zh;se.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Lh({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=vc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Mh.call(e,c)&&!Bh.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:oo,type:t.type,key:s,ref:o,props:n,_owner:i}};se.createContext=function(t){return t={$$typeof:Wp,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zp,_context:t},t.Consumer=t};se.createElement=Fh;se.createFactory=function(t){var e=Fh.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:Vp,render:t}};se.isValidElement=yc;se.lazy=function(t){return{$$typeof:qp,_payload:{_status:-1,_result:t},_init:Yp}};se.memo=function(t,e){return{$$typeof:Hp,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=Jo.transition;Jo.transition={};try{t()}finally{Jo.transition=e}};se.unstable_act=zh;se.useCallback=function(t,e){return nt.current.useCallback(t,e)};se.useContext=function(t){return nt.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return nt.current.useDeferredValue(t)};se.useEffect=function(t,e){return nt.current.useEffect(t,e)};se.useId=function(){return nt.current.useId()};se.useImperativeHandle=function(t,e,r){return nt.current.useImperativeHandle(t,e,r)};se.useInsertionEffect=function(t,e){return nt.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return nt.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return nt.current.useMemo(t,e)};se.useReducer=function(t,e,r){return nt.current.useReducer(t,e,r)};se.useRef=function(t){return nt.current.useRef(t)};se.useState=function(t){return nt.current.useState(t)};se.useSyncExternalStore=function(t,e,r){return nt.current.useSyncExternalStore(t,e,r)};se.useTransition=function(){return nt.current.useTransition()};se.version="18.3.1";Ih.exports=se;var S=Ih.exports;const Wh=Lp(S),Zp=Oh({__proto__:null,default:Wh},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev=S,tv=Symbol.for("react.element"),rv=Symbol.for("react.fragment"),nv=Object.prototype.hasOwnProperty,sv=ev.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ov={key:!0,ref:!0,__self:!0,__source:!0};function Vh(t,e,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)nv.call(e,n)&&!ov.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:tv,type:t,key:o,ref:i,props:s,_owner:sv.current}}zi.Fragment=rv;zi.jsx=Vh;zi.jsxs=Vh;Ah.exports=zi;var l=Ah.exports,Gh={exports:{}},yt={},Hh={exports:{}},qh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,L){var U=T.length;T.push(L);e:for(;0<U;){var $=U-1>>>1,W=T[$];if(0<s(W,L))T[$]=L,T[U]=W,U=$;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var L=T[0],U=T.pop();if(U!==L){T[0]=U;e:for(var $=0,W=T.length,Q=W>>>1;$<Q;){var H=2*($+1)-1,he=T[H],Z=H+1,Pt=T[Z];if(0>s(he,U))Z<W&&0>s(Pt,he)?(T[$]=Pt,T[Z]=U,$=Z):(T[$]=he,T[H]=U,$=H);else if(Z<W&&0>s(Pt,U))T[$]=Pt,T[Z]=U,$=Z;else break e}}return L}function s(T,L){var U=T.sortIndex-L.sortIndex;return U!==0?U:T.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var c=[],u=[],d=1,f=null,h=3,w=!1,p=!1,b=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(T){for(var L=r(u);L!==null;){if(L.callback===null)n(u);else if(L.startTime<=T)n(u),L.sortIndex=L.expirationTime,e(c,L);else break;L=r(u)}}function _(T){if(b=!1,m(T),!p)if(r(c)!==null)p=!0,V(x);else{var L=r(u);L!==null&&re(_,L.startTime-T)}}function x(T,L){p=!1,b&&(b=!1,v(j),j=-1),w=!0;var U=h;try{for(m(L),f=r(c);f!==null&&(!(f.expirationTime>L)||T&&!M());){var $=f.callback;if(typeof $=="function"){f.callback=null,h=f.priorityLevel;var W=$(f.expirationTime<=L);L=t.unstable_now(),typeof W=="function"?f.callback=W:f===r(c)&&n(c),m(L)}else n(c);f=r(c)}if(f!==null)var Q=!0;else{var H=r(u);H!==null&&re(_,H.startTime-L),Q=!1}return Q}finally{f=null,h=U,w=!1}}var k=!1,E=null,j=-1,N=5,P=-1;function M(){return!(t.unstable_now()-P<N)}function X(){if(E!==null){var T=t.unstable_now();P=T;var L=!0;try{L=E(!0,T)}finally{L?R():(k=!1,E=null)}}else k=!1}var R;if(typeof g=="function")R=function(){g(X)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,I=A.port2;A.port1.onmessage=X,R=function(){I.postMessage(null)}}else R=function(){y(X,0)};function V(T){E=T,k||(k=!0,R())}function re(T,L){j=y(function(){T(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){p||w||(p=!0,V(x))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(T){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var U=h;h=L;try{return T()}finally{h=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,L){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var U=h;h=T;try{return L()}finally{h=U}},t.unstable_scheduleCallback=function(T,L,U){var $=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?$+U:$):U=$,T){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=U+W,T={id:d++,callback:L,priorityLevel:T,startTime:U,expirationTime:W,sortIndex:-1},U>$?(T.sortIndex=U,e(u,T),r(c)===null&&T===r(u)&&(b?(v(j),j=-1):b=!0,re(_,U-$))):(T.sortIndex=W,e(c,T),p||w||(p=!0,V(x))),T},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(T){var L=h;return function(){var U=h;h=L;try{return T.apply(this,arguments)}finally{h=U}}}})(qh);Hh.exports=qh;var iv=Hh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av=S,vt=iv;function D(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kh=new Set,Us={};function ln(t,e){Vn(t,e),Vn(t+"Capture",e)}function Vn(t,e){for(Us[t]=e,t=0;t<e.length;t++)Kh.add(e[t])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tl=Object.prototype.hasOwnProperty,lv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pu={},Tu={};function cv(t){return tl.call(Tu,t)?!0:tl.call(Pu,t)?!1:lv.test(t)?Tu[t]=!0:(Pu[t]=!0,!1)}function uv(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function dv(t,e,r,n){if(e===null||typeof e>"u"||uv(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function st(t,e,r,n,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ge={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ge[t]=new st(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ge[e]=new st(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ge[t]=new st(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ge[t]=new st(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ge[t]=new st(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ge[t]=new st(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ge[t]=new st(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ge[t]=new st(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ge[t]=new st(t,5,!1,t.toLowerCase(),null,!1,!1)});var wc=/[\-:]([a-z])/g;function _c(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wc,_c);Ge[e]=new st(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wc,_c);Ge[e]=new st(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wc,_c);Ge[e]=new st(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ge[t]=new st(t,1,!1,t.toLowerCase(),null,!1,!1)});Ge.xlinkHref=new st("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ge[t]=new st(t,1,!1,t.toLowerCase(),null,!0,!0)});function bc(t,e,r,n){var s=Ge.hasOwnProperty(e)?Ge[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(dv(e,r,s,n)&&(r=null),n||s===null?cv(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ir=av.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wo=Symbol.for("react.element"),kn=Symbol.for("react.portal"),En=Symbol.for("react.fragment"),Sc=Symbol.for("react.strict_mode"),rl=Symbol.for("react.profiler"),Jh=Symbol.for("react.provider"),Qh=Symbol.for("react.context"),xc=Symbol.for("react.forward_ref"),nl=Symbol.for("react.suspense"),sl=Symbol.for("react.suspense_list"),kc=Symbol.for("react.memo"),fr=Symbol.for("react.lazy"),Yh=Symbol.for("react.offscreen"),Ru=Symbol.iterator;function cs(t){return t===null||typeof t!="object"?null:(t=Ru&&t[Ru]||t["@@iterator"],typeof t=="function"?t:null)}var xe=Object.assign,ga;function ws(t){if(ga===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ga=e&&e[1]||""}return`
`+ga+t}var pa=!1;function va(t,e){if(!t||pa)return"";pa=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=n.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var c=`
`+s[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=a);break}}}finally{pa=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ws(t):""}function hv(t){switch(t.tag){case 5:return ws(t.type);case 16:return ws("Lazy");case 13:return ws("Suspense");case 19:return ws("SuspenseList");case 0:case 2:case 15:return t=va(t.type,!1),t;case 11:return t=va(t.type.render,!1),t;case 1:return t=va(t.type,!0),t;default:return""}}function ol(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case En:return"Fragment";case kn:return"Portal";case rl:return"Profiler";case Sc:return"StrictMode";case nl:return"Suspense";case sl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qh:return(t.displayName||"Context")+".Consumer";case Jh:return(t._context.displayName||"Context")+".Provider";case xc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case kc:return e=t.displayName||null,e!==null?e:ol(t.type)||"Memo";case fr:e=t._payload,t=t._init;try{return ol(t(e))}catch{}}return null}function fv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ol(e);case 8:return e===Sc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ar(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Xh(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function mv(t){var e=Xh(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function _o(t){t._valueTracker||(t._valueTracker=mv(t))}function Zh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Xh(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function ci(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function il(t,e){var r=e.checked;return xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Ou(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ar(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ef(t,e){e=e.checked,e!=null&&bc(t,"checked",e,!1)}function al(t,e){ef(t,e);var r=Ar(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ll(t,e.type,r):e.hasOwnProperty("defaultValue")&&ll(t,e.type,Ar(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Au(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ll(t,e,r){(e!=="number"||ci(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var _s=Array.isArray;function Ln(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ar(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function cl(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(D(91));return xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Iu(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(D(92));if(_s(r)){if(1<r.length)throw Error(D(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ar(r)}}function tf(t,e){var r=Ar(e.value),n=Ar(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Du(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ul(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bo,nf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bo=bo||document.createElement("div"),bo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $s(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gv=["Webkit","ms","Moz","O"];Object.keys(Es).forEach(function(t){gv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Es[e]=Es[t]})});function sf(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Es.hasOwnProperty(t)&&Es[t]?(""+e).trim():e+"px"}function of(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=sf(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var pv=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dl(t,e){if(e){if(pv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(D(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(D(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(D(61))}if(e.style!=null&&typeof e.style!="object")throw Error(D(62))}}function hl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fl=null;function Ec(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ml=null,Un=null,$n=null;function Lu(t){if(t=lo(t)){if(typeof ml!="function")throw Error(D(280));var e=t.stateNode;e&&(e=qi(e),ml(t.stateNode,t.type,e))}}function af(t){Un?$n?$n.push(t):$n=[t]:Un=t}function lf(){if(Un){var t=Un,e=$n;if($n=Un=null,Lu(t),e)for(t=0;t<e.length;t++)Lu(e[t])}}function cf(t,e){return t(e)}function uf(){}var ya=!1;function df(t,e,r){if(ya)return t(e,r);ya=!0;try{return cf(t,e,r)}finally{ya=!1,(Un!==null||$n!==null)&&(uf(),lf())}}function Ms(t,e){var r=t.stateNode;if(r===null)return null;var n=qi(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(D(231,e,typeof r));return r}var gl=!1;if(rr)try{var us={};Object.defineProperty(us,"passive",{get:function(){gl=!0}}),window.addEventListener("test",us,us),window.removeEventListener("test",us,us)}catch{gl=!1}function vv(t,e,r,n,s,o,i,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var js=!1,ui=null,di=!1,pl=null,yv={onError:function(t){js=!0,ui=t}};function wv(t,e,r,n,s,o,i,a,c){js=!1,ui=null,vv.apply(yv,arguments)}function _v(t,e,r,n,s,o,i,a,c){if(wv.apply(this,arguments),js){if(js){var u=ui;js=!1,ui=null}else throw Error(D(198));di||(di=!0,pl=u)}}function cn(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function hf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Uu(t){if(cn(t)!==t)throw Error(D(188))}function bv(t){var e=t.alternate;if(!e){if(e=cn(t),e===null)throw Error(D(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return Uu(s),t;if(o===n)return Uu(s),e;o=o.sibling}throw Error(D(188))}if(r.return!==n.return)r=s,n=o;else{for(var i=!1,a=s.child;a;){if(a===r){i=!0,r=s,n=o;break}if(a===n){i=!0,n=s,r=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===r){i=!0,r=o,n=s;break}if(a===n){i=!0,n=o,r=s;break}a=a.sibling}if(!i)throw Error(D(189))}}if(r.alternate!==n)throw Error(D(190))}if(r.tag!==3)throw Error(D(188));return r.stateNode.current===r?t:e}function ff(t){return t=bv(t),t!==null?mf(t):null}function mf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=mf(t);if(e!==null)return e;t=t.sibling}return null}var gf=vt.unstable_scheduleCallback,$u=vt.unstable_cancelCallback,Sv=vt.unstable_shouldYield,xv=vt.unstable_requestPaint,Ne=vt.unstable_now,kv=vt.unstable_getCurrentPriorityLevel,jc=vt.unstable_ImmediatePriority,pf=vt.unstable_UserBlockingPriority,hi=vt.unstable_NormalPriority,Ev=vt.unstable_LowPriority,vf=vt.unstable_IdlePriority,Wi=null,qt=null;function jv(t){if(qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Wi,t,void 0,(t.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:Pv,Cv=Math.log,Nv=Math.LN2;function Pv(t){return t>>>=0,t===0?32:31-(Cv(t)/Nv|0)|0}var So=64,xo=4194304;function bs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fi(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,o=t.pingedLanes,i=r&268435455;if(i!==0){var a=i&~s;a!==0?n=bs(a):(o&=i,o!==0&&(n=bs(o)))}else i=r&~s,i!==0?n=bs(i):o!==0&&(n=bs(o));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-$t(e),s=1<<r,n|=t[r],e&=~s;return n}function Tv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rv(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-$t(o),a=1<<i,c=s[i];c===-1?(!(a&r)||a&n)&&(s[i]=Tv(a,e)):c<=e&&(t.expiredLanes|=a),o&=~a}}function vl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function yf(){var t=So;return So<<=1,!(So&4194240)&&(So=64),t}function wa(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function io(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$t(e),t[e]=r}function Ov(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-$t(r),o=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~o}}function Cc(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-$t(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var de=0;function wf(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _f,Nc,bf,Sf,xf,yl=!1,ko=[],Sr=null,xr=null,kr=null,Bs=new Map,Fs=new Map,pr=[],Av="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mu(t,e){switch(t){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":xr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":Bs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fs.delete(e.pointerId)}}function ds(t,e,r,n,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},e!==null&&(e=lo(e),e!==null&&Nc(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Iv(t,e,r,n,s){switch(e){case"focusin":return Sr=ds(Sr,t,e,r,n,s),!0;case"dragenter":return xr=ds(xr,t,e,r,n,s),!0;case"mouseover":return kr=ds(kr,t,e,r,n,s),!0;case"pointerover":var o=s.pointerId;return Bs.set(o,ds(Bs.get(o)||null,t,e,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Fs.set(o,ds(Fs.get(o)||null,t,e,r,n,s)),!0}return!1}function kf(t){var e=Qr(t.target);if(e!==null){var r=cn(e);if(r!==null){if(e=r.tag,e===13){if(e=hf(r),e!==null){t.blockedOn=e,xf(t.priority,function(){bf(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=wl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);fl=n,r.target.dispatchEvent(n),fl=null}else return e=lo(r),e!==null&&Nc(e),t.blockedOn=r,!1;e.shift()}return!0}function Bu(t,e,r){Qo(t)&&r.delete(e)}function Dv(){yl=!1,Sr!==null&&Qo(Sr)&&(Sr=null),xr!==null&&Qo(xr)&&(xr=null),kr!==null&&Qo(kr)&&(kr=null),Bs.forEach(Bu),Fs.forEach(Bu)}function hs(t,e){t.blockedOn===e&&(t.blockedOn=null,yl||(yl=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,Dv)))}function zs(t){function e(s){return hs(s,t)}if(0<ko.length){hs(ko[0],t);for(var r=1;r<ko.length;r++){var n=ko[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Sr!==null&&hs(Sr,t),xr!==null&&hs(xr,t),kr!==null&&hs(kr,t),Bs.forEach(e),Fs.forEach(e),r=0;r<pr.length;r++)n=pr[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<pr.length&&(r=pr[0],r.blockedOn===null);)kf(r),r.blockedOn===null&&pr.shift()}var Mn=ir.ReactCurrentBatchConfig,mi=!0;function Lv(t,e,r,n){var s=de,o=Mn.transition;Mn.transition=null;try{de=1,Pc(t,e,r,n)}finally{de=s,Mn.transition=o}}function Uv(t,e,r,n){var s=de,o=Mn.transition;Mn.transition=null;try{de=4,Pc(t,e,r,n)}finally{de=s,Mn.transition=o}}function Pc(t,e,r,n){if(mi){var s=wl(t,e,r,n);if(s===null)Pa(t,e,n,gi,r),Mu(t,n);else if(Iv(s,t,e,r,n))n.stopPropagation();else if(Mu(t,n),e&4&&-1<Av.indexOf(t)){for(;s!==null;){var o=lo(s);if(o!==null&&_f(o),o=wl(t,e,r,n),o===null&&Pa(t,e,n,gi,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else Pa(t,e,n,null,r)}}var gi=null;function wl(t,e,r,n){if(gi=null,t=Ec(n),t=Qr(t),t!==null)if(e=cn(t),e===null)t=null;else if(r=e.tag,r===13){if(t=hf(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gi=t,null}function Ef(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kv()){case jc:return 1;case pf:return 4;case hi:case Ev:return 16;case vf:return 536870912;default:return 16}default:return 16}}var wr=null,Tc=null,Yo=null;function jf(){if(Yo)return Yo;var t,e=Tc,r=e.length,n,s="value"in wr?wr.value:wr.textContent,o=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[o-n];n++);return Yo=s.slice(t,1<n?1-n:void 0)}function Xo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Eo(){return!0}function Fu(){return!1}function wt(t){function e(r,n,s,o,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Eo:Fu,this.isPropagationStopped=Fu,this}return xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),e}var rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rc=wt(rs),ao=xe({},rs,{view:0,detail:0}),$v=wt(ao),_a,ba,fs,Vi=xe({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fs&&(fs&&t.type==="mousemove"?(_a=t.screenX-fs.screenX,ba=t.screenY-fs.screenY):ba=_a=0,fs=t),_a)},movementY:function(t){return"movementY"in t?t.movementY:ba}}),zu=wt(Vi),Mv=xe({},Vi,{dataTransfer:0}),Bv=wt(Mv),Fv=xe({},ao,{relatedTarget:0}),Sa=wt(Fv),zv=xe({},rs,{animationName:0,elapsedTime:0,pseudoElement:0}),Wv=wt(zv),Vv=xe({},rs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Gv=wt(Vv),Hv=xe({},rs,{data:0}),Wu=wt(Hv),qv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Jv[t])?!!e[t]:!1}function Oc(){return Qv}var Yv=xe({},ao,{key:function(t){if(t.key){var e=qv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Kv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oc,charCode:function(t){return t.type==="keypress"?Xo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Xv=wt(Yv),Zv=xe({},Vi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vu=wt(Zv),ey=xe({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oc}),ty=wt(ey),ry=xe({},rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ny=wt(ry),sy=xe({},Vi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oy=wt(sy),iy=[9,13,27,32],Ac=rr&&"CompositionEvent"in window,Cs=null;rr&&"documentMode"in document&&(Cs=document.documentMode);var ay=rr&&"TextEvent"in window&&!Cs,Cf=rr&&(!Ac||Cs&&8<Cs&&11>=Cs),Gu=" ",Hu=!1;function Nf(t,e){switch(t){case"keyup":return iy.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jn=!1;function ly(t,e){switch(t){case"compositionend":return Pf(e);case"keypress":return e.which!==32?null:(Hu=!0,Gu);case"textInput":return t=e.data,t===Gu&&Hu?null:t;default:return null}}function cy(t,e){if(jn)return t==="compositionend"||!Ac&&Nf(t,e)?(t=jf(),Yo=Tc=wr=null,jn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cf&&e.locale!=="ko"?null:e.data;default:return null}}var uy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!uy[t.type]:e==="textarea"}function Tf(t,e,r,n){af(n),e=pi(e,"onChange"),0<e.length&&(r=new Rc("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ns=null,Ws=null;function dy(t){Ff(t,0)}function Gi(t){var e=Pn(t);if(Zh(e))return t}function hy(t,e){if(t==="change")return e}var Rf=!1;if(rr){var xa;if(rr){var ka="oninput"in document;if(!ka){var Ku=document.createElement("div");Ku.setAttribute("oninput","return;"),ka=typeof Ku.oninput=="function"}xa=ka}else xa=!1;Rf=xa&&(!document.documentMode||9<document.documentMode)}function Ju(){Ns&&(Ns.detachEvent("onpropertychange",Of),Ws=Ns=null)}function Of(t){if(t.propertyName==="value"&&Gi(Ws)){var e=[];Tf(e,Ws,t,Ec(t)),df(dy,e)}}function fy(t,e,r){t==="focusin"?(Ju(),Ns=e,Ws=r,Ns.attachEvent("onpropertychange",Of)):t==="focusout"&&Ju()}function my(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gi(Ws)}function gy(t,e){if(t==="click")return Gi(e)}function py(t,e){if(t==="input"||t==="change")return Gi(e)}function vy(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bt=typeof Object.is=="function"?Object.is:vy;function Vs(t,e){if(Bt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!tl.call(e,s)||!Bt(t[s],e[s]))return!1}return!0}function Qu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yu(t,e){var r=Qu(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qu(r)}}function Af(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Af(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function If(){for(var t=window,e=ci();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ci(t.document)}return e}function Ic(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yy(t){var e=If(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Af(r.ownerDocument.documentElement,r)){if(n!==null&&Ic(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!t.extend&&o>n&&(s=n,n=o,o=s),s=Yu(r,o);var i=Yu(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wy=rr&&"documentMode"in document&&11>=document.documentMode,Cn=null,_l=null,Ps=null,bl=!1;function Xu(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bl||Cn==null||Cn!==ci(n)||(n=Cn,"selectionStart"in n&&Ic(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ps&&Vs(Ps,n)||(Ps=n,n=pi(_l,"onSelect"),0<n.length&&(e=new Rc("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Cn)))}function jo(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Nn={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionend:jo("Transition","TransitionEnd")},Ea={},Df={};rr&&(Df=document.createElement("div").style,"AnimationEvent"in window||(delete Nn.animationend.animation,delete Nn.animationiteration.animation,delete Nn.animationstart.animation),"TransitionEvent"in window||delete Nn.transitionend.transition);function Hi(t){if(Ea[t])return Ea[t];if(!Nn[t])return t;var e=Nn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Df)return Ea[t]=e[r];return t}var Lf=Hi("animationend"),Uf=Hi("animationiteration"),$f=Hi("animationstart"),Mf=Hi("transitionend"),Bf=new Map,Zu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(t,e){Bf.set(t,e),ln(e,[t])}for(var ja=0;ja<Zu.length;ja++){var Ca=Zu[ja],_y=Ca.toLowerCase(),by=Ca[0].toUpperCase()+Ca.slice(1);Dr(_y,"on"+by)}Dr(Lf,"onAnimationEnd");Dr(Uf,"onAnimationIteration");Dr($f,"onAnimationStart");Dr("dblclick","onDoubleClick");Dr("focusin","onFocus");Dr("focusout","onBlur");Dr(Mf,"onTransitionEnd");Vn("onMouseEnter",["mouseout","mouseover"]);Vn("onMouseLeave",["mouseout","mouseover"]);Vn("onPointerEnter",["pointerout","pointerover"]);Vn("onPointerLeave",["pointerout","pointerover"]);ln("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ln("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ln("onBeforeInput",["compositionend","keypress","textInput","paste"]);ln("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ln("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ln("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ss="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ss));function ed(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,_v(n,e,void 0,t),t.currentTarget=null}function Ff(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var o=void 0;if(e)for(var i=n.length-1;0<=i;i--){var a=n[i],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&s.isPropagationStopped())break e;ed(s,a,u),o=c}else for(i=0;i<n.length;i++){if(a=n[i],c=a.instance,u=a.currentTarget,a=a.listener,c!==o&&s.isPropagationStopped())break e;ed(s,a,u),o=c}}}if(di)throw t=pl,di=!1,pl=null,t}function ge(t,e){var r=e[jl];r===void 0&&(r=e[jl]=new Set);var n=t+"__bubble";r.has(n)||(zf(e,t,2,!1),r.add(n))}function Na(t,e,r){var n=0;e&&(n|=4),zf(r,t,n,e)}var Co="_reactListening"+Math.random().toString(36).slice(2);function Gs(t){if(!t[Co]){t[Co]=!0,Kh.forEach(function(r){r!=="selectionchange"&&(Sy.has(r)||Na(r,!1,t),Na(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Co]||(e[Co]=!0,Na("selectionchange",!1,e))}}function zf(t,e,r,n){switch(Ef(e)){case 1:var s=Lv;break;case 4:s=Uv;break;default:s=Pc}r=s.bind(null,e,r,t),s=void 0,!gl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Pa(t,e,r,n,s){var o=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Qr(a),i===null)return;if(c=i.tag,c===5||c===6){n=o=i;continue e}a=a.parentNode}}n=n.return}df(function(){var u=o,d=Ec(r),f=[];e:{var h=Bf.get(t);if(h!==void 0){var w=Rc,p=t;switch(t){case"keypress":if(Xo(r)===0)break e;case"keydown":case"keyup":w=Xv;break;case"focusin":p="focus",w=Sa;break;case"focusout":p="blur",w=Sa;break;case"beforeblur":case"afterblur":w=Sa;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Bv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=ty;break;case Lf:case Uf:case $f:w=Wv;break;case Mf:w=ny;break;case"scroll":w=$v;break;case"wheel":w=oy;break;case"copy":case"cut":case"paste":w=Gv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Vu}var b=(e&4)!==0,y=!b&&t==="scroll",v=b?h!==null?h+"Capture":null:h;b=[];for(var g=u,m;g!==null;){m=g;var _=m.stateNode;if(m.tag===5&&_!==null&&(m=_,v!==null&&(_=Ms(g,v),_!=null&&b.push(Hs(g,_,m)))),y)break;g=g.return}0<b.length&&(h=new w(h,p,null,r,d),f.push({event:h,listeners:b}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",h&&r!==fl&&(p=r.relatedTarget||r.fromElement)&&(Qr(p)||p[nr]))break e;if((w||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,w?(p=r.relatedTarget||r.toElement,w=u,p=p?Qr(p):null,p!==null&&(y=cn(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(w=null,p=u),w!==p)){if(b=zu,_="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(b=Vu,_="onPointerLeave",v="onPointerEnter",g="pointer"),y=w==null?h:Pn(w),m=p==null?h:Pn(p),h=new b(_,g+"leave",w,r,d),h.target=y,h.relatedTarget=m,_=null,Qr(d)===u&&(b=new b(v,g+"enter",p,r,d),b.target=m,b.relatedTarget=y,_=b),y=_,w&&p)t:{for(b=w,v=p,g=0,m=b;m;m=fn(m))g++;for(m=0,_=v;_;_=fn(_))m++;for(;0<g-m;)b=fn(b),g--;for(;0<m-g;)v=fn(v),m--;for(;g--;){if(b===v||v!==null&&b===v.alternate)break t;b=fn(b),v=fn(v)}b=null}else b=null;w!==null&&td(f,h,w,b,!1),p!==null&&y!==null&&td(f,y,p,b,!0)}}e:{if(h=u?Pn(u):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var x=hy;else if(qu(h))if(Rf)x=py;else{x=my;var k=fy}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=gy);if(x&&(x=x(t,u))){Tf(f,x,r,d);break e}k&&k(t,h,u),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&ll(h,"number",h.value)}switch(k=u?Pn(u):window,t){case"focusin":(qu(k)||k.contentEditable==="true")&&(Cn=k,_l=u,Ps=null);break;case"focusout":Ps=_l=Cn=null;break;case"mousedown":bl=!0;break;case"contextmenu":case"mouseup":case"dragend":bl=!1,Xu(f,r,d);break;case"selectionchange":if(wy)break;case"keydown":case"keyup":Xu(f,r,d)}var E;if(Ac)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else jn?Nf(t,r)&&(j="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(Cf&&r.locale!=="ko"&&(jn||j!=="onCompositionStart"?j==="onCompositionEnd"&&jn&&(E=jf()):(wr=d,Tc="value"in wr?wr.value:wr.textContent,jn=!0)),k=pi(u,j),0<k.length&&(j=new Wu(j,t,null,r,d),f.push({event:j,listeners:k}),E?j.data=E:(E=Pf(r),E!==null&&(j.data=E)))),(E=ay?ly(t,r):cy(t,r))&&(u=pi(u,"onBeforeInput"),0<u.length&&(d=new Wu("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=E))}Ff(f,e)})}function Hs(t,e,r){return{instance:t,listener:e,currentTarget:r}}function pi(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Ms(t,r),o!=null&&n.unshift(Hs(t,o,s)),o=Ms(t,e),o!=null&&n.push(Hs(t,o,s))),t=t.return}return n}function fn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function td(t,e,r,n,s){for(var o=e._reactName,i=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,s?(c=Ms(r,o),c!=null&&i.unshift(Hs(r,c,a))):s||(c=Ms(r,o),c!=null&&i.push(Hs(r,c,a)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var xy=/\r\n?/g,ky=/\u0000|\uFFFD/g;function rd(t){return(typeof t=="string"?t:""+t).replace(xy,`
`).replace(ky,"")}function No(t,e,r){if(e=rd(e),rd(t)!==e&&r)throw Error(D(425))}function vi(){}var Sl=null,xl=null;function kl(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var El=typeof setTimeout=="function"?setTimeout:void 0,Ey=typeof clearTimeout=="function"?clearTimeout:void 0,nd=typeof Promise=="function"?Promise:void 0,jy=typeof queueMicrotask=="function"?queueMicrotask:typeof nd<"u"?function(t){return nd.resolve(null).then(t).catch(Cy)}:El;function Cy(t){setTimeout(function(){throw t})}function Ta(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),zs(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);zs(e)}function Er(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ns=Math.random().toString(36).slice(2),Ht="__reactFiber$"+ns,qs="__reactProps$"+ns,nr="__reactContainer$"+ns,jl="__reactEvents$"+ns,Ny="__reactListeners$"+ns,Py="__reactHandles$"+ns;function Qr(t){var e=t[Ht];if(e)return e;for(var r=t.parentNode;r;){if(e=r[nr]||r[Ht]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sd(t);t!==null;){if(r=t[Ht])return r;t=sd(t)}return e}t=r,r=t.parentNode}return null}function lo(t){return t=t[Ht]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(D(33))}function qi(t){return t[qs]||null}var Cl=[],Tn=-1;function Lr(t){return{current:t}}function pe(t){0>Tn||(t.current=Cl[Tn],Cl[Tn]=null,Tn--)}function me(t,e){Tn++,Cl[Tn]=t.current,t.current=e}var Ir={},Qe=Lr(Ir),at=Lr(!1),rn=Ir;function Gn(t,e){var r=t.type.contextTypes;if(!r)return Ir;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=e[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function lt(t){return t=t.childContextTypes,t!=null}function yi(){pe(at),pe(Qe)}function od(t,e,r){if(Qe.current!==Ir)throw Error(D(168));me(Qe,e),me(at,r)}function Wf(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(D(108,fv(t)||"Unknown",s));return xe({},r,n)}function wi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ir,rn=Qe.current,me(Qe,t),me(at,at.current),!0}function id(t,e,r){var n=t.stateNode;if(!n)throw Error(D(169));r?(t=Wf(t,e,rn),n.__reactInternalMemoizedMergedChildContext=t,pe(at),pe(Qe),me(Qe,t)):pe(at),me(at,r)}var Xt=null,Ki=!1,Ra=!1;function Vf(t){Xt===null?Xt=[t]:Xt.push(t)}function Ty(t){Ki=!0,Vf(t)}function Ur(){if(!Ra&&Xt!==null){Ra=!0;var t=0,e=de;try{var r=Xt;for(de=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Xt=null,Ki=!1}catch(s){throw Xt!==null&&(Xt=Xt.slice(t+1)),gf(jc,Ur),s}finally{de=e,Ra=!1}}return null}var Rn=[],On=0,_i=null,bi=0,bt=[],St=0,nn=null,Zt=1,er="";function Vr(t,e){Rn[On++]=bi,Rn[On++]=_i,_i=t,bi=e}function Gf(t,e,r){bt[St++]=Zt,bt[St++]=er,bt[St++]=nn,nn=t;var n=Zt;t=er;var s=32-$t(n)-1;n&=~(1<<s),r+=1;var o=32-$t(e)+s;if(30<o){var i=s-s%5;o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Zt=1<<32-$t(e)+s|r<<s|n,er=o+t}else Zt=1<<o|r<<s|n,er=t}function Dc(t){t.return!==null&&(Vr(t,1),Gf(t,1,0))}function Lc(t){for(;t===_i;)_i=Rn[--On],Rn[On]=null,bi=Rn[--On],Rn[On]=null;for(;t===nn;)nn=bt[--St],bt[St]=null,er=bt[--St],bt[St]=null,Zt=bt[--St],bt[St]=null}var pt=null,gt=null,ve=!1,Lt=null;function Hf(t,e){var r=kt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ad(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,pt=t,gt=Er(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,pt=t,gt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=nn!==null?{id:Zt,overflow:er}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=kt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,pt=t,gt=null,!0):!1;default:return!1}}function Nl(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pl(t){if(ve){var e=gt;if(e){var r=e;if(!ad(t,e)){if(Nl(t))throw Error(D(418));e=Er(r.nextSibling);var n=pt;e&&ad(t,e)?Hf(n,r):(t.flags=t.flags&-4097|2,ve=!1,pt=t)}}else{if(Nl(t))throw Error(D(418));t.flags=t.flags&-4097|2,ve=!1,pt=t}}}function ld(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pt=t}function Po(t){if(t!==pt)return!1;if(!ve)return ld(t),ve=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kl(t.type,t.memoizedProps)),e&&(e=gt)){if(Nl(t))throw qf(),Error(D(418));for(;e;)Hf(t,e),e=Er(e.nextSibling)}if(ld(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(D(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){gt=Er(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}gt=null}}else gt=pt?Er(t.stateNode.nextSibling):null;return!0}function qf(){for(var t=gt;t;)t=Er(t.nextSibling)}function Hn(){gt=pt=null,ve=!1}function Uc(t){Lt===null?Lt=[t]:Lt.push(t)}var Ry=ir.ReactCurrentBatchConfig;function ms(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(D(309));var n=r.stateNode}if(!n)throw Error(D(147,t));var s=n,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(D(284));if(!r._owner)throw Error(D(290,t))}return t}function To(t,e){throw t=Object.prototype.toString.call(e),Error(D(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cd(t){var e=t._init;return e(t._payload)}function Kf(t){function e(v,g){if(t){var m=v.deletions;m===null?(v.deletions=[g],v.flags|=16):m.push(g)}}function r(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function n(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function s(v,g){return v=Pr(v,g),v.index=0,v.sibling=null,v}function o(v,g,m){return v.index=m,t?(m=v.alternate,m!==null?(m=m.index,m<g?(v.flags|=2,g):m):(v.flags|=2,g)):(v.flags|=1048576,g)}function i(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,g,m,_){return g===null||g.tag!==6?(g=$a(m,v.mode,_),g.return=v,g):(g=s(g,m),g.return=v,g)}function c(v,g,m,_){var x=m.type;return x===En?d(v,g,m.props.children,_,m.key):g!==null&&(g.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===fr&&cd(x)===g.type)?(_=s(g,m.props),_.ref=ms(v,g,m),_.return=v,_):(_=oi(m.type,m.key,m.props,null,v.mode,_),_.ref=ms(v,g,m),_.return=v,_)}function u(v,g,m,_){return g===null||g.tag!==4||g.stateNode.containerInfo!==m.containerInfo||g.stateNode.implementation!==m.implementation?(g=Ma(m,v.mode,_),g.return=v,g):(g=s(g,m.children||[]),g.return=v,g)}function d(v,g,m,_,x){return g===null||g.tag!==7?(g=tn(m,v.mode,_,x),g.return=v,g):(g=s(g,m),g.return=v,g)}function f(v,g,m){if(typeof g=="string"&&g!==""||typeof g=="number")return g=$a(""+g,v.mode,m),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case wo:return m=oi(g.type,g.key,g.props,null,v.mode,m),m.ref=ms(v,null,g),m.return=v,m;case kn:return g=Ma(g,v.mode,m),g.return=v,g;case fr:var _=g._init;return f(v,_(g._payload),m)}if(_s(g)||cs(g))return g=tn(g,v.mode,m,null),g.return=v,g;To(v,g)}return null}function h(v,g,m,_){var x=g!==null?g.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return x!==null?null:a(v,g,""+m,_);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case wo:return m.key===x?c(v,g,m,_):null;case kn:return m.key===x?u(v,g,m,_):null;case fr:return x=m._init,h(v,g,x(m._payload),_)}if(_s(m)||cs(m))return x!==null?null:d(v,g,m,_,null);To(v,m)}return null}function w(v,g,m,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(m)||null,a(g,v,""+_,x);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wo:return v=v.get(_.key===null?m:_.key)||null,c(g,v,_,x);case kn:return v=v.get(_.key===null?m:_.key)||null,u(g,v,_,x);case fr:var k=_._init;return w(v,g,m,k(_._payload),x)}if(_s(_)||cs(_))return v=v.get(m)||null,d(g,v,_,x,null);To(g,_)}return null}function p(v,g,m,_){for(var x=null,k=null,E=g,j=g=0,N=null;E!==null&&j<m.length;j++){E.index>j?(N=E,E=null):N=E.sibling;var P=h(v,E,m[j],_);if(P===null){E===null&&(E=N);break}t&&E&&P.alternate===null&&e(v,E),g=o(P,g,j),k===null?x=P:k.sibling=P,k=P,E=N}if(j===m.length)return r(v,E),ve&&Vr(v,j),x;if(E===null){for(;j<m.length;j++)E=f(v,m[j],_),E!==null&&(g=o(E,g,j),k===null?x=E:k.sibling=E,k=E);return ve&&Vr(v,j),x}for(E=n(v,E);j<m.length;j++)N=w(E,v,j,m[j],_),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?j:N.key),g=o(N,g,j),k===null?x=N:k.sibling=N,k=N);return t&&E.forEach(function(M){return e(v,M)}),ve&&Vr(v,j),x}function b(v,g,m,_){var x=cs(m);if(typeof x!="function")throw Error(D(150));if(m=x.call(m),m==null)throw Error(D(151));for(var k=x=null,E=g,j=g=0,N=null,P=m.next();E!==null&&!P.done;j++,P=m.next()){E.index>j?(N=E,E=null):N=E.sibling;var M=h(v,E,P.value,_);if(M===null){E===null&&(E=N);break}t&&E&&M.alternate===null&&e(v,E),g=o(M,g,j),k===null?x=M:k.sibling=M,k=M,E=N}if(P.done)return r(v,E),ve&&Vr(v,j),x;if(E===null){for(;!P.done;j++,P=m.next())P=f(v,P.value,_),P!==null&&(g=o(P,g,j),k===null?x=P:k.sibling=P,k=P);return ve&&Vr(v,j),x}for(E=n(v,E);!P.done;j++,P=m.next())P=w(E,v,j,P.value,_),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?j:P.key),g=o(P,g,j),k===null?x=P:k.sibling=P,k=P);return t&&E.forEach(function(X){return e(v,X)}),ve&&Vr(v,j),x}function y(v,g,m,_){if(typeof m=="object"&&m!==null&&m.type===En&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case wo:e:{for(var x=m.key,k=g;k!==null;){if(k.key===x){if(x=m.type,x===En){if(k.tag===7){r(v,k.sibling),g=s(k,m.props.children),g.return=v,v=g;break e}}else if(k.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===fr&&cd(x)===k.type){r(v,k.sibling),g=s(k,m.props),g.ref=ms(v,k,m),g.return=v,v=g;break e}r(v,k);break}else e(v,k);k=k.sibling}m.type===En?(g=tn(m.props.children,v.mode,_,m.key),g.return=v,v=g):(_=oi(m.type,m.key,m.props,null,v.mode,_),_.ref=ms(v,g,m),_.return=v,v=_)}return i(v);case kn:e:{for(k=m.key;g!==null;){if(g.key===k)if(g.tag===4&&g.stateNode.containerInfo===m.containerInfo&&g.stateNode.implementation===m.implementation){r(v,g.sibling),g=s(g,m.children||[]),g.return=v,v=g;break e}else{r(v,g);break}else e(v,g);g=g.sibling}g=Ma(m,v.mode,_),g.return=v,v=g}return i(v);case fr:return k=m._init,y(v,g,k(m._payload),_)}if(_s(m))return p(v,g,m,_);if(cs(m))return b(v,g,m,_);To(v,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,g!==null&&g.tag===6?(r(v,g.sibling),g=s(g,m),g.return=v,v=g):(r(v,g),g=$a(m,v.mode,_),g.return=v,v=g),i(v)):r(v,g)}return y}var qn=Kf(!0),Jf=Kf(!1),Si=Lr(null),xi=null,An=null,$c=null;function Mc(){$c=An=xi=null}function Bc(t){var e=Si.current;pe(Si),t._currentValue=e}function Tl(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Bn(t,e){xi=t,$c=An=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(it=!0),t.firstContext=null)}function jt(t){var e=t._currentValue;if($c!==t)if(t={context:t,memoizedValue:e,next:null},An===null){if(xi===null)throw Error(D(308));An=t,xi.dependencies={lanes:0,firstContext:t}}else An=An.next=t;return e}var Yr=null;function Fc(t){Yr===null?Yr=[t]:Yr.push(t)}function Qf(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Fc(e)):(r.next=s.next,s.next=r),e.interleaved=r,sr(t,n)}function sr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var mr=!1;function zc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yf(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jr(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ue&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,sr(t,r)}return s=n.interleaved,s===null?(e.next=e,Fc(n)):(e.next=s.next,s.next=e),n.interleaved=e,sr(t,r)}function Zo(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cc(t,r)}}function ud(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=e:o=o.next=e}else s=o=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ki(t,e,r,n){var s=t.updateQueue;mr=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==i&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,d=u=c=null,a=o;do{var h=a.lane,w=a.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,b=a;switch(h=e,w=r,b.tag){case 1:if(p=b.payload,typeof p=="function"){f=p.call(w,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=b.payload,h=typeof p=="function"?p.call(w,f,h):p,h==null)break e;f=xe({},f,h);break e;case 2:mr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else w={eventTime:w,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=w,c=f):d=d.next=w,i|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);on|=i,t.lanes=i,t.memoizedState=f}}function dd(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(D(191,s));s.call(n)}}}var co={},Kt=Lr(co),Ks=Lr(co),Js=Lr(co);function Xr(t){if(t===co)throw Error(D(174));return t}function Wc(t,e){switch(me(Js,e),me(Ks,t),me(Kt,co),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ul(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ul(e,t)}pe(Kt),me(Kt,e)}function Kn(){pe(Kt),pe(Ks),pe(Js)}function Xf(t){Xr(Js.current);var e=Xr(Kt.current),r=ul(e,t.type);e!==r&&(me(Ks,t),me(Kt,r))}function Vc(t){Ks.current===t&&(pe(Kt),pe(Ks))}var _e=Lr(0);function Ei(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Oa=[];function Gc(){for(var t=0;t<Oa.length;t++)Oa[t]._workInProgressVersionPrimary=null;Oa.length=0}var ei=ir.ReactCurrentDispatcher,Aa=ir.ReactCurrentBatchConfig,sn=0,be=null,Ae=null,Be=null,ji=!1,Ts=!1,Qs=0,Oy=0;function qe(){throw Error(D(321))}function Hc(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Bt(t[r],e[r]))return!1;return!0}function qc(t,e,r,n,s,o){if(sn=o,be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ei.current=t===null||t.memoizedState===null?Ly:Uy,t=r(n,s),Ts){o=0;do{if(Ts=!1,Qs=0,25<=o)throw Error(D(301));o+=1,Be=Ae=null,e.updateQueue=null,ei.current=$y,t=r(n,s)}while(Ts)}if(ei.current=Ci,e=Ae!==null&&Ae.next!==null,sn=0,Be=Ae=be=null,ji=!1,e)throw Error(D(300));return t}function Kc(){var t=Qs!==0;return Qs=0,t}function Gt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?be.memoizedState=Be=t:Be=Be.next=t,Be}function Ct(){if(Ae===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=Ae.next;var e=Be===null?be.memoizedState:Be.next;if(e!==null)Be=e,Ae=t;else{if(t===null)throw Error(D(310));Ae=t,t={memoizedState:Ae.memoizedState,baseState:Ae.baseState,baseQueue:Ae.baseQueue,queue:Ae.queue,next:null},Be===null?be.memoizedState=Be=t:Be=Be.next=t}return Be}function Ys(t,e){return typeof e=="function"?e(t):e}function Ia(t){var e=Ct(),r=e.queue;if(r===null)throw Error(D(311));r.lastRenderedReducer=t;var n=Ae,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var a=i=null,c=null,u=o;do{var d=u.lane;if((sn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,i=n):c=c.next=f,be.lanes|=d,on|=d}u=u.next}while(u!==null&&u!==o);c===null?i=n:c.next=a,Bt(n,e.memoizedState)||(it=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do o=s.lane,be.lanes|=o,on|=o,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Da(t){var e=Ct(),r=e.queue;if(r===null)throw Error(D(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,o=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);Bt(o,e.memoizedState)||(it=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,n]}function Zf(){}function em(t,e){var r=be,n=Ct(),s=e(),o=!Bt(n.memoizedState,s);if(o&&(n.memoizedState=s,it=!0),n=n.queue,Jc(nm.bind(null,r,n,t),[t]),n.getSnapshot!==e||o||Be!==null&&Be.memoizedState.tag&1){if(r.flags|=2048,Xs(9,rm.bind(null,r,n,s,e),void 0,null),Fe===null)throw Error(D(349));sn&30||tm(r,e,s)}return s}function tm(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function rm(t,e,r,n){e.value=r,e.getSnapshot=n,sm(e)&&om(t)}function nm(t,e,r){return r(function(){sm(e)&&om(t)})}function sm(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Bt(t,r)}catch{return!0}}function om(t){var e=sr(t,1);e!==null&&Mt(e,t,1,-1)}function hd(t){var e=Gt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:t},e.queue=t,t=t.dispatch=Dy.bind(null,be,t),[e.memoizedState,t]}function Xs(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function im(){return Ct().memoizedState}function ti(t,e,r,n){var s=Gt();be.flags|=t,s.memoizedState=Xs(1|e,r,void 0,n===void 0?null:n)}function Ji(t,e,r,n){var s=Ct();n=n===void 0?null:n;var o=void 0;if(Ae!==null){var i=Ae.memoizedState;if(o=i.destroy,n!==null&&Hc(n,i.deps)){s.memoizedState=Xs(e,r,o,n);return}}be.flags|=t,s.memoizedState=Xs(1|e,r,o,n)}function fd(t,e){return ti(8390656,8,t,e)}function Jc(t,e){return Ji(2048,8,t,e)}function am(t,e){return Ji(4,2,t,e)}function lm(t,e){return Ji(4,4,t,e)}function cm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function um(t,e,r){return r=r!=null?r.concat([t]):null,Ji(4,4,cm.bind(null,e,t),r)}function Qc(){}function dm(t,e){var r=Ct();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Hc(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function hm(t,e){var r=Ct();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Hc(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function fm(t,e,r){return sn&21?(Bt(r,e)||(r=yf(),be.lanes|=r,on|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,it=!0),t.memoizedState=r)}function Ay(t,e){var r=de;de=r!==0&&4>r?r:4,t(!0);var n=Aa.transition;Aa.transition={};try{t(!1),e()}finally{de=r,Aa.transition=n}}function mm(){return Ct().memoizedState}function Iy(t,e,r){var n=Nr(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},gm(t))pm(e,r);else if(r=Qf(t,e,r,n),r!==null){var s=rt();Mt(r,t,n,s),vm(r,e,n)}}function Dy(t,e,r){var n=Nr(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(gm(t))pm(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,r);if(s.hasEagerState=!0,s.eagerState=a,Bt(a,i)){var c=e.interleaved;c===null?(s.next=s,Fc(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=Qf(t,e,s,n),r!==null&&(s=rt(),Mt(r,t,n,s),vm(r,e,n))}}function gm(t){var e=t.alternate;return t===be||e!==null&&e===be}function pm(t,e){Ts=ji=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function vm(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cc(t,r)}}var Ci={readContext:jt,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},Ly={readContext:jt,useCallback:function(t,e){return Gt().memoizedState=[t,e===void 0?null:e],t},useContext:jt,useEffect:fd,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,ti(4194308,4,cm.bind(null,e,t),r)},useLayoutEffect:function(t,e){return ti(4194308,4,t,e)},useInsertionEffect:function(t,e){return ti(4,2,t,e)},useMemo:function(t,e){var r=Gt();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gt();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Iy.bind(null,be,t),[n.memoizedState,t]},useRef:function(t){var e=Gt();return t={current:t},e.memoizedState=t},useState:hd,useDebugValue:Qc,useDeferredValue:function(t){return Gt().memoizedState=t},useTransition:function(){var t=hd(!1),e=t[0];return t=Ay.bind(null,t[1]),Gt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=be,s=Gt();if(ve){if(r===void 0)throw Error(D(407));r=r()}else{if(r=e(),Fe===null)throw Error(D(349));sn&30||tm(n,e,r)}s.memoizedState=r;var o={value:r,getSnapshot:e};return s.queue=o,fd(nm.bind(null,n,o,t),[t]),n.flags|=2048,Xs(9,rm.bind(null,n,o,r,e),void 0,null),r},useId:function(){var t=Gt(),e=Fe.identifierPrefix;if(ve){var r=er,n=Zt;r=(n&~(1<<32-$t(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Qs++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Oy++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Uy={readContext:jt,useCallback:dm,useContext:jt,useEffect:Jc,useImperativeHandle:um,useInsertionEffect:am,useLayoutEffect:lm,useMemo:hm,useReducer:Ia,useRef:im,useState:function(){return Ia(Ys)},useDebugValue:Qc,useDeferredValue:function(t){var e=Ct();return fm(e,Ae.memoizedState,t)},useTransition:function(){var t=Ia(Ys)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:Zf,useSyncExternalStore:em,useId:mm,unstable_isNewReconciler:!1},$y={readContext:jt,useCallback:dm,useContext:jt,useEffect:Jc,useImperativeHandle:um,useInsertionEffect:am,useLayoutEffect:lm,useMemo:hm,useReducer:Da,useRef:im,useState:function(){return Da(Ys)},useDebugValue:Qc,useDeferredValue:function(t){var e=Ct();return Ae===null?e.memoizedState=t:fm(e,Ae.memoizedState,t)},useTransition:function(){var t=Da(Ys)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:Zf,useSyncExternalStore:em,useId:mm,unstable_isNewReconciler:!1};function Ot(t,e){if(t&&t.defaultProps){e=xe({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Rl(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:xe({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Qi={isMounted:function(t){return(t=t._reactInternals)?cn(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=rt(),s=Nr(t),o=tr(n,s);o.payload=e,r!=null&&(o.callback=r),e=jr(t,o,s),e!==null&&(Mt(e,t,s,n),Zo(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=rt(),s=Nr(t),o=tr(n,s);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=jr(t,o,s),e!==null&&(Mt(e,t,s,n),Zo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=rt(),n=Nr(t),s=tr(r,n);s.tag=2,e!=null&&(s.callback=e),e=jr(t,s,n),e!==null&&(Mt(e,t,n,r),Zo(e,t,n))}};function md(t,e,r,n,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,i):e.prototype&&e.prototype.isPureReactComponent?!Vs(r,n)||!Vs(s,o):!0}function ym(t,e,r){var n=!1,s=Ir,o=e.contextType;return typeof o=="object"&&o!==null?o=jt(o):(s=lt(e)?rn:Qe.current,n=e.contextTypes,o=(n=n!=null)?Gn(t,s):Ir),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qi,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function gd(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Qi.enqueueReplaceState(e,e.state,null)}function Ol(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},zc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=jt(o):(o=lt(e)?rn:Qe.current,s.context=Gn(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Rl(t,e,o,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qi.enqueueReplaceState(s,s.state,null),ki(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Jn(t,e){try{var r="",n=e;do r+=hv(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function La(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Al(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var My=typeof WeakMap=="function"?WeakMap:Map;function wm(t,e,r){r=tr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Pi||(Pi=!0,Wl=n),Al(t,e)},r}function _m(t,e,r){r=tr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Al(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Al(t,e),typeof n!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function pd(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new My;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Zy.bind(null,t,e,r),e.then(t,t))}function vd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yd(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=tr(-1,1),e.tag=2,jr(r,e,1))),r.lanes|=1),t)}var By=ir.ReactCurrentOwner,it=!1;function et(t,e,r,n){e.child=t===null?Jf(e,null,r,n):qn(e,t.child,r,n)}function wd(t,e,r,n,s){r=r.render;var o=e.ref;return Bn(e,s),n=qc(t,e,r,n,o,s),r=Kc(),t!==null&&!it?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,or(t,e,s)):(ve&&r&&Dc(e),e.flags|=1,et(t,e,n,s),e.child)}function _d(t,e,r,n,s){if(t===null){var o=r.type;return typeof o=="function"&&!su(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,bm(t,e,o,n,s)):(t=oi(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:Vs,r(i,n)&&t.ref===e.ref)return or(t,e,s)}return e.flags|=1,t=Pr(o,n),t.ref=e.ref,t.return=e,e.child=t}function bm(t,e,r,n,s){if(t!==null){var o=t.memoizedProps;if(Vs(o,n)&&t.ref===e.ref)if(it=!1,e.pendingProps=n=o,(t.lanes&s)!==0)t.flags&131072&&(it=!0);else return e.lanes=t.lanes,or(t,e,s)}return Il(t,e,r,n,s)}function Sm(t,e,r){var n=e.pendingProps,s=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(Dn,ht),ht|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,me(Dn,ht),ht|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,me(Dn,ht),ht|=n}else o!==null?(n=o.baseLanes|r,e.memoizedState=null):n=r,me(Dn,ht),ht|=n;return et(t,e,s,r),e.child}function xm(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Il(t,e,r,n,s){var o=lt(r)?rn:Qe.current;return o=Gn(e,o),Bn(e,s),r=qc(t,e,r,n,o,s),n=Kc(),t!==null&&!it?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,or(t,e,s)):(ve&&n&&Dc(e),e.flags|=1,et(t,e,r,s),e.child)}function bd(t,e,r,n,s){if(lt(r)){var o=!0;wi(e)}else o=!1;if(Bn(e,s),e.stateNode===null)ri(t,e),ym(e,r,n),Ol(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=jt(u):(u=lt(r)?rn:Qe.current,u=Gn(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==n||c!==u)&&gd(e,i,n,u),mr=!1;var h=e.memoizedState;i.state=h,ki(e,n,i,s),c=e.memoizedState,a!==n||h!==c||at.current||mr?(typeof d=="function"&&(Rl(e,r,d,n),c=e.memoizedState),(a=mr||md(e,r,a,n,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),i.props=n,i.state=c,i.context=u,n=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,Yf(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ot(e.type,a),i.props=u,f=e.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=jt(c):(c=lt(r)?rn:Qe.current,c=Gn(e,c));var w=r.getDerivedStateFromProps;(d=typeof w=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==f||h!==c)&&gd(e,i,n,c),mr=!1,h=e.memoizedState,i.state=h,ki(e,n,i,s);var p=e.memoizedState;a!==f||h!==p||at.current||mr?(typeof w=="function"&&(Rl(e,r,w,n),p=e.memoizedState),(u=mr||md(e,r,u,n,h,p,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,p,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,p,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),i.props=n,i.state=p,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return Dl(t,e,r,n,o,s)}function Dl(t,e,r,n,s,o){xm(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&id(e,r,!1),or(t,e,o);n=e.stateNode,By.current=e;var a=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=qn(e,t.child,null,o),e.child=qn(e,null,a,o)):et(t,e,a,o),e.memoizedState=n.state,s&&id(e,r,!0),e.child}function km(t){var e=t.stateNode;e.pendingContext?od(t,e.pendingContext,e.pendingContext!==e.context):e.context&&od(t,e.context,!1),Wc(t,e.containerInfo)}function Sd(t,e,r,n,s){return Hn(),Uc(s),e.flags|=256,et(t,e,r,n),e.child}var Ll={dehydrated:null,treeContext:null,retryLane:0};function Ul(t){return{baseLanes:t,cachePool:null,transitions:null}}function Em(t,e,r){var n=e.pendingProps,s=_e.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),me(_e,s&1),t===null)return Pl(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,o?(n=e.mode,o=e.child,i={mode:"hidden",children:i},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Zi(i,n,0,null),t=tn(t,n,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ul(r),e.memoizedState=Ll,t):Yc(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Fy(t,e,i,n,a,s,r);if(o){o=n.fallback,i=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Pr(s,c),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Pr(a,o):(o=tn(o,i,r,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,i=t.child.memoizedState,i=i===null?Ul(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~r,e.memoizedState=Ll,n}return o=t.child,t=o.sibling,n=Pr(o,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Yc(t,e){return e=Zi({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ro(t,e,r,n){return n!==null&&Uc(n),qn(e,t.child,null,r),t=Yc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Fy(t,e,r,n,s,o,i){if(r)return e.flags&256?(e.flags&=-257,n=La(Error(D(422))),Ro(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=n.fallback,s=e.mode,n=Zi({mode:"visible",children:n.children},s,0,null),o=tn(o,s,i,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,e.mode&1&&qn(e,t.child,null,i),e.child.memoizedState=Ul(i),e.memoizedState=Ll,o);if(!(e.mode&1))return Ro(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(D(419)),n=La(o,n,void 0),Ro(t,e,i,n)}if(a=(i&t.childLanes)!==0,it||a){if(n=Fe,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,sr(t,s),Mt(n,t,s,-1))}return nu(),n=La(Error(D(421))),Ro(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=e0.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,gt=Er(s.nextSibling),pt=e,ve=!0,Lt=null,t!==null&&(bt[St++]=Zt,bt[St++]=er,bt[St++]=nn,Zt=t.id,er=t.overflow,nn=e),e=Yc(e,n.children),e.flags|=4096,e)}function xd(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Tl(t.return,e,r)}function Ua(t,e,r,n,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function jm(t,e,r){var n=e.pendingProps,s=n.revealOrder,o=n.tail;if(et(t,e,n.children,r),n=_e.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xd(t,r,e);else if(t.tag===19)xd(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(me(_e,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Ei(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Ua(e,!1,s,r,o);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ei(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Ua(e,!0,r,null,o);break;case"together":Ua(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ri(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function or(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),on|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(D(153));if(e.child!==null){for(t=e.child,r=Pr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Pr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function zy(t,e,r){switch(e.tag){case 3:km(e),Hn();break;case 5:Xf(e);break;case 1:lt(e.type)&&wi(e);break;case 4:Wc(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;me(Si,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(me(_e,_e.current&1),e.flags|=128,null):r&e.child.childLanes?Em(t,e,r):(me(_e,_e.current&1),t=or(t,e,r),t!==null?t.sibling:null);me(_e,_e.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return jm(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),me(_e,_e.current),n)break;return null;case 22:case 23:return e.lanes=0,Sm(t,e,r)}return or(t,e,r)}var Cm,$l,Nm,Pm;Cm=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$l=function(){};Nm=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Xr(Kt.current);var o=null;switch(r){case"input":s=il(t,s),n=il(t,n),o=[];break;case"select":s=xe({},s,{value:void 0}),n=xe({},n,{value:void 0}),o=[];break;case"textarea":s=cl(t,s),n=cl(t,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=vi)}dl(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Us.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var c=n[u];if(a=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Us.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ge("scroll",t),o||a===c||(o=[])):(o=o||[]).push(u,c))}r&&(o=o||[]).push("style",r);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};Pm=function(t,e,r,n){r!==n&&(e.flags|=4)};function gs(t,e){if(!ve)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ke(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Wy(t,e,r){var n=e.pendingProps;switch(Lc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(e),null;case 1:return lt(e.type)&&yi(),Ke(e),null;case 3:return n=e.stateNode,Kn(),pe(at),pe(Qe),Gc(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Po(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Lt!==null&&(Hl(Lt),Lt=null))),$l(t,e),Ke(e),null;case 5:Vc(e);var s=Xr(Js.current);if(r=e.type,t!==null&&e.stateNode!=null)Nm(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(D(166));return Ke(e),null}if(t=Xr(Kt.current),Po(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[Ht]=e,n[qs]=o,t=(e.mode&1)!==0,r){case"dialog":ge("cancel",n),ge("close",n);break;case"iframe":case"object":case"embed":ge("load",n);break;case"video":case"audio":for(s=0;s<Ss.length;s++)ge(Ss[s],n);break;case"source":ge("error",n);break;case"img":case"image":case"link":ge("error",n),ge("load",n);break;case"details":ge("toggle",n);break;case"input":Ou(n,o),ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ge("invalid",n);break;case"textarea":Iu(n,o),ge("invalid",n)}dl(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&No(n.textContent,a,t),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&No(n.textContent,a,t),s=["children",""+a]):Us.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&ge("scroll",n)}switch(r){case"input":_o(n),Au(n,o,!0);break;case"textarea":_o(n),Du(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=vi)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rf(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[Ht]=e,t[qs]=n,Cm(t,e,!1,!1),e.stateNode=t;e:{switch(i=hl(r,n),r){case"dialog":ge("cancel",t),ge("close",t),s=n;break;case"iframe":case"object":case"embed":ge("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ss.length;s++)ge(Ss[s],t);s=n;break;case"source":ge("error",t),s=n;break;case"img":case"image":case"link":ge("error",t),ge("load",t),s=n;break;case"details":ge("toggle",t),s=n;break;case"input":Ou(t,n),s=il(t,n),ge("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=xe({},n,{value:void 0}),ge("invalid",t);break;case"textarea":Iu(t,n),s=cl(t,n),ge("invalid",t);break;default:s=n}dl(r,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?of(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&nf(t,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&$s(t,c):typeof c=="number"&&$s(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Us.hasOwnProperty(o)?c!=null&&o==="onScroll"&&ge("scroll",t):c!=null&&bc(t,o,c,i))}switch(r){case"input":_o(t),Au(t,n,!1);break;case"textarea":_o(t),Du(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ar(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?Ln(t,!!n.multiple,o,!1):n.defaultValue!=null&&Ln(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vi)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ke(e),null;case 6:if(t&&e.stateNode!=null)Pm(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(D(166));if(r=Xr(Js.current),Xr(Kt.current),Po(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ht]=e,(o=n.nodeValue!==r)&&(t=pt,t!==null))switch(t.tag){case 3:No(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&No(n.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ht]=e,e.stateNode=n}return Ke(e),null;case 13:if(pe(_e),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ve&&gt!==null&&e.mode&1&&!(e.flags&128))qf(),Hn(),e.flags|=98560,o=!1;else if(o=Po(e),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(D(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(D(317));o[Ht]=e}else Hn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ke(e),o=!1}else Lt!==null&&(Hl(Lt),Lt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||_e.current&1?Le===0&&(Le=3):nu())),e.updateQueue!==null&&(e.flags|=4),Ke(e),null);case 4:return Kn(),$l(t,e),t===null&&Gs(e.stateNode.containerInfo),Ke(e),null;case 10:return Bc(e.type._context),Ke(e),null;case 17:return lt(e.type)&&yi(),Ke(e),null;case 19:if(pe(_e),o=e.memoizedState,o===null)return Ke(e),null;if(n=(e.flags&128)!==0,i=o.rendering,i===null)if(n)gs(o,!1);else{if(Le!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Ei(t),i!==null){for(e.flags|=128,gs(o,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)o=r,t=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return me(_e,_e.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ne()>Qn&&(e.flags|=128,n=!0,gs(o,!1),e.lanes=4194304)}else{if(!n)if(t=Ei(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),gs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!ve)return Ke(e),null}else 2*Ne()-o.renderingStartTime>Qn&&r!==1073741824&&(e.flags|=128,n=!0,gs(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(r=o.last,r!==null?r.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ne(),e.sibling=null,r=_e.current,me(_e,n?r&1|2:r&1),e):(Ke(e),null);case 22:case 23:return ru(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ht&1073741824&&(Ke(e),e.subtreeFlags&6&&(e.flags|=8192)):Ke(e),null;case 24:return null;case 25:return null}throw Error(D(156,e.tag))}function Vy(t,e){switch(Lc(e),e.tag){case 1:return lt(e.type)&&yi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Kn(),pe(at),pe(Qe),Gc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vc(e),null;case 13:if(pe(_e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(D(340));Hn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pe(_e),null;case 4:return Kn(),null;case 10:return Bc(e.type._context),null;case 22:case 23:return ru(),null;case 24:return null;default:return null}}var Oo=!1,Je=!1,Gy=typeof WeakSet=="function"?WeakSet:Set,G=null;function In(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ee(t,e,n)}else r.current=null}function Ml(t,e,r){try{r()}catch(n){Ee(t,e,n)}}var kd=!1;function Hy(t,e){if(Sl=mi,t=If(),Ic(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,a=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var w;f!==r||s!==0&&f.nodeType!==3||(a=i+s),f!==o||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(w=f.firstChild)!==null;)h=f,f=w;for(;;){if(f===t)break t;if(h===r&&++u===s&&(a=i),h===o&&++d===n&&(c=i),(w=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=w}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(xl={focusedElem:t,selectionRange:r},mi=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var b=p.memoizedProps,y=p.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?b:Ot(e.type,b),y);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(_){Ee(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return p=kd,kd=!1,p}function Rs(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Ml(e,r,o)}s=s.next}while(s!==n)}}function Yi(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Bl(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Tm(t){var e=t.alternate;e!==null&&(t.alternate=null,Tm(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ht],delete e[qs],delete e[jl],delete e[Ny],delete e[Py])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Rm(t){return t.tag===5||t.tag===3||t.tag===4}function Ed(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Rm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=vi));else if(n!==4&&(t=t.child,t!==null))for(Fl(t,e,r),t=t.sibling;t!==null;)Fl(t,e,r),t=t.sibling}function zl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(zl(t,e,r),t=t.sibling;t!==null;)zl(t,e,r),t=t.sibling}var We=null,It=!1;function ur(t,e,r){for(r=r.child;r!==null;)Om(t,e,r),r=r.sibling}function Om(t,e,r){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Wi,r)}catch{}switch(r.tag){case 5:Je||In(r,e);case 6:var n=We,s=It;We=null,ur(t,e,r),We=n,It=s,We!==null&&(It?(t=We,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):We.removeChild(r.stateNode));break;case 18:We!==null&&(It?(t=We,r=r.stateNode,t.nodeType===8?Ta(t.parentNode,r):t.nodeType===1&&Ta(t,r),zs(t)):Ta(We,r.stateNode));break;case 4:n=We,s=It,We=r.stateNode.containerInfo,It=!0,ur(t,e,r),We=n,It=s;break;case 0:case 11:case 14:case 15:if(!Je&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Ml(r,e,i),s=s.next}while(s!==n)}ur(t,e,r);break;case 1:if(!Je&&(In(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ee(r,e,a)}ur(t,e,r);break;case 21:ur(t,e,r);break;case 22:r.mode&1?(Je=(n=Je)||r.memoizedState!==null,ur(t,e,r),Je=n):ur(t,e,r);break;default:ur(t,e,r)}}function jd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Gy),e.forEach(function(n){var s=t0.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Tt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:We=a.stateNode,It=!1;break e;case 3:We=a.stateNode.containerInfo,It=!0;break e;case 4:We=a.stateNode.containerInfo,It=!0;break e}a=a.return}if(We===null)throw Error(D(160));Om(o,i,s),We=null,It=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ee(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Am(e,t),e=e.sibling}function Am(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tt(e,t),Vt(t),n&4){try{Rs(3,t,t.return),Yi(3,t)}catch(b){Ee(t,t.return,b)}try{Rs(5,t,t.return)}catch(b){Ee(t,t.return,b)}}break;case 1:Tt(e,t),Vt(t),n&512&&r!==null&&In(r,r.return);break;case 5:if(Tt(e,t),Vt(t),n&512&&r!==null&&In(r,r.return),t.flags&32){var s=t.stateNode;try{$s(s,"")}catch(b){Ee(t,t.return,b)}}if(n&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=r!==null?r.memoizedProps:o,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&ef(s,o),hl(a,i);var u=hl(a,o);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?of(s,f):d==="dangerouslySetInnerHTML"?nf(s,f):d==="children"?$s(s,f):bc(s,d,f,u)}switch(a){case"input":al(s,o);break;case"textarea":tf(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var w=o.value;w!=null?Ln(s,!!o.multiple,w,!1):h!==!!o.multiple&&(o.defaultValue!=null?Ln(s,!!o.multiple,o.defaultValue,!0):Ln(s,!!o.multiple,o.multiple?[]:"",!1))}s[qs]=o}catch(b){Ee(t,t.return,b)}}break;case 6:if(Tt(e,t),Vt(t),n&4){if(t.stateNode===null)throw Error(D(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(b){Ee(t,t.return,b)}}break;case 3:if(Tt(e,t),Vt(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zs(e.containerInfo)}catch(b){Ee(t,t.return,b)}break;case 4:Tt(e,t),Vt(t);break;case 13:Tt(e,t),Vt(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(eu=Ne())),n&4&&jd(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Je=(u=Je)||d,Tt(e,t),Je=u):Tt(e,t),Vt(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(G=t,d=t.child;d!==null;){for(f=G=d;G!==null;){switch(h=G,w=h.child,h.tag){case 0:case 11:case 14:case 15:Rs(4,h,h.return);break;case 1:In(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(b){Ee(n,r,b)}}break;case 5:In(h,h.return);break;case 22:if(h.memoizedState!==null){Nd(f);continue}}w!==null?(w.return=h,G=w):Nd(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=sf("display",i))}catch(b){Ee(t,t.return,b)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(b){Ee(t,t.return,b)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Tt(e,t),Vt(t),n&4&&jd(t);break;case 21:break;default:Tt(e,t),Vt(t)}}function Vt(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Rm(r)){var n=r;break e}r=r.return}throw Error(D(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&($s(s,""),n.flags&=-33);var o=Ed(t);zl(t,o,s);break;case 3:case 4:var i=n.stateNode.containerInfo,a=Ed(t);Fl(t,a,i);break;default:throw Error(D(161))}}catch(c){Ee(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function qy(t,e,r){G=t,Im(t)}function Im(t,e,r){for(var n=(t.mode&1)!==0;G!==null;){var s=G,o=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Oo;if(!i){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Je;a=Oo;var u=Je;if(Oo=i,(Je=c)&&!u)for(G=s;G!==null;)i=G,c=i.child,i.tag===22&&i.memoizedState!==null?Pd(s):c!==null?(c.return=i,G=c):Pd(s);for(;o!==null;)G=o,Im(o),o=o.sibling;G=s,Oo=a,Je=u}Cd(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,G=o):Cd(t)}}function Cd(t){for(;G!==null;){var e=G;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Je||Yi(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Je)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Ot(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&dd(e,o,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}dd(e,i,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&zs(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}Je||e.flags&512&&Bl(e)}catch(h){Ee(e,e.return,h)}}if(e===t){G=null;break}if(r=e.sibling,r!==null){r.return=e.return,G=r;break}G=e.return}}function Nd(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var r=e.sibling;if(r!==null){r.return=e.return,G=r;break}G=e.return}}function Pd(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Yi(4,e)}catch(c){Ee(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Ee(e,s,c)}}var o=e.return;try{Bl(e)}catch(c){Ee(e,o,c)}break;case 5:var i=e.return;try{Bl(e)}catch(c){Ee(e,i,c)}}}catch(c){Ee(e,e.return,c)}if(e===t){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var Ky=Math.ceil,Ni=ir.ReactCurrentDispatcher,Xc=ir.ReactCurrentOwner,Et=ir.ReactCurrentBatchConfig,ue=0,Fe=null,Te=null,Ve=0,ht=0,Dn=Lr(0),Le=0,Zs=null,on=0,Xi=0,Zc=0,Os=null,ot=null,eu=0,Qn=1/0,Qt=null,Pi=!1,Wl=null,Cr=null,Ao=!1,_r=null,Ti=0,As=0,Vl=null,ni=-1,si=0;function rt(){return ue&6?Ne():ni!==-1?ni:ni=Ne()}function Nr(t){return t.mode&1?ue&2&&Ve!==0?Ve&-Ve:Ry.transition!==null?(si===0&&(si=yf()),si):(t=de,t!==0||(t=window.event,t=t===void 0?16:Ef(t.type)),t):1}function Mt(t,e,r,n){if(50<As)throw As=0,Vl=null,Error(D(185));io(t,r,n),(!(ue&2)||t!==Fe)&&(t===Fe&&(!(ue&2)&&(Xi|=r),Le===4&&vr(t,Ve)),ct(t,n),r===1&&ue===0&&!(e.mode&1)&&(Qn=Ne()+500,Ki&&Ur()))}function ct(t,e){var r=t.callbackNode;Rv(t,e);var n=fi(t,t===Fe?Ve:0);if(n===0)r!==null&&$u(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&$u(r),e===1)t.tag===0?Ty(Td.bind(null,t)):Vf(Td.bind(null,t)),jy(function(){!(ue&6)&&Ur()}),r=null;else{switch(wf(n)){case 1:r=jc;break;case 4:r=pf;break;case 16:r=hi;break;case 536870912:r=vf;break;default:r=hi}r=zm(r,Dm.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Dm(t,e){if(ni=-1,si=0,ue&6)throw Error(D(327));var r=t.callbackNode;if(Fn()&&t.callbackNode!==r)return null;var n=fi(t,t===Fe?Ve:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ri(t,n);else{e=n;var s=ue;ue|=2;var o=Um();(Fe!==t||Ve!==e)&&(Qt=null,Qn=Ne()+500,en(t,e));do try{Yy();break}catch(a){Lm(t,a)}while(!0);Mc(),Ni.current=o,ue=s,Te!==null?e=0:(Fe=null,Ve=0,e=Le)}if(e!==0){if(e===2&&(s=vl(t),s!==0&&(n=s,e=Gl(t,s))),e===1)throw r=Zs,en(t,0),vr(t,n),ct(t,Ne()),r;if(e===6)vr(t,n);else{if(s=t.current.alternate,!(n&30)&&!Jy(s)&&(e=Ri(t,n),e===2&&(o=vl(t),o!==0&&(n=o,e=Gl(t,o))),e===1))throw r=Zs,en(t,0),vr(t,n),ct(t,Ne()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(D(345));case 2:Gr(t,ot,Qt);break;case 3:if(vr(t,n),(n&130023424)===n&&(e=eu+500-Ne(),10<e)){if(fi(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){rt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=El(Gr.bind(null,t,ot,Qt),e);break}Gr(t,ot,Qt);break;case 4:if(vr(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-$t(n);o=1<<i,i=e[i],i>s&&(s=i),n&=~o}if(n=s,n=Ne()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ky(n/1960))-n,10<n){t.timeoutHandle=El(Gr.bind(null,t,ot,Qt),n);break}Gr(t,ot,Qt);break;case 5:Gr(t,ot,Qt);break;default:throw Error(D(329))}}}return ct(t,Ne()),t.callbackNode===r?Dm.bind(null,t):null}function Gl(t,e){var r=Os;return t.current.memoizedState.isDehydrated&&(en(t,e).flags|=256),t=Ri(t,e),t!==2&&(e=ot,ot=r,e!==null&&Hl(e)),t}function Hl(t){ot===null?ot=t:ot.push.apply(ot,t)}function Jy(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!Bt(o(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vr(t,e){for(e&=~Zc,e&=~Xi,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-$t(e),n=1<<r;t[r]=-1,e&=~n}}function Td(t){if(ue&6)throw Error(D(327));Fn();var e=fi(t,0);if(!(e&1))return ct(t,Ne()),null;var r=Ri(t,e);if(t.tag!==0&&r===2){var n=vl(t);n!==0&&(e=n,r=Gl(t,n))}if(r===1)throw r=Zs,en(t,0),vr(t,e),ct(t,Ne()),r;if(r===6)throw Error(D(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gr(t,ot,Qt),ct(t,Ne()),null}function tu(t,e){var r=ue;ue|=1;try{return t(e)}finally{ue=r,ue===0&&(Qn=Ne()+500,Ki&&Ur())}}function an(t){_r!==null&&_r.tag===0&&!(ue&6)&&Fn();var e=ue;ue|=1;var r=Et.transition,n=de;try{if(Et.transition=null,de=1,t)return t()}finally{de=n,Et.transition=r,ue=e,!(ue&6)&&Ur()}}function ru(){ht=Dn.current,pe(Dn)}function en(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Ey(r)),Te!==null)for(r=Te.return;r!==null;){var n=r;switch(Lc(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&yi();break;case 3:Kn(),pe(at),pe(Qe),Gc();break;case 5:Vc(n);break;case 4:Kn();break;case 13:pe(_e);break;case 19:pe(_e);break;case 10:Bc(n.type._context);break;case 22:case 23:ru()}r=r.return}if(Fe=t,Te=t=Pr(t.current,null),Ve=ht=e,Le=0,Zs=null,Zc=Xi=on=0,ot=Os=null,Yr!==null){for(e=0;e<Yr.length;e++)if(r=Yr[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,n.next=i}r.pending=n}Yr=null}return t}function Lm(t,e){do{var r=Te;try{if(Mc(),ei.current=Ci,ji){for(var n=be.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ji=!1}if(sn=0,Be=Ae=be=null,Ts=!1,Qs=0,Xc.current=null,r===null||r.return===null){Le=1,Zs=e,Te=null;break}e:{var o=t,i=r.return,a=r,c=e;if(e=Ve,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=vd(i);if(w!==null){w.flags&=-257,yd(w,i,a,o,e),w.mode&1&&pd(o,u,e),e=w,c=u;var p=e.updateQueue;if(p===null){var b=new Set;b.add(c),e.updateQueue=b}else p.add(c);break e}else{if(!(e&1)){pd(o,u,e),nu();break e}c=Error(D(426))}}else if(ve&&a.mode&1){var y=vd(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),yd(y,i,a,o,e),Uc(Jn(c,a));break e}}o=c=Jn(c,a),Le!==4&&(Le=2),Os===null?Os=[o]:Os.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=wm(o,c,e);ud(o,v);break e;case 1:a=c;var g=o.type,m=o.stateNode;if(!(o.flags&128)&&(typeof g.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Cr===null||!Cr.has(m)))){o.flags|=65536,e&=-e,o.lanes|=e;var _=_m(o,a,e);ud(o,_);break e}}o=o.return}while(o!==null)}Mm(r)}catch(x){e=x,Te===r&&r!==null&&(Te=r=r.return);continue}break}while(!0)}function Um(){var t=Ni.current;return Ni.current=Ci,t===null?Ci:t}function nu(){(Le===0||Le===3||Le===2)&&(Le=4),Fe===null||!(on&268435455)&&!(Xi&268435455)||vr(Fe,Ve)}function Ri(t,e){var r=ue;ue|=2;var n=Um();(Fe!==t||Ve!==e)&&(Qt=null,en(t,e));do try{Qy();break}catch(s){Lm(t,s)}while(!0);if(Mc(),ue=r,Ni.current=n,Te!==null)throw Error(D(261));return Fe=null,Ve=0,Le}function Qy(){for(;Te!==null;)$m(Te)}function Yy(){for(;Te!==null&&!Sv();)$m(Te)}function $m(t){var e=Fm(t.alternate,t,ht);t.memoizedProps=t.pendingProps,e===null?Mm(t):Te=e,Xc.current=null}function Mm(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Vy(r,e),r!==null){r.flags&=32767,Te=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Le=6,Te=null;return}}else if(r=Wy(r,e,ht),r!==null){Te=r;return}if(e=e.sibling,e!==null){Te=e;return}Te=e=t}while(e!==null);Le===0&&(Le=5)}function Gr(t,e,r){var n=de,s=Et.transition;try{Et.transition=null,de=1,Xy(t,e,r,n)}finally{Et.transition=s,de=n}return null}function Xy(t,e,r,n){do Fn();while(_r!==null);if(ue&6)throw Error(D(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(D(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(Ov(t,o),t===Fe&&(Te=Fe=null,Ve=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ao||(Ao=!0,zm(hi,function(){return Fn(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Et.transition,Et.transition=null;var i=de;de=1;var a=ue;ue|=4,Xc.current=null,Hy(t,r),Am(r,t),yy(xl),mi=!!Sl,xl=Sl=null,t.current=r,qy(r),xv(),ue=a,de=i,Et.transition=o}else t.current=r;if(Ao&&(Ao=!1,_r=t,Ti=s),o=t.pendingLanes,o===0&&(Cr=null),jv(r.stateNode),ct(t,Ne()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Pi)throw Pi=!1,t=Wl,Wl=null,t;return Ti&1&&t.tag!==0&&Fn(),o=t.pendingLanes,o&1?t===Vl?As++:(As=0,Vl=t):As=0,Ur(),null}function Fn(){if(_r!==null){var t=wf(Ti),e=Et.transition,r=de;try{if(Et.transition=null,de=16>t?16:t,_r===null)var n=!1;else{if(t=_r,_r=null,Ti=0,ue&6)throw Error(D(331));var s=ue;for(ue|=4,G=t.current;G!==null;){var o=G,i=o.child;if(G.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(G=u;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:Rs(8,d,o)}var f=d.child;if(f!==null)f.return=d,G=f;else for(;G!==null;){d=G;var h=d.sibling,w=d.return;if(Tm(d),d===u){G=null;break}if(h!==null){h.return=w,G=h;break}G=w}}}var p=o.alternate;if(p!==null){var b=p.child;if(b!==null){p.child=null;do{var y=b.sibling;b.sibling=null,b=y}while(b!==null)}}G=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,G=i;else e:for(;G!==null;){if(o=G,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Rs(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,G=v;break e}G=o.return}}var g=t.current;for(G=g;G!==null;){i=G;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,G=m;else e:for(i=g;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Yi(9,a)}}catch(x){Ee(a,a.return,x)}if(a===i){G=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,G=_;break e}G=a.return}}if(ue=s,Ur(),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Wi,t)}catch{}n=!0}return n}finally{de=r,Et.transition=e}}return!1}function Rd(t,e,r){e=Jn(r,e),e=wm(t,e,1),t=jr(t,e,1),e=rt(),t!==null&&(io(t,1,e),ct(t,e))}function Ee(t,e,r){if(t.tag===3)Rd(t,t,r);else for(;e!==null;){if(e.tag===3){Rd(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Cr===null||!Cr.has(n))){t=Jn(r,t),t=_m(e,t,1),e=jr(e,t,1),t=rt(),e!==null&&(io(e,1,t),ct(e,t));break}}e=e.return}}function Zy(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=rt(),t.pingedLanes|=t.suspendedLanes&r,Fe===t&&(Ve&r)===r&&(Le===4||Le===3&&(Ve&130023424)===Ve&&500>Ne()-eu?en(t,0):Zc|=r),ct(t,e)}function Bm(t,e){e===0&&(t.mode&1?(e=xo,xo<<=1,!(xo&130023424)&&(xo=4194304)):e=1);var r=rt();t=sr(t,e),t!==null&&(io(t,e,r),ct(t,r))}function e0(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Bm(t,r)}function t0(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(D(314))}n!==null&&n.delete(e),Bm(t,r)}var Fm;Fm=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||at.current)it=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return it=!1,zy(t,e,r);it=!!(t.flags&131072)}else it=!1,ve&&e.flags&1048576&&Gf(e,bi,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ri(t,e),t=e.pendingProps;var s=Gn(e,Qe.current);Bn(e,r),s=qc(null,e,n,t,s,r);var o=Kc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,lt(n)?(o=!0,wi(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zc(e),s.updater=Qi,e.stateNode=s,s._reactInternals=e,Ol(e,n,t,r),e=Dl(null,e,n,!0,o,r)):(e.tag=0,ve&&o&&Dc(e),et(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ri(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=n0(n),t=Ot(n,t),s){case 0:e=Il(null,e,n,t,r);break e;case 1:e=bd(null,e,n,t,r);break e;case 11:e=wd(null,e,n,t,r);break e;case 14:e=_d(null,e,n,Ot(n.type,t),r);break e}throw Error(D(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ot(n,s),Il(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ot(n,s),bd(t,e,n,s,r);case 3:e:{if(km(e),t===null)throw Error(D(387));n=e.pendingProps,o=e.memoizedState,s=o.element,Yf(t,e),ki(e,n,null,r);var i=e.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Jn(Error(D(423)),e),e=Sd(t,e,n,r,s);break e}else if(n!==s){s=Jn(Error(D(424)),e),e=Sd(t,e,n,r,s);break e}else for(gt=Er(e.stateNode.containerInfo.firstChild),pt=e,ve=!0,Lt=null,r=Jf(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Hn(),n===s){e=or(t,e,r);break e}et(t,e,n,r)}e=e.child}return e;case 5:return Xf(e),t===null&&Pl(e),n=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,kl(n,s)?i=null:o!==null&&kl(n,o)&&(e.flags|=32),xm(t,e),et(t,e,i,r),e.child;case 6:return t===null&&Pl(e),null;case 13:return Em(t,e,r);case 4:return Wc(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=qn(e,null,n,r):et(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ot(n,s),wd(t,e,n,s,r);case 7:return et(t,e,e.pendingProps,r),e.child;case 8:return et(t,e,e.pendingProps.children,r),e.child;case 12:return et(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,me(Si,n._currentValue),n._currentValue=i,o!==null)if(Bt(o.value,i)){if(o.children===s.children&&!at.current){e=or(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=tr(-1,r&-r),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),Tl(o.return,r,e),a.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(D(341));i.lanes|=r,a=i.alternate,a!==null&&(a.lanes|=r),Tl(i,r,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}et(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Bn(e,r),s=jt(s),n=n(s),e.flags|=1,et(t,e,n,r),e.child;case 14:return n=e.type,s=Ot(n,e.pendingProps),s=Ot(n.type,s),_d(t,e,n,s,r);case 15:return bm(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ot(n,s),ri(t,e),e.tag=1,lt(n)?(t=!0,wi(e)):t=!1,Bn(e,r),ym(e,n,s),Ol(e,n,s,r),Dl(null,e,n,!0,t,r);case 19:return jm(t,e,r);case 22:return Sm(t,e,r)}throw Error(D(156,e.tag))};function zm(t,e){return gf(t,e)}function r0(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kt(t,e,r,n){return new r0(t,e,r,n)}function su(t){return t=t.prototype,!(!t||!t.isReactComponent)}function n0(t){if(typeof t=="function")return su(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xc)return 11;if(t===kc)return 14}return 2}function Pr(t,e){var r=t.alternate;return r===null?(r=kt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function oi(t,e,r,n,s,o){var i=2;if(n=t,typeof t=="function")su(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case En:return tn(r.children,s,o,e);case Sc:i=8,s|=8;break;case rl:return t=kt(12,r,e,s|2),t.elementType=rl,t.lanes=o,t;case nl:return t=kt(13,r,e,s),t.elementType=nl,t.lanes=o,t;case sl:return t=kt(19,r,e,s),t.elementType=sl,t.lanes=o,t;case Yh:return Zi(r,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Jh:i=10;break e;case Qh:i=9;break e;case xc:i=11;break e;case kc:i=14;break e;case fr:i=16,n=null;break e}throw Error(D(130,t==null?t:typeof t,""))}return e=kt(i,r,e,s),e.elementType=t,e.type=n,e.lanes=o,e}function tn(t,e,r,n){return t=kt(7,t,n,e),t.lanes=r,t}function Zi(t,e,r,n){return t=kt(22,t,n,e),t.elementType=Yh,t.lanes=r,t.stateNode={isHidden:!1},t}function $a(t,e,r){return t=kt(6,t,null,e),t.lanes=r,t}function Ma(t,e,r){return e=kt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function s0(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wa(0),this.expirationTimes=wa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wa(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ou(t,e,r,n,s,o,i,a,c){return t=new s0(t,e,r,a,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=kt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},zc(o),t}function o0(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kn,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Wm(t){if(!t)return Ir;t=t._reactInternals;e:{if(cn(t)!==t||t.tag!==1)throw Error(D(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(lt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(D(171))}if(t.tag===1){var r=t.type;if(lt(r))return Wf(t,r,e)}return e}function Vm(t,e,r,n,s,o,i,a,c){return t=ou(r,n,!0,t,s,o,i,a,c),t.context=Wm(null),r=t.current,n=rt(),s=Nr(r),o=tr(n,s),o.callback=e??null,jr(r,o,s),t.current.lanes=s,io(t,s,n),ct(t,n),t}function ea(t,e,r,n){var s=e.current,o=rt(),i=Nr(s);return r=Wm(r),e.context===null?e.context=r:e.pendingContext=r,e=tr(o,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=jr(s,e,i),t!==null&&(Mt(t,s,i,o),Zo(t,s,i)),i}function Oi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Od(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function iu(t,e){Od(t,e),(t=t.alternate)&&Od(t,e)}function i0(){return null}var Gm=typeof reportError=="function"?reportError:function(t){console.error(t)};function au(t){this._internalRoot=t}ta.prototype.render=au.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(D(409));ea(t,e,null,null)};ta.prototype.unmount=au.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;an(function(){ea(null,t,null,null)}),e[nr]=null}};function ta(t){this._internalRoot=t}ta.prototype.unstable_scheduleHydration=function(t){if(t){var e=Sf();t={blockedOn:null,target:t,priority:e};for(var r=0;r<pr.length&&e!==0&&e<pr[r].priority;r++);pr.splice(r,0,t),r===0&&kf(t)}};function lu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ra(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ad(){}function a0(t,e,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var u=Oi(i);o.call(u)}}var i=Vm(e,n,t,0,null,!1,!1,"",Ad);return t._reactRootContainer=i,t[nr]=i.current,Gs(t.nodeType===8?t.parentNode:t),an(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var u=Oi(c);a.call(u)}}var c=ou(t,0,!1,null,null,!1,!1,"",Ad);return t._reactRootContainer=c,t[nr]=c.current,Gs(t.nodeType===8?t.parentNode:t),an(function(){ea(e,c,r,n)}),c}function na(t,e,r,n,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var c=Oi(i);a.call(c)}}ea(e,i,t,s)}else i=a0(r,e,t,s,n);return Oi(i)}_f=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=bs(e.pendingLanes);r!==0&&(Cc(e,r|1),ct(e,Ne()),!(ue&6)&&(Qn=Ne()+500,Ur()))}break;case 13:an(function(){var n=sr(t,1);if(n!==null){var s=rt();Mt(n,t,1,s)}}),iu(t,1)}};Nc=function(t){if(t.tag===13){var e=sr(t,134217728);if(e!==null){var r=rt();Mt(e,t,134217728,r)}iu(t,134217728)}};bf=function(t){if(t.tag===13){var e=Nr(t),r=sr(t,e);if(r!==null){var n=rt();Mt(r,t,e,n)}iu(t,e)}};Sf=function(){return de};xf=function(t,e){var r=de;try{return de=t,e()}finally{de=r}};ml=function(t,e,r){switch(e){case"input":if(al(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=qi(n);if(!s)throw Error(D(90));Zh(n),al(n,s)}}}break;case"textarea":tf(t,r);break;case"select":e=r.value,e!=null&&Ln(t,!!r.multiple,e,!1)}};cf=tu;uf=an;var l0={usingClientEntryPoint:!1,Events:[lo,Pn,qi,af,lf,tu]},ps={findFiberByHostInstance:Qr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},c0={bundleType:ps.bundleType,version:ps.version,rendererPackageName:ps.rendererPackageName,rendererConfig:ps.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ff(t),t===null?null:t.stateNode},findFiberByHostInstance:ps.findFiberByHostInstance||i0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Io.isDisabled&&Io.supportsFiber)try{Wi=Io.inject(c0),qt=Io}catch{}}yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l0;yt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lu(e))throw Error(D(200));return o0(t,e,null,r)};yt.createRoot=function(t,e){if(!lu(t))throw Error(D(299));var r=!1,n="",s=Gm;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ou(t,1,!1,null,null,r,!1,n,s),t[nr]=e.current,Gs(t.nodeType===8?t.parentNode:t),new au(e)};yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(D(188)):(t=Object.keys(t).join(","),Error(D(268,t)));return t=ff(e),t=t===null?null:t.stateNode,t};yt.flushSync=function(t){return an(t)};yt.hydrate=function(t,e,r){if(!ra(e))throw Error(D(200));return na(null,t,e,!0,r)};yt.hydrateRoot=function(t,e,r){if(!lu(t))throw Error(D(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",i=Gm;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=Vm(e,null,t,1,r??null,s,!1,o,i),t[nr]=e.current,Gs(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new ta(e)};yt.render=function(t,e,r){if(!ra(e))throw Error(D(200));return na(null,t,e,!1,r)};yt.unmountComponentAtNode=function(t){if(!ra(t))throw Error(D(40));return t._reactRootContainer?(an(function(){na(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};yt.unstable_batchedUpdates=tu;yt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ra(r))throw Error(D(200));if(t==null||t._reactInternals===void 0)throw Error(D(38));return na(t,e,r,!1,n)};yt.version="18.3.1-next-f1338f8080-20240426";function Hm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hm)}catch(t){console.error(t)}}Hm(),Gh.exports=yt;var u0=Gh.exports,qm,Id=u0;qm=Id.createRoot,Id.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eo(){return eo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eo.apply(this,arguments)}var br;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(br||(br={}));const Dd="popstate";function d0(t){t===void 0&&(t={});function e(s,o){let{pathname:i="/",search:a="",hash:c=""}=un(s.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),ql("",{pathname:i,search:a,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(s,o){let i=s.document.querySelector("base"),a="";if(i&&i.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");a=u===-1?c:c.slice(0,u)}return a+"#"+(typeof o=="string"?o:Ai(o))}function n(s,o){sa(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return f0(e,r,n,t)}function Se(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function sa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function h0(){return Math.random().toString(36).substr(2,8)}function Ld(t,e){return{usr:t.state,key:t.key,idx:e}}function ql(t,e,r,n){return r===void 0&&(r=null),eo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?un(e):e,{state:r,key:e&&e.key||n||h0()})}function Ai(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function un(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function f0(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:o=!1}=n,i=s.history,a=br.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(eo({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){a=br.Pop;let y=d(),v=y==null?null:y-u;u=y,c&&c({action:a,location:b.location,delta:v})}function h(y,v){a=br.Push;let g=ql(b.location,y,v);r&&r(g,y),u=d()+1;let m=Ld(g,u),_=b.createHref(g);try{i.pushState(m,"",_)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;s.location.assign(_)}o&&c&&c({action:a,location:b.location,delta:1})}function w(y,v){a=br.Replace;let g=ql(b.location,y,v);r&&r(g,y),u=d();let m=Ld(g,u),_=b.createHref(g);i.replaceState(m,"",_),o&&c&&c({action:a,location:b.location,delta:0})}function p(y){let v=s.location.origin!=="null"?s.location.origin:s.location.href,g=typeof y=="string"?y:Ai(y);return g=g.replace(/ $/,"%20"),Se(v,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,v)}let b={get action(){return a},get location(){return t(s,i)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Dd,f),c=y,()=>{s.removeEventListener(Dd,f),c=null}},createHref(y){return e(s,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:w,go(y){return i.go(y)}};return b}var Ud;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ud||(Ud={}));function m0(t,e,r){return r===void 0&&(r="/"),g0(t,e,r)}function g0(t,e,r,n){let s=typeof e=="string"?un(e):e,o=Yn(s.pathname||"/",r);if(o==null)return null;let i=Km(t);p0(i);let a=null;for(let c=0;a==null&&c<i.length;++c){let u=C0(o);a=E0(i[c],u)}return a}function Km(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(o,i,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Se(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Tr([n,c.relativePath]),d=r.concat(c);o.children&&o.children.length>0&&(Se(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Km(o.children,e,d,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:x0(u,o.index),routesMeta:d})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let c of Jm(o.path))s(o,i,c)}),e}function Jm(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let i=Jm(n.join("/")),a=[];return a.push(...i.map(c=>c===""?o:[o,c].join("/"))),s&&a.push(...i),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function p0(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:k0(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const v0=/^:[\w-]+$/,y0=3,w0=2,_0=1,b0=10,S0=-2,$d=t=>t==="*";function x0(t,e){let r=t.split("/"),n=r.length;return r.some($d)&&(n+=S0),e&&(n+=w0),r.filter(s=>!$d(s)).reduce((s,o)=>s+(v0.test(o)?y0:o===""?_0:b0),n)}function k0(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function E0(t,e,r){let{routesMeta:n}=t,s={},o="/",i=[];for(let a=0;a<n.length;++a){let c=n[a],u=a===n.length-1,d=o==="/"?e:e.slice(o.length)||"/",f=Kl({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:Tr([o,f.pathname]),pathnameBase:O0(Tr([o,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(o=Tr([o,f.pathnameBase]))}return i}function Kl(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=j0(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:w}=d;if(h==="*"){let b=a[f]||"";i=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const p=a[f];return w&&!p?u[h]=void 0:u[h]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:t}}function j0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),sa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,c)=>(n.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function C0(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return sa(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Yn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const N0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,P0=t=>N0.test(t);function T0(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?un(t):t,o;if(r)if(P0(r))o=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),sa(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?o=Md(r.substring(1),"/"):o=Md(r,e)}else o=e;return{pathname:o,search:A0(n),hash:I0(s)}}function Md(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Ba(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function R0(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function cu(t,e){let r=R0(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function uu(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=un(t):(s=eo({},t),Se(!s.pathname||!s.pathname.includes("?"),Ba("?","pathname","search",s)),Se(!s.pathname||!s.pathname.includes("#"),Ba("#","pathname","hash",s)),Se(!s.search||!s.search.includes("#"),Ba("#","search","hash",s)));let o=t===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=r;else{let f=e.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}a=f>=0?e[f]:"/"}let c=T0(s,a),u=i&&i!=="/"&&i.endsWith("/"),d=(o||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Tr=t=>t.join("/").replace(/\/\/+/g,"/"),O0=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),A0=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,I0=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function D0(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Qm=["post","put","patch","delete"];new Set(Qm);const L0=["get",...Qm];new Set(L0);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function to(){return to=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},to.apply(this,arguments)}const oa=S.createContext(null),Ym=S.createContext(null),ar=S.createContext(null),ia=S.createContext(null),lr=S.createContext({outlet:null,matches:[],isDataRoute:!1}),Xm=S.createContext(null);function U0(t,e){let{relative:r}=e===void 0?{}:e;ss()||Se(!1);let{basename:n,navigator:s}=S.useContext(ar),{hash:o,pathname:i,search:a}=aa(t,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:Tr([n,i])),s.createHref({pathname:c,search:a,hash:o})}function ss(){return S.useContext(ia)!=null}function Ft(){return ss()||Se(!1),S.useContext(ia).location}function Zm(t){S.useContext(ar).static||S.useLayoutEffect(t)}function Re(){let{isDataRoute:t}=S.useContext(lr);return t?Y0():$0()}function $0(){ss()||Se(!1);let t=S.useContext(oa),{basename:e,future:r,navigator:n}=S.useContext(ar),{matches:s}=S.useContext(lr),{pathname:o}=Ft(),i=JSON.stringify(cu(s,r.v7_relativeSplatPath)),a=S.useRef(!1);return Zm(()=>{a.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let f=uu(u,JSON.parse(i),o,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Tr([e,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[e,n,i,o,t])}function M0(){let{matches:t}=S.useContext(lr),e=t[t.length-1];return e?e.params:{}}function aa(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=S.useContext(ar),{matches:s}=S.useContext(lr),{pathname:o}=Ft(),i=JSON.stringify(cu(s,n.v7_relativeSplatPath));return S.useMemo(()=>uu(t,JSON.parse(i),o,r==="path"),[t,i,o,r])}function B0(t,e){return F0(t,e)}function F0(t,e,r,n){ss()||Se(!1);let{navigator:s}=S.useContext(ar),{matches:o}=S.useContext(lr),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=Ft(),d;if(e){var f;let y=typeof e=="string"?un(e):e;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||Se(!1),d=y}else d=u;let h=d.pathname||"/",w=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");w="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=m0(t,{pathname:w}),b=H0(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Tr([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Tr([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,r,n);return e&&b?S.createElement(ia.Provider,{value:{location:to({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:br.Pop}},b):b}function z0(){let t=Q0(),e=D0(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),r?S.createElement("pre",{style:s},r):null,null)}const W0=S.createElement(z0,null);class V0 extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?S.createElement(lr.Provider,{value:this.props.routeContext},S.createElement(Xm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function G0(t){let{routeContext:e,match:r,children:n}=t,s=S.useContext(oa);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(lr.Provider,{value:e},n)}function H0(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,a=(s=r)==null?void 0:s.errors;if(a!=null){let d=i.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);d>=0||Se(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:w}=r,p=f.route.loader&&h[f.route.id]===void 0&&(!w||w[f.route.id]===void 0);if(f.route.lazy||p){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,h)=>{let w,p=!1,b=null,y=null;r&&(w=a&&f.route.id?a[f.route.id]:void 0,b=f.route.errorElement||W0,c&&(u<0&&h===0?(X0("route-fallback"),p=!0,y=null):u===h&&(p=!0,y=f.route.hydrateFallbackElement||null)));let v=e.concat(i.slice(0,h+1)),g=()=>{let m;return w?m=b:p?m=y:f.route.Component?m=S.createElement(f.route.Component,null):f.route.element?m=f.route.element:m=d,S.createElement(G0,{match:f,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:m})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?S.createElement(V0,{location:r.location,revalidation:r.revalidation,component:b,error:w,children:g(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):g()},null)}var eg=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eg||{}),tg=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tg||{});function q0(t){let e=S.useContext(oa);return e||Se(!1),e}function K0(t){let e=S.useContext(Ym);return e||Se(!1),e}function J0(t){let e=S.useContext(lr);return e||Se(!1),e}function rg(t){let e=J0(),r=e.matches[e.matches.length-1];return r.route.id||Se(!1),r.route.id}function Q0(){var t;let e=S.useContext(Xm),r=K0(),n=rg();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function Y0(){let{router:t}=q0(eg.UseNavigateStable),e=rg(tg.UseNavigateStable),r=S.useRef(!1);return Zm(()=>{r.current=!0}),S.useCallback(function(s,o){o===void 0&&(o={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,to({fromRouteId:e},o)))},[t,e])}const Bd={};function X0(t,e,r){Bd[t]||(Bd[t]=!0)}function Z0(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function ew(t){let{to:e,replace:r,state:n,relative:s}=t;ss()||Se(!1);let{future:o,static:i}=S.useContext(ar),{matches:a}=S.useContext(lr),{pathname:c}=Ft(),u=Re(),d=uu(e,cu(a,o.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Ze(t){Se(!1)}function tw(t){let{basename:e="/",children:r=null,location:n,navigationType:s=br.Pop,navigator:o,static:i=!1,future:a}=t;ss()&&Se(!1);let c=e.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:o,static:i,future:to({v7_relativeSplatPath:!1},a)}),[c,a,o,i]);typeof n=="string"&&(n=un(n));let{pathname:d="/",search:f="",hash:h="",state:w=null,key:p="default"}=n,b=S.useMemo(()=>{let y=Yn(d,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:w,key:p},navigationType:s}},[c,d,f,h,w,p,s]);return b==null?null:S.createElement(ar.Provider,{value:u},S.createElement(ia.Provider,{children:r,value:b}))}function rw(t){let{children:e,location:r}=t;return B0(Jl(e),r)}new Promise(()=>{});function Jl(t,e){e===void 0&&(e=[]);let r=[];return S.Children.forEach(t,(n,s)=>{if(!S.isValidElement(n))return;let o=[...e,s];if(n.type===S.Fragment){r.push.apply(r,Jl(n.props.children,o));return}n.type!==Ze&&Se(!1),!n.props.index||!n.props.children||Se(!1);let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Jl(n.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ii(){return Ii=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ii.apply(this,arguments)}function ng(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function nw(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function sw(t,e){return t.button===0&&(!e||e==="_self")&&!nw(t)}function Ql(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function ow(t,e){let r=Ql(t);return e&&e.forEach((n,s)=>{r.has(s)||e.getAll(s).forEach(o=>{r.append(s,o)})}),r}const iw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],aw=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],lw="6";try{window.__reactRouterVersion=lw}catch{}const cw=S.createContext({isTransitioning:!1}),uw="startTransition",Fd=Zp[uw];function dw(t){let{basename:e,children:r,future:n,window:s}=t,o=S.useRef();o.current==null&&(o.current=d0({window:s,v5Compat:!0}));let i=o.current,[a,c]=S.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=S.useCallback(f=>{u&&Fd?Fd(()=>c(f)):c(f)},[c,u]);return S.useLayoutEffect(()=>i.listen(d),[i,d]),S.useEffect(()=>Z0(n),[n]),S.createElement(tw,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:i,future:n})}const hw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sg=S.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:o,replace:i,state:a,target:c,to:u,preventScrollReset:d,viewTransition:f}=e,h=ng(e,iw),{basename:w}=S.useContext(ar),p,b=!1;if(typeof u=="string"&&fw.test(u)&&(p=u,hw))try{let m=new URL(window.location.href),_=u.startsWith("//")?new URL(m.protocol+u):new URL(u),x=Yn(_.pathname,w);_.origin===m.origin&&x!=null?u=x+_.search+_.hash:b=!0}catch{}let y=U0(u,{relative:s}),v=gw(u,{replace:i,state:a,target:c,preventScrollReset:d,relative:s,viewTransition:f});function g(m){n&&n(m),m.defaultPrevented||v(m)}return S.createElement("a",Ii({},h,{href:p||y,onClick:b||o?n:g,ref:r,target:c}))}),Do=S.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:o="",end:i=!1,style:a,to:c,viewTransition:u,children:d}=e,f=ng(e,aw),h=aa(c,{relative:f.relative}),w=Ft(),p=S.useContext(Ym),{navigator:b,basename:y}=S.useContext(ar),v=p!=null&&pw(h)&&u===!0,g=b.encodeLocation?b.encodeLocation(h).pathname:h.pathname,m=w.pathname,_=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;s||(m=m.toLowerCase(),_=_?_.toLowerCase():null,g=g.toLowerCase()),_&&y&&(_=Yn(_,y)||_);const x=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let k=m===g||!i&&m.startsWith(g)&&m.charAt(x)==="/",E=_!=null&&(_===g||!i&&_.startsWith(g)&&_.charAt(g.length)==="/"),j={isActive:k,isPending:E,isTransitioning:v},N=k?n:void 0,P;typeof o=="function"?P=o(j):P=[o,k?"active":null,E?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(j):a;return S.createElement(sg,Ii({},f,{"aria-current":N,className:P,ref:r,style:M,to:c,viewTransition:u}),typeof d=="function"?d(j):d)});var Yl;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Yl||(Yl={}));var zd;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(zd||(zd={}));function mw(t){let e=S.useContext(oa);return e||Se(!1),e}function gw(t,e){let{target:r,replace:n,state:s,preventScrollReset:o,relative:i,viewTransition:a}=e===void 0?{}:e,c=Re(),u=Ft(),d=aa(t,{relative:i});return S.useCallback(f=>{if(sw(f,r)){f.preventDefault();let h=n!==void 0?n:Ai(u)===Ai(d);c(t,{replace:h,state:s,preventScrollReset:o,relative:i,viewTransition:a})}},[u,c,d,n,s,r,t,o,i,a])}function du(t){let e=S.useRef(Ql(t)),r=S.useRef(!1),n=Ft(),s=S.useMemo(()=>ow(n.search,r.current?null:e.current),[n.search]),o=Re(),i=S.useCallback((a,c)=>{const u=Ql(typeof a=="function"?a(s):a);r.current=!0,o("?"+u,c)},[o,s]);return[s,i]}function pw(t,e){e===void 0&&(e={});let r=S.useContext(cw);r==null&&Se(!1);let{basename:n}=mw(Yl.useViewTransitionState),s=aa(t,{relative:e.relative});if(!r.isTransitioning)return!1;let o=Yn(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Yn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Kl(s.pathname,i)!=null||Kl(s.pathname,o)!=null}var Xl=function(t,e){return Xl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Xl(t,e)};function og(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Xl(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Di=function(){return Di=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Di.apply(this,arguments)};function os(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function ig(t,e,r,n){var s=arguments.length,o=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o}function ag(t,e){return function(r,n){e(r,n,t)}}function lg(t,e,r,n,s,o){function i(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var a=n.kind,c=a==="getter"?"get":a==="setter"?"set":"value",u=!e&&t?n.static?t:t.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f,h=!1,w=r.length-1;w>=0;w--){var p={};for(var b in n)p[b]=b==="access"?{}:n[b];for(var b in n.access)p.access[b]=n.access[b];p.addInitializer=function(v){if(h)throw new TypeError("Cannot add initializers after decoration has completed");o.push(i(v||null))};var y=(0,r[w])(a==="accessor"?{get:d.get,set:d.set}:d[c],p);if(a==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(f=i(y.get))&&(d.get=f),(f=i(y.set))&&(d.set=f),(f=i(y.init))&&s.unshift(f)}else(f=i(y))&&(a==="field"?s.unshift(f):d[c]=f)}u&&Object.defineProperty(u,n.name,d),h=!0}function cg(t,e,r){for(var n=arguments.length>2,s=0;s<e.length;s++)r=n?e[s].call(t,r):e[s].call(t);return n?r:void 0}function ug(t){return typeof t=="symbol"?t:"".concat(t)}function dg(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function hg(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function q(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?o(d.value):s(d.value).then(a,c)}u((n=n.apply(t,e||[])).next())})}function fg(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,s,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],s=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var la=Object.create?function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};function mg(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&la(e,t,r)}function Li(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hu(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,o=[],i;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)o.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return o}function gg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(hu(arguments[e]));return t}function pg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var o=arguments[e],i=0,a=o.length;i<a;i++,s++)n[s]=o[i];return n}function vg(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,o;n<s;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))}function Xn(t){return this instanceof Xn?(this.v=t,this):new Xn(t)}function yg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(w){return function(p){return Promise.resolve(p).then(w,f)}}function a(w,p){n[w]&&(s[w]=function(b){return new Promise(function(y,v){o.push([w,b,y,v])>1||c(w,b)})},p&&(s[w]=p(s[w])))}function c(w,p){try{u(n[w](p))}catch(b){h(o[0][3],b)}}function u(w){w.value instanceof Xn?Promise.resolve(w.value.v).then(d,f):h(o[0][2],w)}function d(w){c("next",w)}function f(w){c("throw",w)}function h(w,p){w(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function wg(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,o){e[s]=t[s]?function(i){return(r=!r)?{value:Xn(t[s](i)),done:!1}:o?o(i):i}:o}}function _g(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Li=="function"?Li(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(i){return new Promise(function(a,c){i=t[o](i),s(a,c,i.done,i.value)})}}function s(o,i,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},i)}}function bg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var vw=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},Zl=function(t){return Zl=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},Zl(t)};function Sg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Zl(t),n=0;n<r.length;n++)r[n]!=="default"&&la(e,t,r[n]);return vw(e,t),e}function xg(t){return t&&t.__esModule?t:{default:t}}function kg(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function Eg(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r}function jg(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Cg(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(o){return Promise.reject(o)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var yw=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function Ng(t){function e(o){t.error=t.hasError?new yw(o,t.error,"An error was suppressed during disposal."):o,t.hasError=!0}var r,n=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(o).then(s,function(i){return e(i),s()})}else n|=1}catch(i){e(i)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}function Pg(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,o,i){return n?e?".jsx":".js":s&&(!o||!i)?r:s+o+"."+i.toLowerCase()+"js"}):t}const ww={__extends:og,__assign:Di,__rest:os,__decorate:ig,__param:ag,__esDecorate:lg,__runInitializers:cg,__propKey:ug,__setFunctionName:dg,__metadata:hg,__awaiter:q,__generator:fg,__createBinding:la,__exportStar:mg,__values:Li,__read:hu,__spread:gg,__spreadArrays:pg,__spreadArray:vg,__await:Xn,__asyncGenerator:yg,__asyncDelegator:wg,__asyncValues:_g,__makeTemplateObject:bg,__importStar:Sg,__importDefault:xg,__classPrivateFieldGet:kg,__classPrivateFieldSet:Eg,__classPrivateFieldIn:jg,__addDisposableResource:Cg,__disposeResources:Ng,__rewriteRelativeImportExtension:Pg},_w=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Cg,get __assign(){return Di},__asyncDelegator:wg,__asyncGenerator:yg,__asyncValues:_g,__await:Xn,__awaiter:q,__classPrivateFieldGet:kg,__classPrivateFieldIn:jg,__classPrivateFieldSet:Eg,__createBinding:la,__decorate:ig,__disposeResources:Ng,__esDecorate:lg,__exportStar:mg,__extends:og,__generator:fg,__importDefault:xg,__importStar:Sg,__makeTemplateObject:bg,__metadata:hg,__param:ag,__propKey:ug,__read:hu,__rest:os,__rewriteRelativeImportExtension:Pg,__runInitializers:cg,__setFunctionName:dg,__spread:gg,__spreadArray:vg,__spreadArrays:pg,__values:Li,default:ww},Symbol.toStringTag,{value:"Module"})),bw=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class fu extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Sw extends fu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Wd extends fu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Vd extends fu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ec;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ec||(ec={}));class xw{constructor(e,{headers:r={},customFetch:n,region:s=ec.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=bw(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return q(this,arguments,void 0,function*(r,n={}){var s;let o,i;try{const{headers:a,method:c,body:u,signal:d,timeout:f}=n;let h={},{region:w}=n;w||(w=this.region);const p=new URL(`${this.url}/${r}`);w&&w!=="any"&&(h["x-region"]=w,p.searchParams.set("forceFunctionRegion",w));let b;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",b=u):typeof u=="string"?(h["Content-Type"]="text/plain",b=u):typeof FormData<"u"&&u instanceof FormData?b=u:(h["Content-Type"]="application/json",b=JSON.stringify(u)):b=u;let y=d;f&&(i=new AbortController,o=setTimeout(()=>i.abort(),f),d?(y=i.signal,d.addEventListener("abort",()=>i.abort())):y=i.signal);const v=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),a),body:b,signal:y}).catch(x=>{throw new Sw(x)}),g=v.headers.get("x-relay-error");if(g&&g==="true")throw new Wd(v);if(!v.ok)throw new Vd(v);let m=((s=v.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return m==="application/json"?_=yield v.json():m==="application/octet-stream"||m==="application/pdf"?_=yield v.blob():m==="text/event-stream"?_=v:m==="multipart/form-data"?_=yield v.formData():_=yield v.text(),{data:_,error:null,response:v}}catch(a){return{data:null,error:a,response:a instanceof Vd||a instanceof Wd?a.context:void 0}}finally{o&&clearTimeout(o)}})}}var tt={};const is=Up(_w);var Lo={},Uo={},$o={},Mo={},Bo={},Fo={},Gd;function Tg(){if(Gd)return Fo;Gd=1,Object.defineProperty(Fo,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Fo.default=t,Fo}var Hd;function Rg(){if(Hd)return Bo;Hd=1,Object.defineProperty(Bo,"__esModule",{value:!0});const e=is.__importDefault(Tg());class r{constructor(s){var o,i;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(o=s.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=s.signal,this.isMaybeSingle=(i=s.isMaybeSingle)!==null&&i!==void 0?i:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,o){return this.headers=new Headers(this.headers),this.headers.set(s,o),this}then(s,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let w=null,p=null,b=null,y=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const x=await c.text();x===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?p=x:p=JSON.parse(x))}const m=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),_=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");m&&_&&_.length>1&&(b=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(w={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,b=null,y=406,v="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const m=await c.text();try{w=JSON.parse(m),Array.isArray(w)&&c.status===404&&(p=[],w=null,y=200,v="OK")}catch{c.status===404&&m===""?(y=204,v="No Content"):w={message:m}}if(w&&this.isMaybeSingle&&(!((h=w==null?void 0:w.details)===null||h===void 0)&&h.includes("0 rows"))&&(w=null,y=200,v="OK"),w&&this.shouldThrowOnError)throw new e.default(w)}return{error:w,data:p,count:b,status:y,statusText:v}});return this.shouldThrowOnError||(a=a.catch(c=>{var u,d,f,h,w,p;let b="";const y=c==null?void 0:c.cause;if(y){const v=(u=y==null?void 0:y.message)!==null&&u!==void 0?u:"",g=(d=y==null?void 0:y.code)!==null&&d!==void 0?d:"";b=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,b+=`

Caused by: ${(h=y==null?void 0:y.name)!==null&&h!==void 0?h:"Error"}: ${v}`,g&&(b+=` (${g})`),y!=null&&y.stack&&(b+=`
${y.stack}`)}else b=(w=c==null?void 0:c.stack)!==null&&w!==void 0?w:"";return{error:{message:`${(p=c==null?void 0:c.name)!==null&&p!==void 0?p:"FetchError"}: ${c==null?void 0:c.message}`,details:b,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(s,o)}returns(){return this}overrideTypes(){return this}}return Bo.default=r,Bo}var qd;function Og(){if(qd)return Mo;qd=1,Object.defineProperty(Mo,"__esModule",{value:!0});const e=is.__importDefault(Rg());class r extends e.default{select(s){let o=!1;const i=(s??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:o=!0,nullsFirst:i,foreignTable:a,referencedTable:c=a}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${s}.${o?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:o,referencedTable:i=o}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,o,{foreignTable:i,referencedTable:a=i}={}){const c=typeof a>"u"?"offset":`${a}.offset`,u=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(u,`${o-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:o=!1,settings:i=!1,buffers:a=!1,wal:c=!1,format:u="text"}={}){var d;const f=[s?"analyze":null,o?"verbose":null,i?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Mo.default=r,Mo}var Kd;function mu(){if(Kd)return $o;Kd=1,Object.defineProperty($o,"__esModule",{value:!0});const e=is.__importDefault(Og()),r=new RegExp("[,()]");class n extends e.default{eq(o,i){return this.url.searchParams.append(o,`eq.${i}`),this}neq(o,i){return this.url.searchParams.append(o,`neq.${i}`),this}gt(o,i){return this.url.searchParams.append(o,`gt.${i}`),this}gte(o,i){return this.url.searchParams.append(o,`gte.${i}`),this}lt(o,i){return this.url.searchParams.append(o,`lt.${i}`),this}lte(o,i){return this.url.searchParams.append(o,`lte.${i}`),this}like(o,i){return this.url.searchParams.append(o,`like.${i}`),this}likeAllOf(o,i){return this.url.searchParams.append(o,`like(all).{${i.join(",")}}`),this}likeAnyOf(o,i){return this.url.searchParams.append(o,`like(any).{${i.join(",")}}`),this}ilike(o,i){return this.url.searchParams.append(o,`ilike.${i}`),this}ilikeAllOf(o,i){return this.url.searchParams.append(o,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(o,i){return this.url.searchParams.append(o,`ilike(any).{${i.join(",")}}`),this}regexMatch(o,i){return this.url.searchParams.append(o,`match.${i}`),this}regexIMatch(o,i){return this.url.searchParams.append(o,`imatch.${i}`),this}is(o,i){return this.url.searchParams.append(o,`is.${i}`),this}isDistinct(o,i){return this.url.searchParams.append(o,`isdistinct.${i}`),this}in(o,i){const a=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(o,`in.(${a})`),this}contains(o,i){return typeof i=="string"?this.url.searchParams.append(o,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(o,`cs.{${i.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(i)}`),this}containedBy(o,i){return typeof i=="string"?this.url.searchParams.append(o,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(o,`cd.{${i.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(i)}`),this}rangeGt(o,i){return this.url.searchParams.append(o,`sr.${i}`),this}rangeGte(o,i){return this.url.searchParams.append(o,`nxl.${i}`),this}rangeLt(o,i){return this.url.searchParams.append(o,`sl.${i}`),this}rangeLte(o,i){return this.url.searchParams.append(o,`nxr.${i}`),this}rangeAdjacent(o,i){return this.url.searchParams.append(o,`adj.${i}`),this}overlaps(o,i){return typeof i=="string"?this.url.searchParams.append(o,`ov.${i}`):this.url.searchParams.append(o,`ov.{${i.join(",")}}`),this}textSearch(o,i,{config:a,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=a===void 0?"":`(${a})`;return this.url.searchParams.append(o,`${u}fts${d}.${i}`),this}match(o){return Object.entries(o).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(o,i,a){return this.url.searchParams.append(o,`not.${i}.${a}`),this}or(o,{foreignTable:i,referencedTable:a=i}={}){const c=a?`${a}.or`:"or";return this.url.searchParams.append(c,`(${o})`),this}filter(o,i,a){return this.url.searchParams.append(o,`${i}.${a}`),this}}return $o.default=n,$o}var Jd;function Ag(){if(Jd)return Uo;Jd=1,Object.defineProperty(Uo,"__esModule",{value:!0});const e=is.__importDefault(mu());class r{constructor(s,{headers:o={},schema:i,fetch:a}){this.url=s,this.headers=new Headers(o),this.schema=i,this.fetch=a}select(s,o){const{head:i=!1,count:a}=o??{},c=i?"HEAD":"GET";let u=!1;const d=(s??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:o,defaultToNull:i=!0}={}){var a;const c="POST";if(o&&this.headers.append("Prefer",`count=${o}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const u=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(s,{onConflict:o,ignoreDuplicates:i=!1,count:a,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),a&&this.headers.append("Prefer",`count=${a}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const f=s.reduce((h,w)=>h.concat(Object.keys(w)),[]);if(f.length>0){const h=[...new Set(f)].map(w=>`"${w}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(s,{count:o}={}){var i;const a="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:s}={}){var o;const i="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Uo.default=r,Uo}var Qd;function kw(){if(Qd)return Lo;Qd=1,Object.defineProperty(Lo,"__esModule",{value:!0});const t=is,e=t.__importDefault(Ag()),r=t.__importDefault(mu());class n{constructor(o,{headers:i={},schema:a,fetch:c}={}){this.url=o,this.headers=new Headers(i),this.schemaName=a,this.fetch=c}from(o){if(!o||typeof o!="string"||o.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const i=new URL(`${this.url}/${o}`);return new e.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,i={},{head:a=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${o}`);let w;a||c?(f=a?"HEAD":"GET",Object.entries(i).filter(([b,y])=>y!==void 0).map(([b,y])=>[b,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([b,y])=>{h.searchParams.append(b,y)})):(f="POST",w=i);const p=new Headers(this.headers);return u&&p.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:p,schema:this.schemaName,body:w,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Lo.default=n,Lo}Object.defineProperty(tt,"__esModule",{value:!0});var Ig=tt.PostgrestError=Vg=tt.PostgrestBuilder=zg=tt.PostgrestTransformBuilder=Bg=tt.PostgrestFilterBuilder=$g=tt.PostgrestQueryBuilder=Lg=tt.PostgrestClient=void 0;const as=is,Dg=as.__importDefault(kw());var Lg=tt.PostgrestClient=Dg.default;const Ug=as.__importDefault(Ag());var $g=tt.PostgrestQueryBuilder=Ug.default;const Mg=as.__importDefault(mu());var Bg=tt.PostgrestFilterBuilder=Mg.default;const Fg=as.__importDefault(Og());var zg=tt.PostgrestTransformBuilder=Fg.default;const Wg=as.__importDefault(Rg());var Vg=tt.PostgrestBuilder=Wg.default;const Gg=as.__importDefault(Tg());Ig=tt.PostgrestError=Gg.default;var Hg=tt.default={PostgrestClient:Dg.default,PostgrestQueryBuilder:Ug.default,PostgrestFilterBuilder:Mg.default,PostgrestTransformBuilder:Fg.default,PostgrestBuilder:Wg.default,PostgrestError:Gg.default};const Ew=Oh({__proto__:null,get PostgrestBuilder(){return Vg},get PostgrestClient(){return Lg},get PostgrestError(){return Ig},get PostgrestFilterBuilder(){return Bg},get PostgrestQueryBuilder(){return $g},get PostgrestTransformBuilder(){return zg},default:Hg},[tt]),{PostgrestClient:jw,PostgrestQueryBuilder:Nx,PostgrestFilterBuilder:Px,PostgrestTransformBuilder:Tx,PostgrestBuilder:Rx,PostgrestError:Ox}=Hg||Ew;class Cw{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Nw="2.84.0",Pw=`realtime-js/${Nw}`,qg="1.0.0",Tw="2.0.0",Yd=qg,tc=1e4,Rw=1e3,Ow=100;var qr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(qr||(qr={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var Dt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Dt||(Dt={}));var rc;(function(t){t.websocket="websocket"})(rc||(rc={}));var Kr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Kr||(Kr={}));class Aw{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n,s,o;const i=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",c=(n=e.join_ref)!==null&&n!==void 0?n:"",u=e.payload.event,d=(o=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&o!==void 0?o:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+a.length+i.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let w=new DataView(h),p=0;w.setUint8(p++,this.KINDS.userBroadcastPush),w.setUint8(p++,c.length),w.setUint8(p++,a.length),w.setUint8(p++,i.length),w.setUint8(p++,u.length),w.setUint8(p++,this.BINARY_ENCODING),Array.from(c,y=>w.setUint8(p++,y.charCodeAt(0))),Array.from(a,y=>w.setUint8(p++,y.charCodeAt(0))),Array.from(i,y=>w.setUint8(p++,y.charCodeAt(0))),Array.from(u,y=>w.setUint8(p++,y.charCodeAt(0)));var b=new Uint8Array(h.byteLength+d.byteLength);return b.set(new Uint8Array(h),0),b.set(new Uint8Array(d),h.byteLength),b.buffer}_encodeJsonUserBroadcastPush(e){var r,n,s,o;const i=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",c=(n=e.join_ref)!==null&&n!==void 0?n:"",u=e.payload.event,d=(o=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&o!==void 0?o:{},h=new TextEncoder().encode(JSON.stringify(d)).buffer,w=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+a.length+i.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+w);let b=new DataView(p),y=0;b.setUint8(y++,this.KINDS.userBroadcastPush),b.setUint8(y++,c.length),b.setUint8(y++,a.length),b.setUint8(y++,i.length),b.setUint8(y++,u.length),b.setUint8(y++,this.JSON_ENCODING),Array.from(c,g=>b.setUint8(y++,g.charCodeAt(0))),Array.from(a,g=>b.setUint8(y++,g.charCodeAt(0))),Array.from(i,g=>b.setUint8(y++,g.charCodeAt(0))),Array.from(u,g=>b.setUint8(y++,g.charCodeAt(0)));var v=new Uint8Array(p.byteLength+h.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(h),p.byteLength),v.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,o,i,a,c]=n;return r({join_ref:s,ref:o,topic:i,event:a,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,s)}}_decodeUserBroadcast(e,r,n){const s=r.getUint8(1),o=r.getUint8(2),i=r.getUint8(3),a=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(e.slice(c,c+s));c=c+s;const d=n.decode(e.slice(c,c+o));c=c+o;const f=n.decode(e.slice(c,c+i));c=c+i;const h=e.slice(c,e.byteLength),w=a===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,p={type:this.BROADCAST_EVENT,event:d,payload:w};return i>0&&(p.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class Kg{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var fe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(fe||(fe={}));const Xd=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((o,i)=>(o[i]=Iw(i,t,e,s),o),{}):{}},Iw=(t,e,r,n)=>{const s=e.find(a=>a.name===t),o=s==null?void 0:s.type,i=r[t];return o&&!n.includes(o)?Jg(o,i):nc(i)},Jg=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return $w(e,r)}switch(t){case fe.bool:return Dw(e);case fe.float4:case fe.float8:case fe.int2:case fe.int4:case fe.int8:case fe.numeric:case fe.oid:return Lw(e);case fe.json:case fe.jsonb:return Uw(e);case fe.timestamp:return Mw(e);case fe.abstime:case fe.date:case fe.daterange:case fe.int4range:case fe.int8range:case fe.money:case fe.reltime:case fe.text:case fe.time:case fe.timestamptz:case fe.timetz:case fe.tsrange:case fe.tstzrange:return nc(e);default:return nc(e)}},nc=t=>t,Dw=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Lw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Uw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},$w=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let o;const i=t.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(a=>Jg(e,a))}return t},Mw=t=>typeof t=="string"?t.replace(" ","T"):t,Qg=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Fa{constructor(e,r,n={},s=tc){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zd;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Zd||(Zd={}));class Is{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Is.syncState(this.state,s,o,i),this.pendingDiffs.forEach(c=>{this.state=Is.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Is.syncDiff(this.state,s,o,i),a())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const o=this.cloneDeep(e),i=this.transformState(r),a={},c={};return this.map(o,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=o[u];if(f){const h=d.map(y=>y.presence_ref),w=f.map(y=>y.presence_ref),p=d.filter(y=>w.indexOf(y.presence_ref)<0),b=f.filter(y=>h.indexOf(y.presence_ref)<0);p.length>0&&(a[u]=p),b.length>0&&(c[u]=b)}else a[u]=d}),this.syncDiff(o,{joins:a,leaves:c},n,s)}static syncDiff(e,r,n,s){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(a,c)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(c),d.length>0){const f=e[a].map(w=>w.presence_ref),h=d.filter(w=>f.indexOf(w.presence_ref)<0);e[a].unshift(...h)}n(a,d,c)}),this.map(i,(a,c)=>{let u=e[a];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),e[a]=u,s(a,u,c),u.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var eh;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(eh||(eh={}));var Ds;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ds||(Ds={}));var Yt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Yt||(Yt={}));class gu{constructor(e,r={config:{}},n){var s,o;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Fa(this,Dt.join,this.params,this.timeout),this.rejoinTimer=new Kg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Dt.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new Is(this),this.broadcastEndpointURL=Qg(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:i,presence:a,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(w=>w.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Ds.PRESENCE]&&this.bindings[Ds.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(w=>e==null?void 0:e(Yt.CHANNEL_ERROR,w)),this._onClose(()=>e==null?void 0:e(Yt.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:w})=>{var p;if(this.socket.setAuth(),w===void 0){e==null||e(Yt.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,y=(p=b==null?void 0:b.length)!==null&&p!==void 0?p:0,v=[];for(let g=0;g<y;g++){const m=b[g],{filter:{event:_,schema:x,table:k,filter:E}}=m,j=w&&w[g];if(j&&j.event===_&&j.schema===x&&j.table===k&&j.filter===E)v.push(Object.assign(Object.assign({},m),{id:j.id}));else{this.unsubscribe(),this.state=Oe.errored,e==null||e(Yt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Yt.SUBSCRIBED);return}}).receive("error",w=>{this.state=Oe.errored,e==null||e(Yt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Yt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Oe.joined&&e===Ds.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var s;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let c=a.statusText;try{const u=await a.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,a,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Dt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Fa(this,Dt.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(o),i}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Fa(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Ow){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,o;const i=e.toLocaleLowerCase(),{close:a,error:c,leave:u,join:d}=Dt;if(n&&[a,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(w=>{var p,b,y;return((p=w.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(b=w.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(w=>w.callback(h,n)):(o=this.bindings[i])===null||o===void 0||o.filter(w=>{var p,b,y,v,g,m;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in w){const _=w.id,x=(p=w.filter)===null||p===void 0?void 0:p.event;return _&&((b=r.ids)===null||b===void 0?void 0:b.includes(_))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(g=(v=w==null?void 0:w.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return _==="*"||_===((m=r==null?void 0:r.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===i}).map(w=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:b,table:y,commit_timestamp:v,type:g,errors:m}=p;h=Object.assign(Object.assign({},{schema:b,table:y,commit_timestamp:v,eventType:g,new:{},old:{},errors:m}),this._getPayloadRecords(p))}w.callback(h,n)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),o={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&gu.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Dt.close,{},e)}_onError(e){this._on(Dt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Xd(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Xd(e.columns,e.old_record)),r}}const za=()=>{},zo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Bw=[1e3,2e3,5e3,1e4],Fw=1e4,zw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ww{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=tc,this.transport=null,this.heartbeatIntervalMs=zo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=za,this.ref=0,this.reconnectTimer=null,this.vsn=Yd,this.logger=za,this.conn=null,this.sendBuffer=[],this.serializer=new Aw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...o)=>s(...o):(...o)=>fetch(...o),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${rc.websocket}`,this.httpEndpoint=Qg(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Cw.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case qr.connecting:return Kr.Connecting;case qr.open:return Kr.Open;case qr.closing:return Kr.Closing;default:return Kr.Closed}}isConnected(){return this.connectionState()===Kr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new gu(`realtime:${e}`,r,this);return this.channels.push(o),o}}push(e){const{topic:r,event:n,payload:s,ref:o}=e,i=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${r} ${n} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Rw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},zo.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:i}=r,a=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${s} ${a}`.trim(),o),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===qr.open||this.conn.readyState===qr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Dt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([zw],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Pw};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Dt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Kg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},zo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,o,i,a,c,u,d,f,h,w;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:tc,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:zo.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:za,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:Yd,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:p=>Bw[p-1]||Fw,this.vsn){case qg:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,b)=>b(JSON.stringify(p)),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:(p,b)=>b(JSON.parse(p));break;case Tw:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class pu extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function we(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Vw extends pu{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sc extends pu{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const vu=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Gw=()=>Response,oc=t=>{if(Array.isArray(t))return t.map(r=>oc(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=oc(n)}),e},Hw=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Wa=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},qw=(t,e,r)=>q(void 0,void 0,void 0,function*(){const n=yield Gw();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const o=t.status||500,i=(s==null?void 0:s.statusCode)||o+"";e(new Vw(Wa(s),o,i))}).catch(s=>{e(new sc(Wa(s),s))}):e(new sc(Wa(t),t))}),Kw=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(Hw(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function uo(t,e,r,n,s,o){return q(this,void 0,void 0,function*(){return new Promise((i,a)=>{t(r,Kw(e,n,s,o)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>qw(c,a,n))})})}function ro(t,e,r,n){return q(this,void 0,void 0,function*(){return uo(t,"GET",e,r,n)})}function At(t,e,r,n,s){return q(this,void 0,void 0,function*(){return uo(t,"POST",e,n,s,r)})}function ic(t,e,r,n,s){return q(this,void 0,void 0,function*(){return uo(t,"PUT",e,n,s,r)})}function Jw(t,e,r,n){return q(this,void 0,void 0,function*(){return uo(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function yu(t,e,r,n,s){return q(this,void 0,void 0,function*(){return uo(t,"DELETE",e,n,s,r)})}class Qw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return q(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(we(e))return{data:null,error:e};throw e}})}}var Yg;class Yw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[Yg]="BlobDownloadBuilder",this.promise=null}asStream(){return new Qw(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return q(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(we(e))return{data:null,error:e};throw e}})}}Yg=Symbol.toStringTag;const Xw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},th={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zw{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=vu(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return q(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},th),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.has("cacheControl")||o.append("cacheControl",i.cacheControl),c&&!o.has("metadata")&&o.append("metadata",this.encodeMetadata(c))):(o=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!i.duplex&&(i.duplex="half")),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(e=="PUT"?ic:At)(this.fetch,`${this.url}/object/${d}`,o,Object.assign({headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(we(o))return{data:null,error:o};throw o}})}upload(e,r,n){return q(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return q(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:th.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield ic(this.fetch,a.toString(),c,{headers:d});return{data:{path:o,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(we(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return q(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const o=yield At(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+o.url),a=i.searchParams.get("token");if(!a)throw new pu("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(we(n))return{data:null,error:n};throw n}})}update(e,r,n){return q(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return q(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}copy(e,r,n){return q(this,void 0,void 0,function*(){try{return{data:{path:(yield At(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return q(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield At(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return q(this,void 0,void 0,function*(){try{const s=yield At(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}download(e,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=o?`?${o}`:"",a=this._getFinalPath(e),c=()=>ro(this.fetch,`${this.url}/${s}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new Yw(c,this.shouldThrowOnError)}info(e){return q(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield ro(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:oc(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(we(n))return{data:null,error:n};throw n}})}exists(e){return q(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Jw(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(we(n)&&n instanceof sc){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&s.push(o);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return q(this,void 0,void 0,function*(){try{return{data:yield yu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}list(e,r,n){return q(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Xw),r),{prefix:e||""});return{data:yield At(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}listV2(e,r){return q(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield At(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(we(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Xg="2.84.0",Zg={"X-Client-Info":`storage-js/${Xg}`};class e_{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const o=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Zg),r),this.fetch=vu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return q(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield ro(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}getBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}createBucket(e){return q(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield At(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(we(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return q(this,void 0,void 0,function*(){try{return{data:yield ic(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(we(n))return{data:null,error:n};throw n}})}emptyBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield yu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class t_{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Zg),r),this.fetch=vu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}listBuckets(e){return q(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield ro(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield yu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(we(r))return{data:null,error:r};throw r}})}}const wu={"X-Client-Info":`storage-js/${Xg}`,"Content-Type":"application/json"};class ep extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ft(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Va extends ep{constructor(e,r,n){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class r_ extends ep{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var rh;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(rh||(rh={}));const _u=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),n_=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},nh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),s_=(t,e,r)=>q(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,o=t;if(typeof o.json=="function")o.json().then(i=>{const a=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Va(nh(i),s,a))}).catch(()=>{const i=s+"",a=o.statusText||`HTTP ${s} error`;e(new Va(a,s,i))});else{const i=s+"",a=o.statusText||`HTTP ${s} error`;e(new Va(a,s,i))}}else e(new r_(nh(t),t))}),o_=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return n?(n_(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r)):s};function i_(t,e,r,n,s,o){return q(this,void 0,void 0,function*(){return new Promise((i,a)=>{t(r,o_(e,n,s,o)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>s_(c,a,n))})})}function mt(t,e,r,n,s){return q(this,void 0,void 0,function*(){return i_(t,"POST",e,n,s,r)})}class a_{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wu),r),this.fetch=_u(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return q(this,void 0,void 0,function*(){try{return{data:(yield mt(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}getIndex(e,r){return q(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}listIndexes(e){return q(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return q(this,void 0,void 0,function*(){try{return{data:(yield mt(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}}class l_{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wu),r),this.fetch=_u(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return q(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield mt(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}getVectors(e){return q(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}listVectors(e){return q(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield mt(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}queryVectors(e){return q(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}deleteVectors(e){return q(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield mt(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}}class c_{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wu),r),this.fetch=_u(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return q(this,void 0,void 0,function*(){try{return{data:(yield mt(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}getBucket(e){return q(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}listBuckets(){return q(this,arguments,void 0,function*(e={}){try{return{data:yield mt(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}deleteBucket(e){return q(this,void 0,void 0,function*(){try{return{data:(yield mt(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}}class u_ extends c_{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new d_(this.url,this.headers,e,this.fetch)}}class d_ extends a_{constructor(e,r,n,s){super(e,r,s),this.vectorBucketName=n}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return q(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return q(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return q(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return q(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new h_(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class h_ extends l_{constructor(e,r,n,s,o){super(e,r,o),this.vectorBucketName=n,this.indexName=s}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return q(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return q(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return q(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return q(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return q(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class f_ extends e_{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new Zw(this.url,this.headers,e,this.fetch)}get vectors(){return new u_(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new t_(this.url+"/iceberg",this.headers,this.fetch)}}const m_="2.84.0";let xs="";typeof Deno<"u"?xs="deno":typeof document<"u"?xs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xs="react-native":xs="node";const g_={"X-Client-Info":`supabase-js-${xs}/${m_}`},p_={headers:g_},v_={schema:"public"},y_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},w_={},__=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),b_=()=>Headers,S_=(t,e,r)=>{const n=__(r),s=b_();return async(o,i)=>{var a;const c=(a=await e())!==null&&a!==void 0?a:t;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(o,Object.assign(Object.assign({},i),{headers:u}))}};function x_(t){return t.endsWith("/")?t:t+"/"}function k_(t,e){var r,n;const{db:s,auth:o,realtime:i,global:a}=t,{db:c,auth:u,realtime:d,global:f}=e,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),o),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),a),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function E_(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(x_(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const tp="2.84.0",Sn=30*1e3,ac=3,Ga=ac*Sn,j_="http://localhost:9999",C_="supabase.auth.token",N_={"X-Client-Info":`gotrue-js/${tp}`},lc="X-Supabase-Api-Version",rp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,T_=10*60*1e3;class no extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function J(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class R_ extends no{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function O_(t){return J(t)&&t.name==="AuthApiError"}class Jr extends no{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class $r extends no{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class dt extends $r{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function A_(t){return J(t)&&t.name==="AuthSessionMissingError"}class mn extends $r{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wo extends $r{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vo extends $r{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function I_(t){return J(t)&&t.name==="AuthImplicitGrantRedirectError"}class sh extends $r{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cc extends $r{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ha(t){return J(t)&&t.name==="AuthRetryableFetchError"}class oh extends $r{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class uc extends $r{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ui="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ih=` 	
\r=`.split(""),D_=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ih.length;e+=1)t[ih[e].charCodeAt(0)]=-2;for(let e=0;e<Ui.length;e+=1)t[Ui[e].charCodeAt(0)]=e;return t})();function ah(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Ui[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Ui[n]),e.queuedBits-=6}}function np(t,e,r){const n=D_[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function lh(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{$_(i,n,r)};for(let i=0;i<t.length;i+=1)np(t.charCodeAt(i),s,o);return e.join("")}function L_(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function U_(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}L_(n,e)}}function $_(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function zn(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)np(t.charCodeAt(s),r,n);return new Uint8Array(e)}function M_(t){const e=[];return U_(t,r=>e.push(r)),new Uint8Array(e)}function Zr(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>ah(s,r,n)),ah(null,r,n),e.join("")}function B_(t){return Math.round(Date.now()/1e3)+t}function F_(){return Symbol("auth-callback")}const ze=()=>typeof window<"u"&&typeof document<"u",Fr={tested:!1,writable:!1},sp=()=>{if(!ze())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fr.tested)return Fr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Fr.tested=!0,Fr.writable=!0}catch{Fr.tested=!0,Fr.writable=!1}return Fr.writable};function z_(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const op=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),W_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",xn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},zr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},dr=async(t,e)=>{await t.removeItem(e)};class ca{constructor(){this.promise=new ca.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}ca.promiseConstructor=Promise;function qa(t){const e=t.split(".");if(e.length!==3)throw new uc("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!P_.test(e[n]))throw new uc("JWT not in base64url format");return{header:JSON.parse(lh(e[0])),payload:JSON.parse(lh(e[1])),signature:zn(e[2]),raw:{header:e[0],payload:e[1]}}}async function V_(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function G_(t,e){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){n(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function H_(t){return("0"+t.toString(16)).substr(-2)}function q_(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let o=0;o<56;o++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,H_).join("")}async function K_(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function J_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await K_(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gn(t,e,r=!1){const n=q_();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await xn(t,`${e}-code-verifier`,s);const o=await J_(n);return[o,n===o?"plain":"s256"]}const Q_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Y_(t){const e=t.headers.get(lc);if(!e||!e.match(Q_))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function X_(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Z_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const eb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function pn(t){if(!eb.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ka(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tb(t,e){return new Proxy(t,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,s)}})}function ch(t){return JSON.parse(JSON.stringify(t))}const Hr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),rb=[502,503,504];async function uh(t){var e;if(!W_(t))throw new cc(Hr(t),0);if(rb.includes(t.status))throw new cc(Hr(t),t.status);let r;try{r=await t.json()}catch(o){throw new Jr(Hr(o),o)}let n;const s=Y_(t);if(s&&s.getTime()>=rp["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new oh(Hr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new dt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new oh(Hr(r),t.status,r.weak_password.reasons);throw new R_(Hr(r),t.status||500,n)}const nb=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function ee(t,e,r,n){var s;const o=Object.assign({},n==null?void 0:n.headers);o[lc]||(o[lc]=rp["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await sb(t,e,r+a,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function sb(t,e,r,n,s,o){const i=nb(e,n,s,o);let a;try{a=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new cc(Hr(c),0)}if(a.ok||await uh(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(c){await uh(c)}}function Rt(t){var e;let r=null;ab(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=B_(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function dh(t){const e=Rt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function yr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function ob(t){return{data:t,error:null}}function ib(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o}=t,i=os(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o},c=Object.assign({},i);return{data:{properties:a,user:c},error:null}}function hh(t){return t}function ab(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ja=["global","local","others"];class lb{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=op(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Ja[0]){if(Ja.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ja.join(", ")}`);try{return await ee(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:yr})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=os(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ib,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(J(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ee(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yr})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,o,i,a,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:hh});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,w=(c=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return w.length>0&&(w.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=b}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(J(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){pn(e);try{return await ee(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yr})}catch(r){if(J(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){pn(e);try{return await ee(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:yr})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){pn(e);try{return await ee(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:yr})}catch(n){if(J(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){pn(e.userId);try{const{data:r,error:n}=await ee(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(J(r))return{data:null,error:r};throw r}}async _deleteFactor(e){pn(e.userId),pn(e.id);try{return{data:await ee(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,s,o,i,a,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ee(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:hh});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,w=(c=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return w.length>0&&(w.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=b}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(J(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ee(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await ee(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(J(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await ee(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(J(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await ee(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(J(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await ee(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(J(r))return{data:null,error:r};throw r}}}function fh(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const vn={debug:!!(globalThis&&sp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ip extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class cb extends ip{}async function ub(t,e,r){vn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),vn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){vn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{vn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw vn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new cb(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(vn.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function db(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ap(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function hb(t){return parseInt(t,16)}function fb(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function mb(t){var e;const{chainId:r,domain:n,expirationTime:s,issuedAt:o=new Date,nonce:i,notBefore:a,requestId:c,resources:u,scheme:d,uri:f,version:h}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const w=ap(t.address),p=d?`${d}://${n}`:n,b=t.statement?`${t.statement}
`:"",y=`${p} wants you to sign in with your Ethereum account:
${w}

${b}`;let v=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(s&&(v+=`
Expiration Time: ${s.toISOString()}`),a&&(v+=`
Not Before: ${a.toISOString()}`),c&&(v+=`
Request ID: ${c}`),u){let g=`
Resources:`;for(const m of u){if(!m||typeof m!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${m}`);g+=`
- ${m}`}v+=g}return`${y}
${v}`}class Pe extends Error{constructor({message:e,code:r,cause:n,name:s}){var o;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=s??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class $i extends Pe{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function gb({error:t,options:e}){var r,n,s;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Pe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Pe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Pe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Pe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Pe({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new Pe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Pe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(lp(i)){if(o.rp.id!==i)return new Pe({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Pe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Pe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function pb({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Pe({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(lp(n)){if(r.rpId!==n)return new Pe({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Pe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class vb{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const yb=new vb;function wb(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,s=os(t,["challenge","user","excludeCredentials"]),o=zn(e).buffer,i=Object.assign(Object.assign({},r),{id:zn(r.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:o,user:i});if(n&&n.length>0){a.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];a.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:zn(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function _b(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=os(t,["challenge","allowCredentials"]),s=zn(e).buffer,o=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const a=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},a),{id:zn(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return o}function bb(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Zr(new Uint8Array(t.response.attestationObject)),clientDataJSON:Zr(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Sb(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Zr(new Uint8Array(s.authenticatorData)),clientDataJSON:Zr(new Uint8Array(s.clientDataJSON)),signature:Zr(new Uint8Array(s.signature)),userHandle:s.userHandle?Zr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function lp(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function mh(){var t,e;return!!(ze()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function xb(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $i("Browser returned unexpected credential type",e)}:{data:null,error:new $i("Empty credential response",e)}}catch(e){return{data:null,error:gb({error:e,options:t})}}}async function kb(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $i("Browser returned unexpected credential type",e)}:{data:null,error:new $i("Empty credential response",e)}}catch(e){return{data:null,error:pb({error:e,options:t})}}}const Eb={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jb={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Mi(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of t)if(s)for(const o in s){const i=s[o];if(i!==void 0)if(Array.isArray(i))n[o]=i;else if(r(i))n[o]=i;else if(e(i)){const a=n[o];e(a)?n[o]=Mi(a,i):n[o]=Mi(i)}else n[o]=i}return n}function Cb(t,e){return Mi(Eb,t,e||{})}function Nb(t,e){return Mi(jb,t,e||{})}class Pb{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:s},o){try{const{data:i,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:a};const c=s??yb.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=Cb(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:d,error:f}=await xb({publicKey:u,signal:c});return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=Nb(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:d,error:f}=await kb(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return J(i)?{data:null,error:i}:{data:null,error:new Jr("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!r)return{data:null,error:new no("rpId is required for WebAuthn authentication")};try{if(!mh())return{data:null,error:new Jr("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:o});if(!i)return{data:null,error:a};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return J(i)?{data:null,error:i}:{data:null,error:new Jr("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!r)return{data:null,error:new no("rpId is required for WebAuthn registration")};try{if(!mh())return{data:null,error:new Jr("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:a};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return J(i)?{data:null,error:i}:{data:null,error:new Jr("Unexpected error in register",i)}}}}db();const Tb={url:j_,storageKey:C_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:N_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gh(t,e,r){return await r()}const yn={};class so{get jwks(){var e,r;return(r=(e=yn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){yn[this.storageKey]=Object.assign(Object.assign({},yn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=yn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){yn[this.storageKey]=Object.assign(Object.assign({},yn[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},Tb),e);if(this.storageKey=o.storageKey,this.instanceID=(r=so.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,so.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&ze()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new lb({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=op(o.fetch),this.lock=o.lock||gh,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:ze()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ub:this.lock=gh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Pb(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:sp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fh(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=fh(this.memoryStorage)),ze()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${tp}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(ze()&&(r=z_(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ze()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),I_(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return J(r)?this._returnResult({error:r}):this._returnResult({error:new Jr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const o=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Rt}),{data:i,error:a}=o;if(a||!i)return this._returnResult({data:{user:null,session:null},error:a});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(o){if(J(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var r,n,s;try{let o;if("email"in e){const{email:d,password:f,options:h}=e;let w=null,p=null;this.flowType==="pkce"&&([w,p]=await gn(this.storage,this.storageKey)),o=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:w,code_challenge_method:p},xform:Rt})}else if("phone"in e){const{phone:d,password:f,options:h}=e;o=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Rt})}else throw new Wo("You must provide either an email or phone number and a password");const{data:i,error:a}=o;if(a||!i)return this._returnResult({data:{user:null,session:null},error:a});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(o){if(J(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let r;if("email"in e){const{email:o,password:i,options:a}=e;r=await ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:dh})}else if("phone"in e){const{phone:o,password:i,options:a}=e;r=await ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:dh})}else throw new Wo("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const o=new mn;return this._returnResult({data:{user:null,session:null},error:o})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(J(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,s,o,i,a,c,u,d,f,h;let w,p;if("message"in e)w=e.message,p=e.signature;else{const{chain:b,wallet:y,statement:v,options:g}=e;let m;if(ze())if(typeof y=="object")m=y;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")m=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=y}const _=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),x=await m.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!x||x.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=ap(x[0]);let E=(n=g==null?void 0:g.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const N=await m.request({method:"eth_chainId"});E=hb(N)}const j={domain:_.host,address:k,statement:v,uri:_.href,version:"1",chainId:E,nonce:(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(o=g==null?void 0:g.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(a=g==null?void 0:g.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=g==null?void 0:g.signInWithEthereum)===null||d===void 0?void 0:d.resources};w=mb(j),p=await m.request({method:"personal_sign",params:[fb(w),k]})}try{const{data:b,error:y}=await ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:p},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Rt});if(y)throw y;if(!b||!b.session||!b.user){const v=new mn;return this._returnResult({data:{user:null,session:null},error:v})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:y})}catch(b){if(J(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(e){var r,n,s,o,i,a,c,u,d,f,h,w;let p,b;if("message"in e)p=e.message,b=e.signature;else{const{chain:y,wallet:v,statement:g,options:m}=e;let _;if(ze())if(typeof v=="object")_=v;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))_=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=v}const x=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const k=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),g?{statement:g}:null));let E;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")E=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)E=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)p=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),b=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${x.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(s=(n=m==null?void 0:m.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((a=m==null?void 0:m.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((f=(d=m==null?void 0:m.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...m.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const k=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=k}}try{const{data:y,error:v}=await ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Zr(b)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Rt});if(v)throw v;if(!y||!y.session||!y.user){const g=new mn;return this._returnResult({data:{user:null,session:null},error:g})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:v})}catch(y){if(J(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const r=await zr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:o,error:i}=await ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Rt});if(await dr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!o||!o.session||!o.user){const a=new mn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(J(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:o,nonce:i}=e,a=await ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Rt}),{data:c,error:u}=a;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new mn;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(J(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,s,o,i;try{if("email"in e){const{email:a,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await gn(this.storage,this.storageKey));const{error:f}=await ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in e){const{phone:a,options:c}=e,{data:u,error:d}=await ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Wo("You must provide either an email or phone number.")}catch(a){if(J(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var r,n;try{let s,o;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:a}=await ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Rt});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(J(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var r,n,s,o,i;try{let a=null,c=null;this.flowType==="pkce"&&([a,c]=await gn(this.storage,this.storageKey));const u=await ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:c}),headers:this.headers,xform:ob});return!((o=u.data)===null||o===void 0)&&o.url&&ze()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(a){if(J(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new dt;const{error:s}=await ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(J(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:o}=e,{error:i}=await ee(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:n,type:s,options:o}=e,{data:i,error:a}=await ee(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a})}throw new Wo("You must provide either an email or phone number and a type")}catch(r){if(J(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await zr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ga:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const i=await zr(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Ka()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=tb(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yr}):await this._useSession(async r=>{var n,s,o;const{data:i,error:a}=r;if(a)throw a;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dt}:await ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:yr})})}catch(r){if(J(r))return A_(r)&&(await this._removeSession(),await dr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new dt;const i=s.session;let a=null,c=null;this.flowType==="pkce"&&e.email!=null&&([a,c]=await gn(this.storage,this.storageKey));const{data:u,error:d}=await ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:i.access_token,xform:yr});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(J(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new dt;const r=Date.now()/1e3;let n=r,s=!0,o=null;const{payload:i}=qa(e.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{data:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(J(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:i,error:a}=r;if(a)throw a;e=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new dt;const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(J(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!ze())throw new Vo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sh("No code detected.");const{data:g,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:a,expires_at:c,token_type:u}=e;if(!o||!a||!i||!u)throw new Vo("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(a);let h=d+f;c&&(h=parseInt(c));const w=h-d;w*1e3<=Sn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${f}s`);const p=h-f;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:b,error:y}=await this._getUser(o);if(y)throw y;const v={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:e.type},error:null})}catch(n){if(J(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await zr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return this._returnResult({error:o});const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(O_(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await dr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=F_(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:o},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await gn(this.storage,this.storageKey,!0));try{return await ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(J(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:s}=await this._useSession(async o=>{var i,a,c,u,d;const{data:f,error:h}=o;if(h)throw h;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ee(this.fetch,"GET",w,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return ze()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(J(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:o}}=r;if(s)throw s;const{options:i,provider:a,token:c,access_token:u,nonce:d}=e,f=await ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o==null?void 0:o.access_token)!==null&&n!==void 0?n:void 0,body:{provider:a,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Rt}),{data:h,error:w}=f;return w?this._returnResult({data:{user:null,session:null},error:w}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new mn}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:w}))}catch(s){if(J(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)throw i;return await ee(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await G_(async s=>(s>0&&await V_(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Rt})),(s,o)=>{const i=200*Math.pow(2,s);return o&&Ha(o)&&Date.now()+i-n<Sn})}catch(n){if(this._debug(r,"error",n),J(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),ze()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await zr(this.storage,this.storageKey);if(s&&this.userStorage){let i=await zr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await xn(this.userStorage,this.storageKey+"-user",i)),s.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Ka()}else if(s&&!s.user&&!s.user){const i=await zr(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await dr(this.storage,this.storageKey+"-user"),await xn(this.storage,this.storageKey,s)):s.user=Ka()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ga;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${Ga}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Ha(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:a}=await this._getUser(s.access_token);!a&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new dt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ca;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new dt;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={data:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),J(o)){const i={data:null,error:o};return Ha(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await xn(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const o=ch(s);await xn(this.storage,this.storageKey,o)}else{const s=ch(r);await xn(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await dr(this.storage,this.storageKey),await dr(this.storage,this.storageKey+"-code-verifier"),await dr(this.storage,this.storageKey+"-user"),this.userStorage&&await dr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ze()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Sn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Sn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Sn}ms, refresh threshold is ${ac} ticks`),s<=ac&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ip)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ze()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,i]=await gn(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;return o?this._returnResult({data:null,error:o}):await ee(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await ee(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?bb(e.webauthn.credential_response):Sb(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:c}=await ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:c}))})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=await ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:a}=i;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:wb(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:_b(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=qa(n.access_token);let i=null;o.aal&&(i=o.aal);let a=i;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const u=o.amr||[];return{data:{currentLevel:i,nextLevel:a,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await ee(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new dt})})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new dt});const i=await ee(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&ze()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(J(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new dt});const i=await ee(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&ze()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(J(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;return n?this._returnResult({data:null,error:n}):r?await ee(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new dt})})}catch(e){if(J(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await ee(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new dt})})}catch(r){if(J(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+T_>s)return n;const{data:o,error:i}=await ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:w,error:p}=await this.getSession();if(p||!w.session)return this._returnResult({data:null,error:p});n=w.session.access_token}const{header:s,payload:o,signature:i,raw:{header:a,payload:c}}=qa(n);r!=null&&r.allowExpired||X_(o.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:w}=await this.getUser(n);if(w)throw w;return{data:{claims:o,header:s,signature:i},error:null}}const d=Z_(s.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,M_(`${a}.${c}`)))throw new uc("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(n){if(J(n))return this._returnResult({data:null,error:n});throw n}}}so.nextInstanceID={};const Rb=so;class Ob extends Rb{constructor(e){super(e)}}class Ab{constructor(e,r,n){var s,o,i;this.supabaseUrl=e,this.supabaseKey=r;const a=E_(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const c=`sb-${a.hostname.split(".")[0]}-auth-token`,u={db:v_,realtime:w_,auth:Object.assign(Object.assign({},y_),{storageKey:c}),global:p_},d=k_(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=d.global.headers)!==null&&o!==void 0?o:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=S_(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new jw(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new f_(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new xw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:i,flowType:a,lock:c,debug:u,throwOnError:d},f,h){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ob({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),f),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,flowType:a,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ww(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ib=(t,e,r)=>new Ab(t,e,r);function Db(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Db()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const C={log:(...t)=>{console.log("[MAEUMSSI]",...t)},err:(...t)=>{console.error("[MAEUMSSI][ERR]",...t)},warn:(...t)=>{console.warn("[MAEUMSSI][WARN]",...t)}};typeof window<"u"&&(window.__maeumssi_diag=C);const Lb={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxibXRjY2ZuY25xZHNycnRzc3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3OTcwMzQsImV4cCI6MjA3OTM3MzAzNH0.eUhOIwcCxFoqFysWMLpOhReXaVnyKfOVifiug_NTTSY",VITE_SUPABASE_URL:"https://lbmtccfncnqdsrrtsspt.supabase.co"};C.log("supabaseClient: ENV  ");const Ub="https://lbmtccfncnqdsrrtsspt.supabase.co",$b="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxibXRjY2ZuY25xZHNycnRzc3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3OTcwMzQsImV4cCI6MjA3OTM3MzAzNH0.eUhOIwcCxFoqFysWMLpOhReXaVnyKfOVifiug_NTTSY",cp=Ub,ph=$b;function dc(){const t="https://lbmtccfncnqdsrrtsspt.supabase.co",e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxibXRjY2ZuY25xZHNycnRzc3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3OTcwMzQsImV4cCI6MjA3OTM3MzAzNH0.eUhOIwcCxFoqFysWMLpOhReXaVnyKfOVifiug_NTTSY",r=Object.keys(Lb).filter(s=>s.startsWith("VITE_"));C.log("hasValidSupabaseConfig: ENV  ",{allViteKeys:r,hasUrl:!0,hasKey:!0,urlValue:t.substring(0,30)+"...",keyValue:e.substring(0,20)+"..."}),console.log("[ENV Debug]  VITE_  :",r),console.log("[ENV Debug] VITE_SUPABASE_URL:",t),console.log("[ENV Debug] VITE_SUPABASE_ANON_KEY:",e.substring(0,20)+"...");const n=!t.includes("placeholder")&&!e.includes("placeholder");return C.log("hasValidSupabaseConfig:  ",{hasUrl:!0,hasKey:!0,urlIncludesPlaceholder:t==null?void 0:t.includes("placeholder"),keyIncludesPlaceholder:e==null?void 0:e.includes("placeholder"),isValid:n}),n||console.error("[ENV Debug]    :",{url:t,key:"",message:"  .env   VITE_SUPABASE_URL VITE_SUPABASE_ANON_KEY ."}),n}C.log("supabaseClient:  ",{hasRealUrl:!0,hasRealKey:!0,url:cp.substring(0,30)+"..."});const z=Ib(cp,ph,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{apikey:ph}}});C.log("supabaseClient:  ");const vh=Object.freeze(Object.defineProperty({__proto__:null,hasValidSupabaseConfig:dc,supabase:z},Symbol.toStringTag,{value:"Module"}));class Mb{constructor(){Me(this,"listeners",new Set);Me(this,"toastQueue",[]);Me(this,"bannerQueue",[]);Me(this,"modalQueue",[]);Me(this,"currentToast",null);Me(this,"currentBanner",null);Me(this,"currentModal",null);Me(this,"debounceMap",new Map);Me(this,"DEBOUNCE_DURATION",2e3)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}generateId(){return`notify-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}shouldDebounce(e){const r=Date.now(),n=this.debounceMap.get(e);return n&&r-n<this.DEBOUNCE_DURATION?!0:(this.debounceMap.set(e,r),!1)}toast(e){const{type:r,icon:n,message:s,action:o,duration:i,debounceKey:a}=e;if(a&&this.shouldDebounce(a))return;const c={id:this.generateId(),type:r,icon:n,message:s,action:o,duration:i||(r==="error"?5e3:3e3)};this.currentToast?this.toastQueue.push(c):(this.currentToast=c,this.emit({type:"toast",data:c}))}banner(e){const{level:r,message:n,dismissible:s=!0}=e,o={id:this.generateId(),level:r,message:n,dismissible:s};this.currentBanner&&this.dismissBanner(this.currentBanner.id),this.currentBanner=o,this.emit({type:"banner",data:o})}modal(e){const{title:r,message:n,confirmLabel:s,cancelLabel:o,onConfirm:i,onCancel:a}=e,c={id:this.generateId(),title:r,message:n,confirmLabel:s||"",cancelLabel:o||"",onConfirm:i,onCancel:a};this.currentModal?this.modalQueue.push(c):(this.currentModal=c,this.emit({type:"modal",data:c}))}dismissToast(e){var r;if(((r=this.currentToast)==null?void 0:r.id)===e&&(this.currentToast=null,this.emit({type:"toast",data:{id:e,type:"success",message:""}}),this.toastQueue.length>0)){const n=this.toastQueue.shift();this.currentToast=n,this.emit({type:"toast",data:n})}}dismissBanner(e){var r;((r=this.currentBanner)==null?void 0:r.id)===e&&(this.currentBanner=null,this.emit({type:"banner",data:{id:e,level:"info",message:"",dismissible:!0}}))}closeModal(e,r=!1){var n;if(((n=this.currentModal)==null?void 0:n.id)===e){const s=this.currentModal;if(this.currentModal=null,this.emit({type:"modal",data:{id:e,title:"",message:""}}),r&&s.onConfirm?s.onConfirm():!r&&s.onCancel&&s.onCancel(),this.modalQueue.length>0){const o=this.modalQueue.shift();this.currentModal=o,this.emit({type:"modal",data:o})}}}success(e,r,n){this.toast({type:"success",message:e,icon:r||"",action:n})}info(e,r,n){this.toast({type:"info",message:e,icon:r||"",action:n})}warning(e,r,n){this.toast({type:"warning",message:e,icon:r||"",action:n})}error(e,r,n){this.toast({type:"error",message:e,icon:r||"",action:n})}}const Ie=new Mb,Zn={};function Bb(t){try{return typeof localStorage>"u"?Zn[t]||null:localStorage.getItem(t)}catch{return Zn[t]||null}}function Fb(t,e){try{if(typeof localStorage>"u"){Zn[t]=e;return}localStorage.setItem(t,e)}catch{Zn[t]=e}}function zb(t){try{if(typeof localStorage>"u"){delete Zn[t];return}localStorage.removeItem(t)}catch{delete Zn[t]}}function Wb(){try{if(typeof localStorage>"u")return{available:!1,type:"memory"};const t="__maeumssi_storage_test__";return localStorage.setItem(t,"test"),localStorage.removeItem(t),{available:!0,type:"localStorage"}}catch{return{available:!1,type:"memory"}}}const te={getItem:Bb,setItem:Fb,removeItem:zb,test:Wb},up=S.createContext(void 0),Jt="onboardingComplete",wn="isGuest",vs=()=>{typeof window.__removeLoadingBanner=="function"&&window.__removeLoadingBanner()};function Vb({children:t}){const e=Ft(),[r,n]=S.useState(null),[s,o]=S.useState(null),[i,a]=S.useState(null),[c,u]=S.useState(!0),[d,f]=S.useState(!1),[h,w]=S.useState(()=>te.getItem(wn)==="true"),p=async(x,k)=>{var j,N;const E=e.pathname.startsWith("/onboarding");console.log("[AuthProvider] fetchUserProfile ",{userId:x,skipOnboarding:k,isOnboardingRoute:E,pathname:e.pathname}),C.log("AuthProvider: fetchUserProfile ",{userId:x,skipOnboarding:k,isOnboardingRoute:E});try{const P=E?3e3:1e4,M=new Promise((V,re)=>{setTimeout(()=>re(new Error(`fetchUserProfile  (${P}ms)`)),P)}),X=z.from("users").select("onboarding_completed, is_deleted").eq("id",x).single(),{data:R,error:A}=await Promise.race([X,M]);if(A)return console.error("[AuthProvider] fetchUserProfile :",{code:A.code,message:A.message,details:A.details,hint:A.hint,userId:x}),A.code==="PGRST116"?(console.log("[AuthProvider] users  row  ( )"),C.log("AuthProvider: users  row  ( )"),null):((A.code==="42501"||(j=A.message)!=null&&j.includes("permission denied")||(N=A.message)!=null&&N.includes("RLS"))&&(console.error("[AuthProvider] RLS   - users    :",A),C.err("AuthProvider: RLS   - users    :",A)),C.err("AuthProvider: userProfile  :",A),null);if(!R)return console.warn("[AuthProvider] fetchUserProfile: data null"),C.log("AuthProvider: fetchUserProfile data null"),null;const I={onboarding_completed:R.onboarding_completed??!1,is_deleted:R.is_deleted??!1};return console.log("[AuthProvider] fetchUserProfile :",I),C.log("AuthProvider: fetchUserProfile ",I),I}catch(P){return console.error("[AuthProvider] fetchUserProfile :",{error:P,userId:x,errorMessage:P instanceof Error?P.message:String(P)}),C.err("AuthProvider: userProfile   :",P),null}},b=async()=>{if(r!=null&&r.id){console.log("[AuthProvider] refreshUserProfile ",{userId:r.id,pathname:e.pathname});const x=await p(r.id,!1);console.log("[AuthProvider] refreshUserProfile ",{profile:x,onboarding_completed:x==null?void 0:x.onboarding_completed}),a(x),x?x.onboarding_completed===!0?(te.setItem(Jt,"true"),console.log("[AuthProvider]   onboarding_completed : true")):(te.removeItem(Jt),console.log("[AuthProvider]   onboarding_completed : false ()")):te.getItem(Jt)==="true"&&console.log("[AuthProvider] refreshUserProfile: profile null   onboarding_completed=true ")}};S.useEffect(()=>{console.log("[AuthProvider] useEffect "),C.log("AuthProvider: useEffect "),console.log("[AuthProvider] ENV ",{hasUrl:!0,hasKey:!0,url:"https://lbmtccfncnqdsrrtsspt.supabase.co".substring(0,30)+"..."}),C.log("AuthProvider: ENV  ");const k=te.test();C.log("AuthProvider: Storage :",k);const E=setTimeout(()=>{console.error("[AuthProvider] 10  -  loading "),f(!0),u(!1),vs(),a(null)},1e4);console.log("[AuthProvider] init start",{pathname:e.pathname}),C.log("AuthProvider: getSession  ",{loading:!0}),z.auth.getSession().then(async({data:{session:N},error:P})=>{var X,R,A;clearTimeout(E),console.log("[AuthProvider] getSession ",{hasSession:!!N,userId:(X=N==null?void 0:N.user)==null?void 0:X.id,error:P,pathname:e.pathname}),C.log("AuthProvider: getSession ",{hasSession:!!N,userId:(R=N==null?void 0:N.user)==null?void 0:R.id}),P&&(console.error("[AuthProvider] getSession :",P),C.err("AuthProvider: getSession :",P)),o(N),n((N==null?void 0:N.user)??null);const M=e.pathname.startsWith("/onboarding");if((A=N==null?void 0:N.user)!=null&&A.id)if(M)console.log("[AuthProvider]   , getUser skip",{pathname:e.pathname}),a(null);else{console.log("[AuthProvider] getUser  (  )",{userId:N.user.id,pathname:e.pathname});try{const I=await p(N.user.id,!1);console.log("[AuthProvider] getUser ",{profile:I}),a(I),I?I.onboarding_completed?(te.setItem(Jt,"true"),console.log("[AuthProvider]   onboarding_completed : true")):(te.removeItem(Jt),console.log("[AuthProvider]   onboarding_completed : false ()")):te.getItem(Jt)==="true"&&console.log("[AuthProvider] profile null   onboarding_completed=true ")}catch(I){console.error("[AuthProvider] getUser :",I),a(null)}}else a(null);console.log("[AuthProvider] setLoading(false)  - getSession "),f(!0),u(!1),vs(),C.log("AuthProvider:  ",{sessionInitialized:!0,loading:!1})}).catch(N=>{clearTimeout(E),console.error("[AuthProvider] getSession catch:",N),C.err("AuthProvider: getSession :",N),console.log("[AuthProvider] setLoading(false)  - getSession catch "),f(!0),u(!1),vs(),a(null)}),console.log("[AuthProvider] onAuthStateChange   "),C.log("AuthProvider: onAuthStateChange   ");const{data:{subscription:j}}=z.auth.onAuthStateChange(async(N,P)=>{var M,X,R;console.log("[AuthProvider] onAuthStateChange ",{event:N,hasSession:!!P,userId:(M=P==null?void 0:P.user)==null?void 0:M.id}),C.log("AuthProvider: onAuthStateChange ",{event:N,hasSession:!!P,userId:(X=P==null?void 0:P.user)==null?void 0:X.id});try{o(P),n((P==null?void 0:P.user)??null);const A=e.pathname.startsWith("/onboarding");if((R=P==null?void 0:P.user)!=null&&R.id&&!A){console.log("[AuthProvider] onAuthStateChange: getUser ",{userId:P.user.id});try{const I=await p(P.user.id,!1);console.log("[AuthProvider] onAuthStateChange: getUser ",{profile:I}),a(I),I&&(I.onboarding_completed?(te.setItem(Jt,"true"),console.log("[AuthProvider] onAuthStateChange:   onboarding_completed : true")):(te.removeItem(Jt),console.log("[AuthProvider] onAuthStateChange:   onboarding_completed : false ()")))}catch(I){console.error("[AuthProvider] onAuthStateChange: getUser :",I),a(null)}}else A&&console.log("[AuthProvider] onAuthStateChange:   , getUser skip"),a(null);N==="SIGNED_IN"&&(P!=null&&P.user)?(console.log("[AuthProvider] SIGNED_IN ",{userId:P.user.id}),C.log("AuthProvider: SIGNED_IN",{userId:P.user.id}),te.removeItem(wn),w(!1),Ie.success("! ,   ")):N==="SIGNED_OUT"&&(console.log("[AuthProvider] SIGNED_OUT "),C.log("AuthProvider: SIGNED_OUT"),w(!1),te.removeItem(wn),a(null)),console.log("[AuthProvider] setLoading(false)  - onAuthStateChange "),f(!0),u(!1),vs(),C.log("AuthProvider: onAuthStateChange ",{event:N,loading:!1})}catch(A){console.error("[AuthProvider] onAuthStateChange :",A),C.err("AuthProvider: onAuthStateChange :",A),console.log("[AuthProvider] setLoading(false)  - onAuthStateChange catch "),f(!0),u(!1),vs(),a(null)}});return console.log("[AuthProvider] onAuthStateChange   "),C.log("AuthProvider: onAuthStateChange   "),()=>{j.unsubscribe()}},[]);const y=async()=>{try{const{error:x}=await z.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(x)throw x}catch(x){console.error("Google  :",x),Ie.error(" .    .","")}},v=async()=>{try{const{error:x}=await z.auth.signInWithOAuth({provider:"apple",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(x)throw x}catch(x){console.error("Apple  :",x),Ie.error(" .    .","")}},g=async()=>{Ie.info("   .  !","")},m=async()=>{try{C.log("AuthProvider: signOut ");const{error:x}=await z.auth.signOut();if(x)throw x;te.removeItem(wn),w(!1),n(null),o(null),C.log("AuthProvider:  "),Ie.info(".","")}catch(x){const k=x;C.err("AuthProvider:  ",k),console.error(" :",k),Ie.error(" .    .","")}},_=x=>{C.log("AuthProvider: setGuestMode",{guest:x}),x?(te.setItem(wn,"true"),te.setItem(Jt,"true"),C.log("AuthProvider:     ")):te.removeItem(wn),w(x)};return l.jsx(up.Provider,{value:{user:r,session:s,userProfile:i,loading:c,sessionInitialized:d,isGuest:h,signInWithGoogle:y,signInWithApple:v,signInWithKakao:g,signOut:m,setGuestMode:_,refreshUserProfile:b},children:t})}function Ye(){const t=S.useContext(up);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function Gb({notification:t,onDismiss:e}){const[r,n]=S.useState(!1);S.useEffect(()=>{const i=setTimeout(()=>n(!0),10),a=setTimeout(()=>{n(!1),setTimeout(()=>e(t.id),300)},t.duration);return()=>{clearTimeout(i),clearTimeout(a)}},[t.id,t.duration,e]);const o={success:{bg:"var(--mint-500, #39C6A5)",text:"#fff"},info:{bg:"var(--mint-600, #24B89D)",text:"#fff"},warning:{bg:"#F59E0B",text:"#fff"},error:{bg:"#EF4444",text:"#fff"}}[t.type];return l.jsxs("div",{role:"status","aria-live":"polite","aria-atomic":"true",className:`notify-toast ${r?"show":""} ${t.type}`,style:{position:"fixed",bottom:"calc(16px + var(--tabbar-height, 72px))",left:"50%",transform:"translateX(-50%)",zIndex:1e3,maxWidth:"calc(100vw - 32px)",width:"max-content",minWidth:280,background:o.bg,color:o.text,padding:"12px 16px",borderRadius:18,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:10,fontSize:14,fontWeight:500,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:r?1:0,...r?{transform:"translateX(-50%) translateY(0)"}:{transform:"translateX(-50%) translateY(20px)"}},children:[t.icon&&l.jsx("span",{style:{fontSize:18,lineHeight:1},"aria-hidden":"true",children:t.icon}),l.jsx("span",{style:{flex:1},children:t.message}),t.action&&l.jsx("button",{type:"button",onClick:t.action.onClick,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"inherit",padding:"4px 12px",borderRadius:12,fontSize:13,fontWeight:600,cursor:"pointer",transition:"background 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="rgba(255,255,255,0.3)"},onMouseLeave:i=>{i.currentTarget.style.background="rgba(255,255,255,0.2)"},children:t.action.label})]})}function Hb({notification:t,onDismiss:e}){const[r,n]=S.useState(!1);S.useEffect(()=>{const i=setTimeout(()=>n(!0),10);return()=>clearTimeout(i)},[]);const o={info:{bg:"linear-gradient(180deg, #F0FFFA, #E5FAF4)",border:"1px solid #CDEAE1",text:"#144E43",icon:""},warn:{bg:"linear-gradient(180deg, #FFFBEB, #FEF3C7)",border:"1px solid #FCD34D",text:"#92400E",icon:""},critical:{bg:"linear-gradient(180deg, #FEE2E2, #FECACA)",border:"1px solid #F87171",text:"#991B1B",icon:""}}[t.level];return l.jsxs("div",{role:"region","aria-label":"",className:`notify-banner ${r?"show":""} ${t.level}`,style:{position:"fixed",top:0,left:0,right:0,zIndex:999,background:o.bg,borderBottom:o.border,color:o.text,padding:"12px 16px",display:"flex",alignItems:"center",gap:10,fontSize:13,fontWeight:500,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:r?1:0,transform:r?"translateY(0)":"translateY(-100%)"},children:[l.jsx("span",{style:{fontSize:16,lineHeight:1},"aria-hidden":"true",children:o.icon}),l.jsx("span",{style:{flex:1},children:t.message}),t.dismissible&&l.jsx("button",{type:"button",onClick:()=>e(t.id),"aria-label":" ",style:{background:"transparent",border:"none",color:"inherit",fontSize:18,lineHeight:1,cursor:"pointer",padding:4,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:8,transition:"background 0.2s"},onMouseEnter:i=>{i.currentTarget.style.background="rgba(0,0,0,0.1)"},onMouseLeave:i=>{i.currentTarget.style.background="transparent"},children:""})]})}function qb({notification:t,onClose:e}){const r=S.useRef(null),n=S.useRef(null),s=S.useRef(null);return S.useEffect(()=>{const o=r.current;if(!o)return;const i=o.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=i[0],c=i[i.length-1];a&&a.focus();const u=f=>{f.key==="Tab"&&(f.shiftKey?document.activeElement===a&&(f.preventDefault(),c==null||c.focus()):document.activeElement===c&&(f.preventDefault(),a==null||a.focus()))},d=f=>{f.key==="Escape"&&e(t.id,!1)};return document.addEventListener("keydown",u),document.addEventListener("keydown",d),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",u),document.removeEventListener("keydown",d),document.body.style.overflow=""}},[t.id,e]),l.jsx("div",{className:"notify-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:16},onClick:o=>{o.target===o.currentTarget&&e(t.id,!1)},children:l.jsxs("div",{ref:r,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-description",className:"notify-modal",style:{background:"#fff",borderRadius:24,padding:24,maxWidth:400,width:"100%",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04)",animation:"modalFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},onClick:o=>o.stopPropagation(),children:[l.jsx("h2",{id:"modal-title",style:{fontSize:20,fontWeight:700,color:"var(--ink, #0F172A)",marginBottom:12,letterSpacing:"-0.02em"},children:t.title}),l.jsx("p",{id:"modal-description",style:{fontSize:14,color:"var(--ms-ink-soft)",lineHeight:1.6,marginBottom:24},children:t.message}),l.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[t.cancelLabel&&l.jsx("button",{ref:n,type:"button",onClick:()=>e(t.id,!1),style:{padding:"10px 20px",borderRadius:18,border:"1px solid var(--ms-line)",background:"#fff",color:"var(--ms-ink)",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:o=>{o.currentTarget.style.background="var(--ms-bg-soft)"},onMouseLeave:o=>{o.currentTarget.style.background="#fff"},children:t.cancelLabel}),l.jsx("button",{ref:s,type:"button",onClick:()=>e(t.id,!0),style:{padding:"10px 20px",borderRadius:18,border:"none",background:"var(--mint-500, #39C6A5)",color:"#fff",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:"var(--ms-shadow-soft)"},onMouseEnter:o=>{o.currentTarget.style.background="var(--mint-600, #24B89D)"},onMouseLeave:o=>{o.currentTarget.style.background="var(--mint-500, #39C6A5)"},children:t.confirmLabel})]})]})})}const dp=S.createContext(void 0);function Nt(){const t=S.useContext(dp);if(t===void 0)throw new Error("useNotify must be used within a NotifyProvider");return t}function Kb({children:t}){const[e,r]=S.useState(null),[n,s]=S.useState(null),[o,i]=S.useState(null);S.useEffect(()=>Ie.subscribe(f=>{if(f.type==="toast"){const h=f.data;h.message?r(h):r(null)}else if(f.type==="banner"){const h=f.data;h.message?s(h):s(null)}else if(f.type==="modal"){const h=f.data;h.title||h.message?i(h):i(null)}}),[]);const a=d=>{Ie.dismissToast(d)},c=d=>{Ie.dismissBanner(d)},u=(d,f)=>{Ie.closeModal(d,f)};return l.jsxs(dp.Provider,{value:Ie,children:[t,e&&l.jsx(Gb,{notification:e,onDismiss:a}),n&&l.jsx(Hb,{notification:n,onDismiss:c}),o&&l.jsx(qb,{notification:o,onClose:u})]})}class Jb extends S.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){C.err("ErrorBoundary caught an error:",e,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"24px",textAlign:"center",color:"var(--ms-ink)"},children:[l.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),l.jsx("h2",{style:{fontSize:20,fontWeight:700,marginBottom:8},children:" "}),l.jsx("p",{style:{fontSize:14,color:"var(--ms-ink-soft)",marginBottom:24},children:"   ."}),l.jsx("button",{onClick:()=>{window.location.reload()},style:{padding:"12px 24px",borderRadius:18,border:"1px solid var(--ms-line)",background:"var(--ms-primary)",color:"#fff",fontSize:15,fontWeight:600,cursor:"pointer"},children:""}),!1]}):this.props.children}}function Qb({children:t,fallback:e}){return l.jsx(Jb,{fallback:e,children:t})}const Yb={signup_welcome:{icon:"",title:" ",message:"   !   .",category:"onboarding"},seed_received:{icon:"",title:" ",message:"   .",category:"onboarding"},routine_streak_active:{icon:"",title:"  ",message:"  . !",category:"routine"},routine_streak_broken:{icon:"",title:" ",message:"  .   ?",category:"routine"},record_saved:{icon:"",title:"  ",message:"     .",category:"record"},record_with_image:{icon:"",title:"  ",message:"    .",category:"record"},first_record:{icon:"",title:"  ",message:"  .    .",category:"record"},record_updated:{icon:"",title:" ",message:"    .",category:"record"},record_deleted:{icon:"",title:" ",message:"    .",category:"record"},record_visibility_changed:{icon:"",title:"  ",message:"   .",category:"record"},report_received:{icon:"",title:"  ",message:"  .  .",category:"forest"},like_received:{icon:"",title:" ",message:"   .",category:"forest"},like_three:{icon:"",title:"3  ",message:"   .",category:"forest"},like_five:{icon:"",title:"5  ",message:"    .",category:"forest"},likes_total:{icon:"",title:"  ",message:"  N  .",category:"forest"},post_selected_best:{icon:"",title:"  ",message:"   BEST  .",category:"forest"},report_resolved:{icon:"",title:"  ",message:"  .",category:"forest"},report_rejected:{icon:"",title:" ",message:"     .",category:"forest"},growth_level_1:{icon:"",title:"1 ",message:"   .",category:"growth"},growth_level_2:{icon:"",title:"2 ",message:",  .",category:"growth"},growth_level_3:{icon:"",title:"3 ",message:"  .  .",category:"growth"},growth_level_4:{icon:"",title:"4   ",message:"    .",category:"growth"},growth_level_5:{icon:"",title:"5 ",message:"!    .",category:"growth"},bloom_caption_saved:{icon:"",title:"    ",message:"   .",category:"flower"},bloom_exported:{icon:"",title:" ",message:"  .",category:"flower"},routine_7days:{icon:"",title:"  ",message:"7   !    .",category:"routine"},routine_30days:{icon:"",title:"30   !",message:" .    .",category:"routine"},backup_required:{icon:"",title:" ",message:"  .",category:"system"},backup_completed:{icon:"",title:" ",message:"  .",category:"system"},logged_out:{icon:"",title:"",message:"  .",category:"account"},profile_photo_updated:{icon:"",title:" ",message:"   .",category:"profile"},nickname_updated:{icon:"",title:" ",message:"  .",category:"profile"},mbti_updated:{icon:"",title:"MBTI ",message:"   .",category:"profile"},pin_enabled:{icon:"",title:"PIN  ",message:"   .",category:"profile"},pin_disabled:{icon:"",title:"PIN  ",message:"  .",category:"profile"},pin_reset:{icon:"",title:"PIN ",message:"   .",category:"profile"},flower_saved:{icon:"",title:"  ",message:"    .",category:"flower"},flower_deleted:{icon:"",title:"  ",message:"   .",category:"flower"},support_request_created:{icon:"",title:" ",message:"  .",category:"support"},support_request_answered:{icon:"",title:" ",message:"  .",category:"support"},account_deleted:{icon:"",title:" ",message:"  .",category:"account"},account_rejoined:{icon:"",title:"",message:"  .",category:"account"},ops_notice:{icon:"",title:" ",message:"    .",category:"operations"},event_started:{icon:"",title:" ",message:"  .",category:"operations"},event_awarded:{icon:"",title:" ",message:"!  .",category:"operations"},maintenance_notice:{icon:"",title:"  ",message:"      .",category:"system"},app_update_required:{icon:"",title:" ",message:"  .",category:"system"}},Xb=14,Zb=()=>{var t,e;return((e=(t=globalThis==null?void 0:globalThis.crypto)==null?void 0:t.randomUUID)==null?void 0:e.call(t))??`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`},eS=()=>new Date().toISOString(),tS=t=>Date.now()-new Date(t).getTime()>Xb*24*60*60*1e3;function hp(t){const e=Yb[t];if(!e)throw new Error(`Notification template for type "${t}" is missing.`);return e}async function Wn(t,e,r={},n){const s=hp(e),o={id:Zb(),userId:t,type:e,icon:(n==null?void 0:n.icon)??s.icon,title:(n==null?void 0:n.title)??s.title,message:(n==null?void 0:n.message)??s.message,category:s.category,isRead:!1,createdAt:eS(),meta:r};try{const{data:i,error:a}=await z.from("notifications").insert({id:o.id,user_id:t,type:e,title:o.title,message:o.message,is_read:!1,created_at:o.createdAt}).select().single();a?console.error("[createNotification] Supabase  :",{code:a.code,message:a.message,details:a.details,hint:a.hint,userId:t,type:e}):console.log("[createNotification] Supabase  :",{notificationId:i==null?void 0:i.id,userId:t,type:e})}catch(i){console.error("[createNotification]    :",{error:i,errorMessage:i instanceof Error?i.message:String(i),userId:t,type:e})}return o}async function fp(t){try{const{data:e,error:r}=await z.from("notifications").select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(100);return r?(console.error("[fetchNotifications] Supabase  :",{code:r.code,message:r.message,details:r.details,hint:r.hint,userId:t}),[]):(e||[]).map(o=>{let i;try{i=hp(o.type)}catch{i={icon:"",category:"operations"}}return{id:o.id,userId:o.user_id,type:o.type,icon:i.icon,title:o.title||i.title,message:o.message||i.message,category:i.category,isRead:o.is_read||!1,createdAt:o.created_at,meta:{}}}).filter(o=>!tS(o.createdAt))}catch(e){return console.error("[fetchNotifications]    :",{error:e,errorMessage:e instanceof Error?e.message:String(e),userId:t}),[]}}async function mp(t){try{const{error:e}=await z.from("notifications").update({is_read:!0}).eq("id",t);e&&console.error("[markNotificationRead] Supabase  :",{code:e.code,message:e.message,details:e.details,hint:e.hint,notificationId:t})}catch(e){console.error("[markNotificationRead]     :",{error:e,errorMessage:e instanceof Error?e.message:String(e),notificationId:t})}}async function gp(t){try{const{error:e}=await z.from("notifications").update({is_read:!0}).eq("user_id",t).eq("is_read",!1);e&&console.error("[markAllNotificationsRead] Supabase  :",{code:e.code,message:e.message,details:e.details,hint:e.hint,userId:t})}catch(e){console.error("[markAllNotificationsRead]      :",{error:e,errorMessage:e instanceof Error?e.message:String(e),userId:t})}}const rS=Object.freeze(Object.defineProperty({__proto__:null,createNotification:Wn,fetchNotifications:fp,markAllNotificationsRead:gp,markNotificationRead:mp},Symbol.toStringTag,{value:"Module"}));function pp(t){const[e,r]=S.useState([]),[n,s]=S.useState(!1),o=e.filter(h=>!h.isRead).length,i=S.useCallback(async()=>{if(!t){r([]);return}const h=await fp(t);r(h)},[t]);return S.useEffect(()=>{if(!t){r([]);return}i();const h=window.setInterval(i,6e4);return()=>window.clearInterval(h)},[i,t]),S.useEffect(()=>(window.__refreshNotifications=i,()=>{delete window.__refreshNotifications}),[i]),{notifications:e,badgeCount:o,isSheetOpen:n,openSheet:()=>s(!0),closeSheet:()=>s(!1),markAll:async()=>{await gp(t),await i()},markRead:async h=>{await mp(h),await i()},refresh:i,pushNotification:async(h,w)=>{await Wn(t,h,w),await i()}}}function vp({isOpen:t,notifications:e,onClose:r,onMarkAllRead:n,onMarkRead:s}){if(!t)return null;const o=nS(e);return l.jsx("div",{className:"notif-sheet-overlay",onClick:i=>i.target===i.currentTarget&&r(),children:l.jsxs("section",{className:"notif-sheet",children:[l.jsxs("header",{className:"notif-sheet-header",children:[l.jsxs("div",{children:[l.jsx("h2",{children:""}),l.jsx("p",{children:"    ."})]}),l.jsx("button",{type:"button",onClick:n,children:" "})]}),l.jsxs("div",{className:"notif-sheet-content",children:[e.length===0&&l.jsx("div",{className:"notif-empty",children:"  ."}),Object.entries(o).map(([i,a])=>l.jsxs("div",{className:"notif-group",children:[l.jsx("div",{className:"notif-group-title",children:i}),l.jsx("div",{className:"notif-group-list",children:a.map(c=>l.jsxs("article",{className:`notif-item ${c.isRead?"read":""}`,onClick:()=>{!c.isRead&&s&&s(c.id)},style:{cursor:c.isRead?"default":"pointer"},children:[l.jsx("div",{className:"notif-icon","aria-hidden":"true",children:c.icon}),l.jsxs("div",{className:"notif-body",children:[l.jsx("div",{className:"notif-title",children:c.title}),l.jsx("div",{className:"notif-message",children:c.message})]}),l.jsx("div",{className:"notif-time",children:oS(c.createdAt)})]},c.id))})]},i))]}),l.jsx("footer",{className:"notif-sheet-footer",children:l.jsx("button",{type:"button",onClick:r,children:""})})]})})}function nS(t){return t.reduce((e,r)=>{const n=sS(r.createdAt);return e[n]||(e[n]=[]),e[n].push(r),e},{})}function sS(t){const e=new Date(t),r=new Date,n=new Date;return n.setDate(r.getDate()-1),yh(e,r)?"":yh(e,n)?"":`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}`}function yh(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function oS(t){const e=new Date(t);return`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}function iS(){const{user:t}=Ye(),{notifications:e,badgeCount:r,isSheetOpen:n,openSheet:s,closeSheet:o,markAll:i,markRead:a}=pp((t==null?void 0:t.id)||"");return l.jsxs(l.Fragment,{children:[l.jsx("header",{style:{position:"sticky",top:0,zIndex:10,background:"rgba(246,249,248,0.95)",backdropFilter:"blur(8px)",borderBottom:"0px solid var(--ms-line)"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"0px 16px 4px",maxWidth:720,margin:"0 auto"},children:[l.jsx("div",{style:{width:30,height:30,borderRadius:12,background:"var(--ms-primary-soft)",display:"grid",placeItems:"center",fontSize:18},children:""}),l.jsxs(sg,{to:"/",style:{color:"inherit",textDecoration:"none"},children:[l.jsx("div",{style:{fontWeight:700,letterSpacing:"-0.02em",fontSize:16},children:""}),l.jsx("div",{style:{fontSize:12,color:"var(--ms-ink-muted)",marginTop:2},children:"  "})]}),l.jsxs("button",{type:"button",className:"notif-bell",onClick:s,"aria-label":"",children:["",r>0&&l.jsx("span",{className:"notif-badge",children:r>99?"99+":r})]})]})}),l.jsx(vp,{isOpen:n,notifications:e,onClose:o,onMarkAllRead:i,onMarkRead:a})]})}function aS({isActive:t=!1,size:e=24}){const r=t?"#4A7068":"#D9D9D9";return l.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{width:"24",height:"24",fill:"white"}),l.jsx("path",{d:"M11.3184 4.25195C11.697 3.91592 12.2678 3.91594 12.6465 4.25195L20.9658 11.6348H19.9941V19.6631H13.9941V15.6631C13.9941 14.5585 13.0987 13.6631 11.9941 13.6631C10.8896 13.6631 9.99418 14.5585 9.99414 15.6631V19.6631H3.99414V11.6348H3L11.3184 4.25195Z",fill:r})]})}function lS({isActive:t=!1,size:e=24}){const r=t?"#4A7068":"#D9D9D9";return l.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{width:"24",height:"24",fill:"white"}),l.jsx("path",{d:"M11.3379 3.44531C11.7337 2.85162 12.6061 2.85162 13.002 3.44531L17.1338 9.64258C17.5109 10.2085 17.2203 10.9346 16.6328 11.1387L20.1797 16.6562C20.6074 17.3216 20.1298 18.197 19.3389 18.1973H13.1699V19.1973C13.1699 19.7495 12.7222 20.1973 12.1699 20.1973C11.6177 20.1972 11.17 19.7495 11.1699 19.1973V18.1973H5.00195C4.2109 18.1972 3.73256 17.3217 4.16016 16.6562L7.70703 11.1387C7.11987 10.9344 6.82995 10.2084 7.20703 9.64258L11.3379 3.44531Z",fill:r})]})}function cS({isActive:t=!1,size:e=24}){const r=t?"#4A7068":"#D9D9D9",n=t?"#D8D9D9":"#D9D9D9";return l.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{width:"24",height:"24",fill:"white"}),l.jsx("path",{d:"M7.5 4C7.77614 4 8 4.22386 8 4.5V5H14V4.5C14 4.22386 14.2239 4 14.5 4C14.7761 4 15 4.22386 15 4.5V5H16.4443C17.3038 5 18 5.69622 18 6.55566V17.4443C18 18.3038 17.3038 19 16.4443 19H5.55566C4.69622 19 4 18.3038 4 17.4443V6.55566C4 5.69622 4.69622 5 5.55566 5H7V4.5C7 4.22386 7.22386 4 7.5 4Z",fill:r}),l.jsx("rect",{x:"4.9375",y:"10",width:"12",height:"8",fill:"white"}),l.jsx("path",{d:"M12.3922 15.9353L10.5913 16.0158L11.2096 14.3224L17.6609 9.59168C18.1063 9.26509 18.7321 9.36139 19.0587 9.80676C19.3853 10.2521 19.289 10.8779 18.8436 11.2045L12.3922 15.9353Z",fill:n}),l.jsx("rect",{x:"17.231",y:"12.3867",width:"2",height:"1",transform:"rotate(-126.252 17.231 12.3867)",fill:"white"})]})}function uS({isActive:t=!1,size:e=24}){const r=t?"#4A7068":"#D9D9D9";return l.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{width:"24",height:"24",fill:"white"}),l.jsx("circle",{cx:"12",cy:"8",r:"4",fill:r}),l.jsx("path",{d:"M4 19C4 15.6863 6.68629 13 10 13H14C17.3137 13 20 15.6863 20 19H4Z",fill:r})]})}const hr={display:"grid",placeItems:"center",gap:3,padding:"8px 4px",borderRadius:12,color:"var(--ms-color-ink-muted)",textDecoration:"none",fontSize:11,fontWeight:600};function dS(){return l.jsx("nav",{style:{position:"fixed",left:0,right:0,bottom:0,background:"#fff",borderTop:"1px solid var(--ms-color-border-soft)",zIndex:20},children:l.jsxs("div",{style:{maxWidth:720,margin:"0 auto",display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:2,padding:"7px 8px 8px"},children:[l.jsx(Do,{to:"/",end:!0,style:({isActive:t})=>({...hr,color:t?"var(--ms-color-primary)":hr.color,background:t?"#e0f7f5":"transparent",border:t?"1px solid #99f6e4":"1px solid transparent"}),children:({isActive:t})=>l.jsxs(l.Fragment,{children:[l.jsx(aS,{isActive:t,size:24}),l.jsx("div",{children:""})]})}),l.jsx(Do,{to:"/forest",style:({isActive:t})=>({...hr,color:t?"var(--ms-color-primary)":hr.color,background:t?"#e0f7f5":"transparent",border:t?"1px solid #99f6e4":"1px solid transparent"}),children:({isActive:t})=>l.jsxs(l.Fragment,{children:[l.jsx(lS,{isActive:t,size:24}),l.jsx("div",{children:""})]})}),l.jsx(Do,{to:"/record",style:({isActive:t})=>({...hr,color:t?"var(--ms-color-primary)":hr.color,background:t?"#e0f7f5":"transparent",border:t?"1px solid #99f6e4":"1px solid transparent"}),children:({isActive:t})=>l.jsxs(l.Fragment,{children:[l.jsx(cS,{isActive:t,size:24}),l.jsx("div",{children:""})]})}),l.jsx(Do,{to:"/mypage",style:({isActive:t})=>({...hr,color:t?"var(--ms-color-primary)":hr.color,background:t?"#e0f7f5":"transparent",border:t?"1px solid #99f6e4":"1px solid transparent"}),children:({isActive:t})=>l.jsxs(l.Fragment,{children:[l.jsx(uS,{isActive:t,size:24}),l.jsx("div",{children:""})]})})]})})}function Rr({children:t,hideHeader:e=!0,contentPadding:r="16px 16px 96px"}){return l.jsxs("div",{className:"ms-app-shell",children:[l.jsxs("div",{className:"ms-app",style:{padding:r},children:[!e&&l.jsx(iS,{}),l.jsx("main",{style:{paddingTop:e?0:10},children:t})]}),l.jsx(dS,{})]})}function hS(){const{user:t,isGuest:e}=Ye(),{notifications:r,badgeCount:n,isSheetOpen:s,openSheet:o,closeSheet:i,markAll:a,markRead:c}=pp((t==null?void 0:t.id)||"");return l.jsxs(l.Fragment,{children:[l.jsx("header",{style:{position:"sticky",top:0,zIndex:10,background:"rgba(246,249,248,0.95)",backdropFilter:"blur(8px)",borderBottom:"0px solid var(--ms-line)"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"0px 16px 4px",maxWidth:720,margin:"0 auto"},children:[l.jsx("div",{style:{width:30,height:30,borderRadius:12,background:"var(--ms-primary-soft)",display:"grid",placeItems:"center",fontSize:18},children:""}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontWeight:700,letterSpacing:"-0.02em",fontSize:16},children:["",e&&l.jsx("span",{style:{fontSize:11,marginLeft:6,padding:"2px 6px",background:"linear-gradient(180deg, #F0FFFA, #E5FAF4)",border:"1px solid #CDEAE1",borderRadius:8,color:"#144E43",fontWeight:500},children:""})]}),l.jsx("div",{style:{fontSize:12,color:"var(--ms-ink-muted)",marginTop:2},children:"  "})]}),l.jsxs("button",{type:"button",className:"notif-bell",onClick:o,"aria-label":"",children:["",n>0&&l.jsx("span",{className:"notif-badge",children:n>99?"99+":n})]})]})}),l.jsx(vp,{isOpen:s,notifications:r,onClose:i,onMarkAllRead:a,onMarkRead:c})]})}function fS({todayLogged:t,todayDate:e}){const r=Re(),{isGuest:n,session:s}=Ye(),o=Nt(),i=e||new Date().toISOString().split("T")[0],a=t!==void 0?t:!1,c=n||!s,u=()=>{if(c){o.modal({title:"/    !",message:"   ,  .",confirmLabel:" / ",cancelLabel:"",onConfirm:()=>{console.log("[TodayRecordCTA] go signup -   "),C.log("TodayRecordCTA:   ",{path:"/signup",isGuest:c}),r("/signup",{replace:!0})},onCancel:()=>{}});return}r(`/record?date=${i}`)};return l.jsxs("button",{className:"ms-btn ms-btn-primary",onClick:u,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:6,padding:"0 16px",height:56,borderRadius:18,border:"1px solid transparent",fontSize:15,fontWeight:600,width:"100%",margin:"24px 0",background:"var(--ms-primary)",color:"#fff",cursor:"pointer",transition:"all 0.2s",boxShadow:"var(--ms-shadow-soft)",opacity:1},children:[" ",a?"  ":"  "]})}const wh=["","","","","","",""];function mS(t){const e=new Date(`${t}T00:00:00`),r=new Date(e);return r.setDate(r.getDate()+6),`${e.getMonth()+1}/${e.getDate()} - ${r.getMonth()+1}/${r.getDate()}`}function Go(t,e){const r=new Date(`${t}T00:00:00`),n=new Date(r);return n.setDate(n.getDate()+e),n.toISOString().split("T")[0]}function gS(t){const e=new Date(`${t}T00:00:00`);return`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}`}function pS(...t){return t.filter(Boolean).join(" ")}function vS({weekSummary:t,weekStart:e,todayDate:r,onDeleteRecord:n}){const s=Re(),o=Nt(),[i,a]=S.useState(null),[c,u]=S.useState(!1),[d,f]=S.useState(!1),h=r||new Date().toISOString().split("T")[0],w=e||(()=>{const k=new Date(h),j=(k.getDay()+6)%7,N=new Date(k);return N.setDate(N.getDate()-j),N.toISOString().split("T")[0]})(),p=S.useMemo(()=>t?t.map((k,E)=>({...k,date:k.date||Go(w,E)})):Array.from({length:7},(k,E)=>({date:Go(w,E),emoji:"",label:void 0,note:void 0,recordId:void 0,imageUrl:void 0})),[t,w]),b=S.useMemo(()=>mS(w),[w]),y=i!==null?p[i]:null,v=i!=null?wh[i]:"",g=y?gS(y.date):"";function m(k){const E=Go(w,k),j=p[k];if(E>h){o.warning("  !","");return}if(!j||!j.emoji){s(E===h?`/record?date=${E}`:`/record?date=${E}`);return}a(k),u(!0)}function _(){!y||!y.recordId||(console.log("[WeeklyMoodWidget]   :",{recordId:y.recordId,date:y.date}),u(!1),s(`/record?id=${y.recordId}&date=${y.date}`))}async function x(){if(!(!y||!y.recordId||!n||!window.confirm("   ?"))){f(!0);try{console.log("[WeeklyMoodWidget]  :",{recordId:y.recordId}),await n(y.recordId),console.log("[WeeklyMoodWidget]  :",{recordId:y.recordId}),u(!1)}catch(E){console.error("[WeeklyMoodWidget]  :",{recordId:y.recordId,error:E,errorMessage:E instanceof Error?E.message:String(E)}),alert("  .    .")}finally{f(!1)}}}return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"home-week-card",children:[l.jsxs("div",{className:"home-week-header",children:[l.jsxs("div",{children:[l.jsx("div",{className:"home-week-title",children:"   "}),l.jsx("div",{className:"home-week-desc",children:"     "})]}),l.jsx("div",{className:"home-week-range-label",children:b})]}),l.jsx("div",{className:"home-week-grid",style:{marginBottom:6},children:wh.map(k=>l.jsx("div",{className:"home-week-day-label",children:k},k))}),l.jsx("div",{className:"home-week-grid",children:p.map((k,E)=>{const j=Go(w,E),N=j===h,P=i===E&&c&&!!k.emoji,M=k.emoji||"";return l.jsx("button",{type:"button",className:pS("home-week-day-btn",k.emoji&&"has-emotion",N&&"is-today",P&&"is-selected",!k.emoji&&"is-empty"),onClick:()=>m(E),children:M},j)})}),l.jsx("p",{className:"home-week-helper",children:"     .      ."})]}),c&&y&&y.emoji&&l.jsx("div",{className:"ms-modal-backdrop show",onClick:k=>{k.target===k.currentTarget&&u(!1)},style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30},children:l.jsxs("div",{className:"forest-sheet home-detail-sheet",children:[l.jsxs("div",{className:"forest-sheet-top",children:[l.jsxs("div",{children:[l.jsx("p",{className:"forest-sheet-label",children:"  "}),l.jsxs("h2",{className:"forest-sheet-title",children:[v," "]}),l.jsx("p",{className:"forest-sheet-meta",children:g})]}),l.jsx("button",{type:"button",className:"forest-sheet-close",onClick:()=>u(!1),children:""})]}),l.jsxs("div",{className:"forest-sheet-emotion-row",children:[l.jsx("span",{className:"forest-sheet-emotion",children:y.emoji}),y.label&&l.jsx("span",{className:"forest-category-pill",children:y.label})]}),y.note&&l.jsx("div",{className:"forest-sheet-body",children:l.jsx("p",{children:y.note})}),y.imageUrl&&(()=>{const k=y.imageUrl?[y.imageUrl]:[];return k.length>0?l.jsx("div",{className:"emotion-record-images",children:k.map((E,j)=>l.jsx("img",{src:E,alt:`   ${j+1}`},j))}):null})(),y.recordId&&l.jsxs("div",{className:"forest-sheet-actions",children:[l.jsx("button",{type:"button",className:"forest-sheet-owner-btn",onClick:_,disabled:d,children:""}),n&&l.jsx("button",{type:"button",className:"forest-sheet-owner-btn",onClick:x,disabled:d,style:{color:"#ef4444",borderColor:"#fecaca",background:"#fff5f5"},children:d?" ...":""})]})]})})]})}function yp(t){const[e,r]=S.useState(null),[n,s]=S.useState(!1),[o,i]=S.useState(null),a=S.useCallback(async()=>{if(!t){r(null);return}s(!0),i(null);try{const{data:u,error:d}=await z.from("user_settings").select("*").eq("user_id",t).single();d?d.code==="PGRST116"?r(null):(console.error("  :",d),i(d.message)):r(u)}catch(u){const d=u instanceof Error?u.message:"  .";i(d),console.error("  :",u)}finally{s(!1)}},[t]),c=S.useCallback(async u=>{var d,f,h,w;if(!t){const p=new Error(" ID .");return i(p.message),{data:null,error:p}}i(null);try{console.log("[useSettings]   :",{userId:t,payload:u,payloadKeys:Object.keys(u),seedNameValue:u.seed_name});const p={user_id:t,...u,updated_at:new Date().toISOString()};console.log("[useSettings] upsert payload:",{user_id:p.user_id,seed_name:p.seed_name,payloadKeys:Object.keys(p)});const{error:b}=await z.from("user_settings").upsert(p,{onConflict:"user_id"});if(b){console.error("[useSettings] upsert :",{userId:t,payload:u,upsertPayload:p,error:b,code:b.code,message:b.message,details:b.details,hint:b.hint});let g=b.message;return(d=b.message)!=null&&d.includes("row-level security")||(f=b.message)!=null&&f.includes("RLS")||b.code==="42501"?(g="  . Supabase Dashboard RLS  . (fix_user_settings_rls_policy.sql  )",console.error("[useSettings] RLS    :",{error:b.message,code:b.code,hint:"Supabase Dashboard > SQL Editor fix_user_settings_rls_policy.sql  "})):((h=b.message)!=null&&h.includes("seed_name")||(w=b.message)!=null&&w.includes("column"))&&(g="     . Supabase Dashboard  . (fix_seed_name_column.sql)",console.error("[useSettings] seed_name    .  :",{error:b.message,hint:"Supabase Dashboard > SQL Editor fix_seed_name_column.sql  "})),i(g),{data:null,error:{...b,message:g}}}console.log("[useSettings] upsert ,   ");const{data:y,error:v}=await z.from("user_settings").select("*").eq("user_id",t).single();if(v){console.error("[useSettings] SELECT  (upsert   ):",{userId:t,error:v,code:v.code,message:v.message,details:v.details,hint:v.hint}),console.warn("[useSettings] SELECT  upsert   . upsertPayload ");const g={user_id:t,nickname:p.nickname!==void 0?p.nickname:(e==null?void 0:e.nickname)||null,mbti:p.mbti!==void 0?p.mbti:(e==null?void 0:e.mbti)||null,profile_url:p.profile_url!==void 0?p.profile_url:(e==null?void 0:e.profile_url)||null,seed_name:p.seed_name!==void 0?p.seed_name:(e==null?void 0:e.seed_name)||null,lock_type:p.lock_type!==void 0?p.lock_type:(e==null?void 0:e.lock_type)||null,lock_value:p.lock_value!==void 0?p.lock_value:(e==null?void 0:e.lock_value)||null,updated_at:p.updated_at,created_at:(e==null?void 0:e.created_at)||new Date().toISOString()};return r(g),i(null),{data:g,error:null}}if(!y){console.error("[useSettings] SELECT  null (upsert   ):",{userId:t,payload:u});const g={user_id:t,nickname:p.nickname!==void 0?p.nickname:(e==null?void 0:e.nickname)||null,mbti:p.mbti!==void 0?p.mbti:(e==null?void 0:e.mbti)||null,profile_url:p.profile_url!==void 0?p.profile_url:(e==null?void 0:e.profile_url)||null,seed_name:p.seed_name!==void 0?p.seed_name:(e==null?void 0:e.seed_name)||null,lock_type:p.lock_type!==void 0?p.lock_type:(e==null?void 0:e.lock_type)||null,lock_value:p.lock_value!==void 0?p.lock_value:(e==null?void 0:e.lock_value)||null,updated_at:p.updated_at,created_at:(e==null?void 0:e.created_at)||new Date().toISOString()};return r(g),console.warn("[useSettings] SELECT  null upsert   . fallbackData "),{data:g,error:null}}return console.log("[useSettings]   :",{userId:t,data:y,savedSeedName:y.seed_name,savedNickname:y.nickname}),u.seed_name&&y.seed_name!==u.seed_name&&console.warn("[useSettings]  seed_name  :",{input:u.seed_name,saved:y.seed_name}),y&&(r(y),console.log("[useSettings] settings state  :",{seedName:y.seed_name})),{data:y,error:null}}catch(p){const b=p instanceof Error?p:new Error("  ."),y=b.message;return i(y),console.error("[useSettings]     :",{userId:t,payload:u,error:p,errorMessage:y}),{data:null,error:b}}},[t]);return S.useEffect(()=>{a()},[a]),{settings:e,fetchSettings:a,updateSettings:c,loading:n,error:o}}const yS={0:"/assets/garden/level-0-seed.svg",1:"/assets/garden/level-1-sprout.svg",2:"/assets/garden/level-2-stem.svg",3:"/assets/garden/level-3-bud.svg",4:"/assets/garden/level-4-half-bloom.svg",5:"/assets/garden/level-5-bloom.svg"},wS={0:"",1:"",2:"",3:"",4:"",5:""};function _S(t){return Math.max(0,Math.min(100,Math.round(t)))}function bS(t,e){return e!==void 0?e:t>=100?5:t>=70?4:t>=50?3:t>=30?2:t>=10?1:0}function SS(t){const r=2*Math.PI*70,n=r*(1-t/100);return{radius:70,circumference:r,dashOffset:n}}function xS({growthPct:t,growthLevelImage:e,stageLabel:r,bloomLevel:n}){const s=_S(t),o=S.useMemo(()=>bS(s,n),[s,n]),i=r||wS[o],a=e||yS[o],c=S.useMemo(()=>SS(s),[s]);return l.jsxs("div",{className:"home-garden-gauge",children:[l.jsxs("svg",{viewBox:"0 0 160 160",children:[l.jsx("circle",{className:"home-garden-ring-bg",cx:"80",cy:"80",r:c.radius}),l.jsx("circle",{className:"home-garden-ring-progress",cx:"80",cy:"80",r:c.radius,strokeDasharray:`${c.circumference} ${c.circumference}`,strokeDashoffset:c.dashOffset})]}),l.jsxs("div",{className:"home-garden-gauge-center",children:[a?l.jsx("div",{className:"home-garden-gauge-icon",children:l.jsx("img",{src:a,alt:`${i} `})}):l.jsx("div",{className:"home-garden-gauge-icon",style:{fontSize:48},children:""}),l.jsxs("p",{className:"home-garden-gauge-percent",children:[s,"%"]})]})]})}const _h={background:"transparent",color:"var(--ms-ink-soft)",borderRadius:999,border:"1px solid var(--ms-line)",padding:"4px 10px",fontSize:11,cursor:"pointer"},kS={0:"",1:"",2:"",3:"",4:"",5:""},bh={0:"/assets/garden/level-0-seed.svg",1:"/assets/garden/level-1-sprout.svg",2:"/assets/garden/level-2-stem.svg",3:"/assets/garden/level-3-bud.svg",4:"/assets/garden/level-4-half-bloom.svg",5:"/assets/garden/level-5-bloom.svg"};function ES(t,e){return e!==void 0?e:t>=100?5:t>=70?4:t>=50?3:t>=30?2:t>=10?1:0}function jS({growthPct:t,bloomLevel:e,seedName:r="",totalDays:n=30,recordedDays:s=15,todayMessage:o="  :        "}){const{user:i}=Ye(),a=Nt(),{updateSettings:c,fetchSettings:u}=yp((i==null?void 0:i.id)||null),[d,f]=S.useState(!1),[h,w]=S.useState(!1),[p,b]=S.useState(r),[y,v]=S.useState(r);S.useEffect(()=>{console.log("[FlowerBadge] seedName prop  :",{oldSeedName:y,newSeedName:r}),v(r),d||b(r)},[r,d]);const g=ES(t,e),m=kS[g],_=bh[g]||bh[0];function x(){if(h){a.warning("     .","");return}console.log("[FlowerBadge]     :",{seedName:r,currentSeedName:y}),b(r||y),f(!0)}async function k(){const E=p.trim();if(!E){a.warning("  .","");return}if(E.length>10){a.warning("  10  .","");return}if(i)try{console.log("[FlowerBadge]    :",{userId:i.id,seedName:E,currentSeedName:y,seedNameProp:r});const{data:j,error:N}=await c({seed_name:E});if(N){console.error("[FlowerBadge]    :",{userId:i.id,seedName:E,error:N,errorCode:N.code,errorMessage:N.message,errorDetails:N.details,errorHint:N.hint}),a.error(`   : ${N.message}`,"");return}if(!j){console.error("[FlowerBadge]    : data null",{userId:i.id,seedName:E}),a.error("   . ( )","");return}if(console.log("[FlowerBadge]    :",{userId:i.id,seedName:E,savedData:j,savedSeedName:j.seed_name}),j.seed_name!==E&&console.warn("[FlowerBadge]  seed_name  :",{input:E,saved:j.seed_name}),console.log("[FlowerBadge] fetchSettings  "),await u(),console.log("[FlowerBadge] fetchSettings  "),window.__refreshHomeData){console.log("[FlowerBadge]    ");try{await window.__refreshHomeData(),console.log("[FlowerBadge]    ")}catch(P){console.error("[FlowerBadge]    :",P)}}else console.warn("[FlowerBadge] __refreshHomeData  ");v(E),w(!0),f(!1),a.success(`  "${E}" .`,"")}catch(j){console.error("[FlowerBadge]      :",{userId:i.id,error:j,errorMessage:j instanceof Error?j.message:String(j),errorStack:j instanceof Error?j.stack:void 0}),a.error(`   : ${j instanceof Error?j.message:String(j)}`,"")}else v(E),w(!0),f(!1),a.success(`  "${E}" .`,"")}return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"home-garden-card",children:[l.jsxs("div",{className:"home-garden-header",children:[l.jsx("div",{className:"home-garden-title",children:" "}),l.jsxs("p",{className:"home-garden-caption",children:[" ",n,"  ",s," .",l.jsx("br",{}),"  ."]})]}),l.jsx("div",{className:"home-garden-gauge-wrapper",children:l.jsx(xS,{growthPct:t,growthLevelImage:_,stageLabel:m,bloomLevel:g})}),l.jsxs("div",{className:"home-garden-stage-box",children:[l.jsx("div",{className:"home-garden-stage-label",children:"  "}),l.jsxs("div",{className:"home-garden-stage-value",children:[m," "]})]}),l.jsxs("div",{className:"home-garden-seed-section",children:[l.jsx("span",{className:"home-garden-seed-label",children:" "}),l.jsx("span",{className:"home-garden-seed-value",children:y}),l.jsx("button",{type:"button",className:"home-seed-edit",onClick:x,"aria-label":"  ",children:""})]}),l.jsxs("div",{className:"home-garden-message-wrapper",children:[l.jsx("span",{className:"home-garden-message-icon",children:""}),l.jsx("p",{className:"home-garden-message",children:o})]})]}),d&&l.jsx("div",{className:"ms-modal-backdrop show",onClick:E=>{E.target===E.currentTarget&&f(!1)},style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30},children:l.jsxs("div",{className:"ms-modal",style:{width:"calc(100% - 48px)",maxWidth:360,background:"var(--ms-surface)",borderRadius:24,boxShadow:"0 8px 30px rgba(15,23,42,0.16)",padding:"18px 18px 14px"},children:[l.jsx("div",{className:"ms-modal-title",style:{fontSize:17,fontWeight:600,marginBottom:6},children:"  "}),l.jsx("div",{className:"ms-modal-date",style:{fontSize:11,color:"var(--ms-ink-muted)",marginBottom:12},children:"    ?"}),l.jsx("input",{type:"text",value:p,onChange:E=>b(E.target.value),maxLength:10,style:{width:"100%",padding:"8px 10px",fontSize:13,borderRadius:18,border:"1px solid var(--ms-line)",marginBottom:8}}),l.jsxs("div",{className:"ms-input-help",style:{fontSize:11,color:"var(--ms-ink-muted)",marginBottom:12},children:[" 10  /   ",l.jsx("br",{})," : , , "]}),l.jsxs("div",{className:"ms-modal-actions",style:{display:"flex",justifyContent:"flex-end",gap:8,flexWrap:"wrap"},children:[l.jsx("button",{type:"button",className:"ms-btn-ghost-sm",onClick:()=>f(!1),style:_h,children:""}),l.jsx("button",{type:"button",className:"ms-btn-ghost-sm",onClick:k,style:_h,children:""})]})]})})]})}function CS({feedCount:t=0,likeSum:e=0}){const r=Re();return l.jsxs("section",{className:"home-week-card",style:{marginTop:24,cursor:"pointer"},onClick:()=>r("/forest"),children:[l.jsxs("div",{className:"home-week-header",children:[l.jsxs("div",{children:[l.jsx("div",{className:"home-week-title",children:""}),l.jsx("div",{className:"home-week-desc",children:"    "})]}),l.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--ms-primary)"},children:t>0?`${t} `:" "})]}),l.jsx("div",{style:{marginTop:12,fontSize:13,color:"var(--ms-ink-soft)"},children:t>0?` ${t}   .${e>0?`  ${e}   `:""}  ?`:"   .    ?"})]})}const NS="modulepreload",PS=function(t){return"/"+t},Sh={},Bi=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=PS(c),c in Sh)return;Sh[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":NS,u||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((h,w)=>{f.addEventListener("load",h),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return s.then(i=>{for(const a of i||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function wp(t){const e=Ft(),[r,n]=S.useState(null),[s,o]=S.useState([]),[i,a]=S.useState(null),[c,u]=S.useState({likeSum:0,postCount:0}),[d,f]=S.useState(" "),[h,w]=S.useState(!0),[p,b]=S.useState(null),y=S.useCallback(async()=>{if(e.pathname.startsWith("/onboarding")){console.log("[useHomeData]   ,   skip"),w(!1);return}if(!t){w(!1);return}w(!0),b(null);try{const g=new Date().toISOString().split("T")[0],m=new Date;m.setDate(m.getDate()-7);const _=m.toISOString(),{data:x,error:k}=await z.from("emotions").select("*").eq("user_id",t).eq("emotion_date",g).order("created_at",{ascending:!1}).limit(1).maybeSingle();k&&console.error("[useHomeData]    :",{code:k.code,message:k.message,details:k.details,hint:k.hint,userId:t});const E=new Date;E.setDate(E.getDate()-7);const j=E.toISOString().split("T")[0],{data:N,error:P}=await z.from("emotions").select("main_emotion, emotion_date").eq("user_id",t).gte("emotion_date",j).lte("emotion_date",g).order("emotion_date",{ascending:!1});P&&console.error("[useHomeData]    :",{code:P.code,message:P.message,details:P.details,hint:P.hint,userId:t});const M=new Map;N==null||N.forEach(W=>{const Q=W.emotion_date||new Date().toISOString().split("T")[0],H=`${Q}-${W.main_emotion}`,he=M.get(H);he?he.count+=1:M.set(H,{count:1,date:Q})});const X=Array.from(M.entries()).map(([W,Q])=>{const[,H]=W.split("-");return{main_emotion:H,count:Q.count,date:Q.date}}),{data:R,error:A}=await z.from("flowers").select("*").eq("user_id",t).eq("is_bloomed",!1).maybeSingle();if(A&&A.code!=="PGRST116"&&console.error("[useHomeData]     :",{code:A.code,message:A.message,details:A.details,hint:A.hint,userId:t}),R)console.log("[useHomeData]     :",{userId:t,flowerId:R.id,growthPercent:R.growth_percent,isBloomed:R.is_bloomed}),a(R);else{console.log("[useHomeData]    ,   (fallback):",{userId:t});try{const{ensureFlowerRow:W}=await Bi(async()=>{const{ensureFlowerRow:H}=await Promise.resolve().then(()=>US);return{ensureFlowerRow:H}},void 0),Q=await W(t);Q?(console.log("[useHomeData]      (fallback):",{userId:t,flowerId:Q.id,growthPercent:Q.growth_percent,isBloomed:Q.is_bloomed}),a({id:Q.id,user_id:Q.user_id,flower_type:Q.flower_type,growth_percent:Q.growth_percent,is_bloomed:Q.is_bloomed,bloomed_at:Q.bloomed_at,created_at:Q.created_at,updated_at:Q.updated_at})):(console.warn("[useHomeData]      (fallback):",{userId:t}),a(null))}catch(W){console.error("[useHomeData]       (fallback):",{error:W,errorMessage:W instanceof Error?W.message:String(W),userId:t}),a(null)}}const{data:I,error:V}=await z.from("community_posts").select("like_count").eq("user_id",t);V&&console.error("  :",V);const re=(I==null?void 0:I.reduce((W,Q)=>W+(Q.like_count||0),0))||0,T=(I==null?void 0:I.length)||0,{data:L,error:U}=await z.from("user_settings").select("seed_name, updated_at").eq("user_id",t).maybeSingle();U&&U.code!=="PGRST116"&&console.error("[useHomeData] user_settings  :",{code:U.code,message:U.message,details:U.details,hint:U.hint,userId:t});const $=(L==null?void 0:L.seed_name)||(R==null?void 0:R.seed_name)||" ";console.log("[useHomeData] seedName :",{userId:t,userSettingsData:L?{seed_name:L.seed_name,updated_at:L.updated_at}:null,flowerSeedName:R==null?void 0:R.seed_name,finalSeedName:$,timestamp:new Date().toISOString()}),n(x||null),o(X),u({likeSum:re,postCount:T}),f($),console.log("[useHomeData] fetchData :",{userId:t,flowerData:R?{id:R.id,growthPercent:R.growth_percent,isBloomed:R.is_bloomed,flowerType:R.flower_type}:null,hasFlower:!!R,flowerStateUpdated:!0}),console.log("[useHomeData] fetchData :",{userId:t,flowerData:R?{id:R.id,growthPercent:R.growth_percent,isBloomed:R.is_bloomed}:null,hasFlower:!!R})}catch(g){const m=g instanceof Error?g.message:"  .";b(m),console.error("[useHomeData]    :",{error:g,errorMessage:g instanceof Error?g.message:String(g),errorStack:g instanceof Error?g.stack:void 0,userId:t}),Ie.error("   ","")}finally{w(!1)}},[t]);S.useEffect(()=>{if(e.pathname.startsWith("/onboarding")){console.log("[useHomeData]   , useEffect skip");return}if(y(),!t)return;const g=z.channel("home_emotions_realtime").on("postgres_changes",{event:"*",schema:"public",table:"emotions",filter:`user_id=eq.${t}`},()=>{y()}).subscribe(),m=z.channel("home_flowers_realtime").on("postgres_changes",{event:"*",schema:"public",table:"flowers",filter:`user_id=eq.${t}`},()=>{y()}).subscribe(),_=z.channel("home_posts_realtime").on("postgres_changes",{event:"*",schema:"public",table:"community_posts",filter:`user_id=eq.${t}`},()=>{y()}).subscribe(),x=z.channel("home_user_settings_realtime").on("postgres_changes",{event:"*",schema:"public",table:"user_settings",filter:`user_id=eq.${t}`},k=>{console.log("[useHomeData] user_settings  :",{event:k.eventType,new:k.new,old:k.old}),y()}).subscribe();return()=>{z.removeChannel(g),z.removeChannel(m),z.removeChannel(_),z.removeChannel(x)}},[y,t,e.pathname]);const v=S.useCallback(async()=>{console.log("[useHomeData] refetch :",{userId:t,pathname:e.pathname}),await y()},[y,t,e.pathname]);return S.useEffect(()=>(window.__refreshHomeData=v,()=>{delete window.__refreshHomeData}),[v]),{today:r,weekStats:s,flower:i,feedSummary:c,seedName:d,loading:h,error:p,refetch:v}}function bu(t={}){const{userId:e,publicOnly:r=!1,limit:n}=t,[s,o]=S.useState([]),[i,a]=S.useState(!1),[c,u]=S.useState(null),d=S.useCallback(async()=>{if(!e&&!r){o([]);return}a(!0),u(null);try{let m=z.from("emotions").select("*");r?m=m.eq("is_public",!0):e&&(m=m.eq("user_id",e)),m=m.order("created_at",{ascending:!1}),n&&(m=m.limit(n));const{data:_,error:x}=await m;if(x)throw x;o(_||[])}catch(m){const _=m instanceof Error?m:new Error("   .");u(_),console.error("   :",_)}finally{a(!1)}},[e,r,n]);S.useEffect(()=>{d()},[d]);const f=S.useCallback(async m=>{var _,x,k,E,j,N,P,M,X,R,A,I,V,re;if(!e)throw new Error(" .");u(null);try{const{data:{user:T},error:L}=await z.auth.getUser();if(L){console.error("[addEmotion] auth.getUser() :",{error:L,userId:e});const Z=new Error("    .  .");return u(Z),{data:null,error:Z}}if(!T){console.error("[addEmotion] auth.uid() :",{userId:e,message:"  ."});const Z=new Error(" .  .");return u(Z),{data:null,error:Z}}T.id!==e&&(console.error("[addEmotion] auth.uid() userId :",{userId:e,authUid:T.id,message:"user_id auth.uid()  . RLS   ."}),console.warn("[addEmotion] userId auth.uid() :",{oldUserId:e,newUserId:T.id}));const U=T.id,W={emotion_date:m.emotion_date||new Date().toISOString().split("T")[0],main_emotion:m.emotion_type,content:m.content};m.intensity!==void 0&&m.intensity!==null&&(W.intensity=m.intensity),m.note!==void 0&&m.note!==null&&(W.note=m.note),m.is_public!==void 0&&m.is_public!==null&&(W.is_public=m.is_public),m.category!==void 0&&m.category!==null&&(W.category=m.category),m.image_url!==void 0&&(W.image_url=m.image_url&&m.image_url.trim()!==""?m.image_url:null);const Q={user_id:U,...W};if(!Q.main_emotion||!Q.content){const Z=new Error("  .   .");return console.error("[addEmotion] payload  :",{main_emotion:Q.main_emotion,content:Q.content,payload:Q}),u(Z),{data:null,error:Z}}console.log("[addEmotion] insert :",{originalUserId:e,finalUserId:U,authUid:T.id,userIdMatch:e===T.id,payload:Q,payloadKeys:Object.keys(Q),payloadValues:Object.values(Q),payloadStringified:JSON.stringify(Q,null,2)}),console.log("[addEmotion] Supabase insert   -  :",{table:"emotions",payload:Q,payloadKeys:Object.keys(Q),payloadValues:Object.values(Q),supabaseUrl:z.supabaseUrl||"unknown",hasAuth:!!T,authUserId:T.id});let H=null,he=null;try{const Z=await z.from("emotions").insert(Q).select().single();he=Z.data,H=Z.error,console.log("[addEmotion] Supabase insert  :",{hasData:!!he,hasError:!!H,errorCode:H==null?void 0:H.code,errorMessage:H==null?void 0:H.message,errorDetails:H==null?void 0:H.details,errorHint:H==null?void 0:H.hint})}catch(Z){console.error("[addEmotion] Supabase insert    :",{fetchError:Z,errorMessage:Z instanceof Error?Z.message:String(Z),errorStack:Z instanceof Error?Z.stack:void 0,isNetworkError:Z instanceof Error&&(((_=Z.message)==null?void 0:_.includes("fetch"))||((x=Z.message)==null?void 0:x.includes("network"))||((k=Z.message)==null?void 0:k.includes("Failed to fetch")))}),Z instanceof Error&&((E=Z.message)!=null&&E.includes("fetch")||(j=Z.message)!=null&&j.includes("network")||(N=Z.message)!=null&&N.includes("Failed to fetch"))?H={code:"NETWORK_ERROR",message:"  . Supabase    .",details:Z.message,hint:"    Supabase   ."}:H={code:"UNKNOWN_ERROR",message:Z instanceof Error?Z.message:"    .",details:String(Z)}}if(H){console.error("[addEmotion] insert  -  :",{error:H,code:H.code,message:H.message,details:H.details,hint:H.hint,originalUserId:e,finalUserId:U,authUid:T.id,payload:Q,payloadStringified:JSON.stringify(Q,null,2),isRLSError:H.code==="42501"||((P=H.message)==null?void 0:P.includes("permission denied"))||((M=H.message)==null?void 0:M.includes("RLS"))||((X=H.message)==null?void 0:X.includes("row-level security")),isNetworkError:((R=H.message)==null?void 0:R.includes("fetch"))||((A=H.message)==null?void 0:A.includes("network"))||((I=H.message)==null?void 0:I.includes("Failed to fetch"))});let Z=H.message||"   .";H.code==="42501"||(V=H.message)!=null&&V.includes("permission denied")||(re=H.message)!=null&&re.includes("RLS")?(Z="   .   .",console.error("[addEmotion] RLS    - auth.uid() user_id  ")):H.code==="23503"?(Z="    .  .",console.error("[addEmotion] Foreign Key    - users  user_id ")):H.code==="23502"?(Z="  .  .",console.error("[addEmotion] NOT NULL   ")):H.code==="23514"&&(Z="  .  .",console.error("[addEmotion] CHECK   "));const Pt=new Error(Z);return u(Pt),{data:null,error:Pt}}if(!he)throw console.error("[addEmotion] data null:",{userId:e,payload:Q}),new Error("     .");return console.log("[addEmotion] insert :",{dataId:he.id,userId:he.user_id,mainEmotion:he.main_emotion}),o(Z=>[he,...Z]),{data:he,error:null}}catch(T){console.error("[addEmotion]  :",{error:T,errorMessage:T instanceof Error?T.message:String(T),errorStack:T instanceof Error?T.stack:void 0,userId:e,payload:m});let L="   .";T instanceof Error&&(L=T.message,(T.message.includes("permission denied")||T.message.includes("RLS")||T.message.includes("42501"))&&(L="   .   .",console.error("[addEmotion] RLS   ")),(T.message.includes("fetch")||T.message.includes("network")||T.message.includes("Failed to fetch"))&&(L="  .",console.error("[addEmotion]   ")));const U=T instanceof Error?new Error(L):new Error(L);return u(U),{data:null,error:U}}},[e]),h=S.useCallback(async(m,_)=>{var x,k,E,j,N,P;if(!e)throw new Error(" .");u(null);try{const M={};_.emotion_type!==void 0&&(M.main_emotion=_.emotion_type),_.intensity!==void 0&&(M.intensity=_.intensity),_.content!==void 0&&(M.content=_.content),_.note!==void 0&&(M.note=_.note),_.is_public!==void 0&&(M.is_public=_.is_public),_.emotion_date!==void 0&&(M.emotion_date=_.emotion_date),_.category!==void 0&&(M.category=_.category),_.image_url!==void 0&&(M.image_url=_.image_url&&_.image_url.trim()!==""?_.image_url:null),console.log("[updateEmotion] Supabase update  :",{id:m,payload:M,userId:e});let X=null,R=null;try{const A=await z.from("emotions").update(M).eq("id",m).eq("user_id",e).select().single();R=A.data,X=A.error,console.log("[updateEmotion] Supabase update  :",{hasData:!!R,hasError:!!X,errorCode:X==null?void 0:X.code,errorMessage:X==null?void 0:X.message})}catch(A){console.error("[updateEmotion] Supabase update    :",{fetchError:A,errorMessage:A instanceof Error?A.message:String(A),isNetworkError:A instanceof Error&&(((x=A.message)==null?void 0:x.includes("fetch"))||((k=A.message)==null?void 0:k.includes("network"))||((E=A.message)==null?void 0:E.includes("Failed to fetch")))}),A instanceof Error&&((j=A.message)!=null&&j.includes("fetch")||(N=A.message)!=null&&N.includes("network")||(P=A.message)!=null&&P.includes("Failed to fetch"))?X={code:"NETWORK_ERROR",message:"  . Supabase    .",details:A.message}:X={code:"UNKNOWN_ERROR",message:A instanceof Error?A.message:"    ."}}if(X){const A=new Error(X.message||"   .");throw u(A),A}return R&&o(A=>A.map(I=>I.id===m?R:I)),{data:R,error:null}}catch(M){const X=M instanceof Error?M:new Error("   .");throw u(X),X}},[e]),w=S.useCallback(async m=>{if(!e)throw new Error(" .");u(null);try{const{error:_}=await z.from("emotions").delete().eq("id",m).eq("user_id",e);if(_){const x=new Error(_.message||"   .");throw u(x),x}return o(x=>x.filter(k=>k.id!==m)),{error:null}}catch(_){const x=_ instanceof Error?_:new Error("   .");throw u(x),x}},[e]),p=S.useCallback(m=>{const _=m.split("T")[0];return s.find(x=>(x.emotion_date||new Date(x.created_at).toISOString().split("T")[0])===_)||null},[s]),b=S.useCallback(async m=>{if(!e)return console.warn("[getEmotionById] userId ."),null;try{console.log("[getEmotionById]  :",{id:m,userId:e});const{data:_,error:x}=await z.from("emotions").select("*").eq("id",m).eq("user_id",e).maybeSingle();return x?(console.error("[getEmotionById]  :",{id:m,error:x,errorMessage:x.message}),null):_?(console.log("[getEmotionById]  :",{id:m,dataId:_.id,mainEmotion:_.main_emotion}),_):(console.warn("[getEmotionById]    :",{id:m,userId:e}),null)}catch(_){return console.error("[getEmotionById]  :",{id:m,error:_,errorMessage:_ instanceof Error?_.message:String(_)}),null}},[e]),y=S.useCallback(async m=>{if(!e)return null;try{const _=m||new Date().toISOString().split("T")[0],{data:x,error:k}=await z.from("emotions").select("*").eq("user_id",e).eq("emotion_date",_).order("created_at",{ascending:!1}).limit(1).maybeSingle();return k?(console.error("   :",k),null):x}catch(_){return console.error("    :",_),null}},[e]),v=S.useCallback(async m=>{if(!e)return!1;try{const _=m||new Date().toISOString().split("T")[0],{data:x,error:k}=await z.from("emotions").select("id").eq("user_id",e).eq("emotion_date",_).eq("is_public",!1).limit(1).maybeSingle();return k?(console.error("    :",k),!1):x!==null}catch(_){return console.error("     :",_),!1}},[e]),g=S.useCallback(async m=>{if(!e)return!1;try{const _=m||new Date().toISOString().split("T")[0],x=new Date(`${_}T00:00:00Z`).toISOString(),k=new Date(`${_}T23:59:59Z`).toISOString(),{data:E,error:j}=await z.from("emotions").select("id").eq("user_id",e).gte("created_at",x).lte("created_at",k).limit(1).maybeSingle();return j?(console.error("    :",j),!1):E!==null}catch(_){return console.error("     :",_),!1}},[e]);return{emotions:s,loading:i,error:c,fetchEmotions:d,addEmotion:f,updateEmotion:h,deleteEmotion:w,getEmotionByDate:p,getEmotionById:b,checkTodayEmotion:y,checkTodayPrivateEmotion:v,hasTodayEmotion:g}}const es=[{code:"JOY",label:"",emoji:""},{code:"CALM",label:"",emoji:""},{code:"ANXIOUS",label:"",emoji:""},{code:"BLUE",label:"",emoji:""},{code:"ANGER",label:"",emoji:""},{code:"TIRED",label:"",emoji:""},{code:"EXCITED",label:"",emoji:""},{code:"GROWTH",label:"",emoji:""},{code:"PROUD",label:"",emoji:""},{code:"COMPLEX",label:"",emoji:""}];es.reduce((t,e)=>(t[e.code]=e,t),{});const xh="authFlowType";function ii(t){const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`}function Qa(t){return new Date(`${t}T00:00:00`)}function kh(t,e){const r=new Date(t);return r.setDate(r.getDate()+e),r}function TS(t){const e=new Date(t),n=(e.getDay()+6)%7;return e.setDate(e.getDate()-n),ii(e)}function RS(t){return Math.max(0,Math.min(100,Math.round(t)))}function Eh(){const[t]=du(),{isGuest:e,session:r,user:n}=Ye(),s=Nt(),{flower:o,feedSummary:i,seedName:a,loading:c,refetch:u}=wp((n==null?void 0:n.id)||null),{emotions:d,loading:f,hasTodayEmotion:h,fetchEmotions:w,deleteEmotion:p}=bu({userId:(n==null?void 0:n.id)||null}),[b,y]=S.useState(!1),[v,g]=S.useState(!1),m=t.get("guest")==="1"||e;S.useEffect(()=>{m&&!r?s.banner({level:"info",message:" . /     .",dismissible:!0}):s.dismissBanner("")},[m,r,s]),S.useEffect(()=>{if(!r||!n)return;const R=te.getItem(xh);R&&(C.log("Home: /  ",{authFlowType:R}),R==="SIGNUP"?s.success(" ,  ? ",""):R==="LOGIN"&&s.success(" !     ",""),te.removeItem(xh))},[r,n,s]);const _=S.useMemo(()=>ii(new Date),[]),x=S.useMemo(()=>Qa(_),[_]),k=S.useMemo(()=>TS(x),[x]),E=S.useMemo(()=>{if(m||!n||c){const A=Qa(k);return Array.from({length:7},(I,V)=>({date:ii(kh(A,V)),emoji:"",label:void 0,note:void 0,recordId:void 0,imageUrl:void 0}))}const R=Qa(k);return Array.from({length:7},(A,I)=>{const V=ii(kh(R,I)),re=d.filter(U=>(U.emotion_date||new Date(U.created_at).toISOString().split("T")[0])===V).sort((U,$)=>U.created_at>$.created_at?-1:1);if(!re.length)return{date:V,emoji:"",label:void 0,note:void 0,recordId:void 0,imageUrl:void 0};const T=re[0],L=es.find(U=>U.label===T.main_emotion);return{date:V,emoji:(L==null?void 0:L.emoji)||"",label:(L==null?void 0:L.label)||T.main_emotion,note:T.content,imageUrl:T.image_url||void 0,recordId:T.id}})},[k,d,n,m,c]),j=S.useMemo(()=>{if(m||!n)return 0;const R=(o==null?void 0:o.growth_percent)||0;return RS(R)},[o,n,m]);S.useEffect(()=>{o&&console.log("[Home] flower state :",{flowerId:o.id,growthPercent:o.growth_percent,isBloomed:o.is_bloomed,calculatedGrowthPct:j})},[o,j]);const N=S.useMemo(()=>{if(m||!n)return 0;const R=(o==null?void 0:o.growth_percent)||0;return R>=100?5:R>=70?4:R>=50?3:R>=30?2:R>=10?1:0},[o,n,m]),P=S.useMemo(()=>{if(m||!n||f)return{totalDays:30,recordedDays:0};const R=new Date,A=new Date(R);A.setDate(A.getDate()-30);const I=d.filter(re=>new Date(re.created_at)>=A);return{totalDays:30,recordedDays:new Set(I.map(re=>new Date(re.created_at).toISOString().split("T")[0])).size}},[d,n,m,f]);S.useEffect(()=>{if(m||!n||v){(m||!n)&&y(!1);return}(async()=>{g(!0);try{const A=await h();y(A)}catch(A){console.error("   :",A),y(!1)}finally{g(!1)}})()},[n,m,h]),S.useEffect(()=>{if(m||!n||v)return;const R=setTimeout(async()=>{try{const A=await h();y(A)}catch(A){console.error("   :",A)}},300);return()=>clearTimeout(R)},[d,n,m,h,v]);const M=S.useMemo(()=>m||!n?!1:b,[b,n,m]),X=S.useMemo(()=>m||!n?0:i.postCount||0,[i,n,m]);return l.jsxs(Rr,{hideHeader:!0,children:[l.jsx(hS,{}),m&&!r&&l.jsx("div",{style:{background:"linear-gradient(180deg, #F0FFFA, #E5FAF4)",border:"1px solid #CDEAE1",borderRadius:18,padding:"12px 16px",marginBottom:16,fontSize:13,color:"#144E43",textAlign:"center"},children:"  :        ."}),c&&!m&&l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px 16px",fontSize:14,color:"var(--ms-ink-soft)"},children:[l.jsx("span",{style:{fontSize:24,marginRight:8,animation:"spin 1s linear infinite"},children:""}),"  ..."]}),!c&&l.jsxs(l.Fragment,{children:[l.jsx(jS,{growthPct:j,bloomLevel:N,seedName:a||" ",totalDays:P.totalDays,recordedDays:P.recordedDays,todayMessage:N>=5?"!   ":N>=3?"   ":"  :        "}),l.jsx(fS,{todayLogged:M,todayDate:_}),l.jsx(vS,{weekSummary:E,weekStart:k,todayDate:_,onDeleteRecord:async R=>{if(n){console.log("[Home]   :",{recordId:R,userId:n.id});try{await p(R),await w(),await u(),s.success(" ",""),console.log("[Home]   :",{recordId:R})}catch(A){throw console.error("[Home]   :",{recordId:R,error:A,errorMessage:A instanceof Error?A.message:String(A)}),A}}}}),l.jsx(CS,{feedCount:X,likeSum:i.likeSum})]})]})}function ua(){const{session:t,isGuest:e}=Ye(),r=Nt(),n=Re();return{requireAuthForAction:S.useCallback((o,i,a)=>{if(t&&!e){i();return}(a==null?void 0:a.useModal)!==!1?r.modal({title:",   ? ",message:(a==null?void 0:a.customMessage)||" ,      .",confirmLabel:"/ ",cancelLabel:" ",onConfirm:()=>{n("/onboarding",{replace:!0})}}):r.warning("  ","")},[t,e,r,n])}}const Ls="emotion-images",OS=10*1024*1024;async function AS(t,e){var r,n,s,o;if(t.size>OS)return{url:null,error:new Error("10MB     .")};if(!t.type.startsWith("image/"))return{url:null,error:new Error("    .")};try{const i=t.name.split(".").pop()||"jpg",c=`${`${e}/${crypto.randomUUID()}.${i}`}`,{data:u,error:d}=await z.storage.from(Ls).upload(c,t,{cacheControl:"3600",upsert:!1});if(d){console.error("[uploadEmotionImage]   :",{error:d,code:d.statusCode,message:d.message,errorCode:d.error});let h=d.message||"  .";throw(r=d.message)!=null&&r.includes("bucket")||(n=d.message)!=null&&n.includes("")||d.statusCode===404?(h=`Storage  '${Ls}'     . Supabase Dashboard  . (create_emotion_images_bucket.sql )`,console.error("[uploadEmotionImage]    :",{error:d.message,statusCode:d.statusCode,hint:"Supabase Dashboard > Storage emotion-images   "})):(d.statusCode===403||(s=d.message)!=null&&s.includes("permission")||(o=d.message)!=null&&o.includes(""))&&(h="   .   .",console.error("[uploadEmotionImage]    :",{error:d.message,statusCode:d.statusCode})),new Error(h)}console.log("[uploadEmotionImage]   :",{uploadData:u});const{data:{publicUrl:f}}=z.storage.from(Ls).getPublicUrl(c);return console.log("[uploadEmotionImage] Public URL  :",{publicUrl:f,filePath:c}),{url:f,error:null}}catch(i){const a=i instanceof Error?i:new Error("  .");return console.error("[uploadEmotionImage]    :",{error:i,errorMessage:a.message,errorStack:a.stack}),{url:null,error:a}}}async function IS(t){try{const e=t.split("/"),r=e.findIndex(o=>o===Ls);if(r===-1){console.warn(" URL     :",t);return}const n=e.slice(r+1).join("/"),{error:s}=await z.storage.from(Ls).remove([n]);s&&console.error("  :",s)}catch(e){console.error("   :",e)}}class De extends Error{constructor(r){super(r.message);Me(this,"code");Me(this,"details");Me(this,"hint");Me(this,"cause");Me(this,"statusCode");Me(this,"userId");Me(this,"resourceId");this.name="AppError",this.code=r.code,this.details=r.details,this.hint=r.hint,this.cause=r.cause,this.statusCode=r.statusCode,this.userId=r.userId,this.resourceId=r.resourceId,r.cause instanceof Error&&(this.stack=r.cause.stack)}static fromSupabaseError(r,n){const s=r.code||"UNKNOWN_ERROR",o=r.statusCode;let i="DATABASE_ERROR";return s==="PGRST301"||o===401?i="AUTH_REQUIRED":s==="PGRST301"||o===403?i="PERMISSION_DENIED":s==="PGRST116"||o===404?i="NOT_FOUND":(s==="23505"||s==="23503"||s==="23502")&&(i="VALIDATION_ERROR"),new De({code:i,message:r.message||"    .",details:r.details,hint:r.hint,statusCode:o,userId:n==null?void 0:n.userId,resourceId:n==null?void 0:n.resourceId})}static fromNetworkError(r,n){return r instanceof TypeError&&r.message.includes("fetch")?new De({code:"NETWORK_ERROR",message:"  .",details:r.message,cause:r,userId:n==null?void 0:n.userId}):new De({code:"NETWORK_ERROR",message:"  .",details:r instanceof Error?r.message:String(r),cause:r,userId:n==null?void 0:n.userId})}static fromStorageError(r,n){let s="STORAGE_ERROR",o=r.message||"  .";return r.statusCode===404?(s="STORAGE_ERROR",o=`Storage  '${n==null?void 0:n.bucket}'     . Supabase Dashboard  .`):r.statusCode===403&&(s="PERMISSION_DENIED",o="   .   ."),new De({code:s,message:o,statusCode:r.statusCode,userId:n==null?void 0:n.userId,resourceId:n==null?void 0:n.filePath})}}function Or(t){return{data:t,error:null}}function Ut(t){return{data:null,error:t}}const DS=!1;class LS{shouldLog(e){return DS}formatMessage(e,r,n){const s=[e,r];if(n){const o=Object.entries(n).filter(([i,a])=>a!=null).map(([i,a])=>`${i}=${JSON.stringify(a)}`).join(", ");o&&s.push(`[${o}]`)}return s.join(" ")}log(e,r){this.shouldLog("log")&&console.log(this.formatMessage("[LOG]",e,r))}info(e,r){this.shouldLog("info")&&console.info(this.formatMessage("[INFO]",e,r))}warn(e,r){this.shouldLog("warn")&&console.warn(this.formatMessage("[WARN]",e,r))}error(e,r){if(!this.shouldLog("error"))return;const n={...r};(r==null?void 0:r.error)instanceof Error&&(n.errorMessage=r.error.message,n.errorStack=r.error.stack),console.error(this.formatMessage("[ERROR]",e,n))}debug(e,r){this.shouldLog("debug")&&console.debug(this.formatMessage("[DEBUG]",e,r))}}const Ce=new LS;async function Su(t){var e,r;try{const{data:n,error:s}=await z.from("flowers").select("*").eq("user_id",t).eq("is_bloomed",!1).maybeSingle();if(s&&s.code!=="PGRST116")return Ce.error("    ",{userId:t,operation:"ensureFlowerRow",error:De.fromSupabaseError(s,{userId:t,operation:"ensureFlowerRow"})}),Ut(De.fromSupabaseError(s,{userId:t,operation:"ensureFlowerRow"}));if(n)return Ce.log("   ",{userId:t,operation:"ensureFlowerRow",flowerId:n.id,growthPercent:n.growth_percent}),Or(n);Ce.log("   ,    ",{userId:t,operation:"ensureFlowerRow"});const{data:o,error:i}=await z.from("flowers").insert({user_id:t,flower_type:"seed",growth_percent:0,is_bloomed:!1}).select().single();if(i){if(i.code==="23505"||(e=i.message)!=null&&e.includes("unique")||(r=i.message)!=null&&r.includes("duplicate")){Ce.warn("   ,  row ",{userId:t,operation:"ensureFlowerRow",error:i.message});const a=await Su(t);return a.error?Ut(a.error):Or(a.data)}return Ce.error("  ",{userId:t,operation:"ensureFlowerRow",error:De.fromSupabaseError(i,{userId:t,operation:"ensureFlowerRow"})}),Ut(De.fromSupabaseError(i,{userId:t,operation:"ensureFlowerRow"}))}return Ce.log("   ",{userId:t,operation:"ensureFlowerRow",flowerId:o.id,growthPercent:o.growth_percent}),Or(o)}catch(n){return Ce.error(" ",{userId:t,operation:"ensureFlowerRow",error:n}),Ut(De.fromNetworkError(n,{userId:t,operation:"ensureFlowerRow"}))}}async function _p(t,e){try{const{data:r,error:n}=await z.from("emotions").select("emotion_date").eq("user_id",t).lte("emotion_date",e).order("emotion_date",{ascending:!1}).limit(30);if(n)return Ce.error("    ",{userId:t,operation:"getConsecutiveDays",endDate:e,error:De.fromSupabaseError(n,{userId:t,operation:"getConsecutiveDays"})}),Ut(De.fromSupabaseError(n,{userId:t,operation:"getConsecutiveDays"}));if(!r||r.length===0)return Or(0);const s=[...new Set(r.map(c=>c.emotion_date))].sort((c,u)=>new Date(u).getTime()-new Date(c).getTime()),o=new Date(e);o.setHours(0,0,0,0);let i=0,a=new Date(o);for(let c=0;c<30;c++){const u=a.toISOString().split("T")[0];if(s.includes(u))i++,a.setDate(a.getDate()-1);else break}return Ce.log("    ",{userId:t,operation:"getConsecutiveDays",endDate:e,consecutiveDays:i,uniqueDatesCount:s.length}),Or(i)}catch(r){return Ce.error("      ",{userId:t,operation:"getConsecutiveDays",endDate:e,error:r}),Ut(De.fromNetworkError(r,{userId:t,operation:"getConsecutiveDays"}))}}async function hc(t,e,r,n=!1){try{const s=await Su(t);if(s.error)return Ce.error("flowers row / ",{userId:t,operation:"updateFlowerGrowth",error:s.error}),Ut(s.error);const o=s.data;if(!r)return Ce.log("UPDATE  -   ",{userId:t,operation:"updateFlowerGrowth",emotionDate:e,currentGrowthPoints:o.growth_percent}),Or(o);const i=n?10:5,a=o.growth_percent,c=Math.min(100,a+i),u=await _p(t,e);u.error&&Ce.error("    ",{userId:t,operation:"updateFlowerGrowth",error:u.error});const d=u.error?0:u.data,f=d>=20&&!o.is_bloomed,h=(c>=100||f)&&!o.is_bloomed,w={growth_percent:c,updated_at:new Date().toISOString()};h&&(w.is_bloomed=!0,w.bloomed_at=new Date().toISOString(),console.log("[updateFlowerGrowth]  ! :",{userId:t,growthPoints:c,consecutiveDays:d,reason:c>=100?"100pt ":"20  "}));const{data:p,error:b}=await z.from("flowers").update(w).eq("user_id",t).select().single();if(b)return Ce.error("flowers  ",{userId:t,operation:"updateFlowerGrowth",emotionDate:e,error:De.fromSupabaseError(b,{userId:t,operation:"updateFlowerGrowth"})}),Ut(De.fromSupabaseError(b,{userId:t,operation:"updateFlowerGrowth"}));Ce.log("  ",{userId:t,operation:"updateFlowerGrowth",emotionDate:e,oldPoints:a,newPoints:c,pointsAdded:i,isPublic:n,consecutiveDays:d,isBloomed:p.is_bloomed});try{const{createNotification:y}=await Bi(async()=>{const{createNotification:g}=await Promise.resolve().then(()=>rS);return{createNotification:g}},void 0);let v=null;c>=100&&h?v="growth_level_5":c>=70&&a<70?v="growth_level_4":c>=50&&a<50?v="growth_level_3":c>=30&&a<30?v="growth_level_2":c>=10&&a<10&&(v="growth_level_1"),v&&(await y(t,v,{growthPoints:c,oldPoints:a,consecutiveDays:d}),Ce.log("    ",{userId:t,operation:"updateFlowerGrowth",growthLevelType:v,growthPoints:c,oldPoints:a,consecutiveDays:d}))}catch(y){Ce.error("   ",{userId:t,operation:"updateFlowerGrowth",error:y})}return Or(p)}catch(s){return Ce.error(" ",{userId:t,operation:"updateFlowerGrowth",emotionDate:e,isNewRecord:r,error:s}),Ut(De.fromNetworkError(s,{userId:t,operation:"updateFlowerGrowth"}))}}async function bp(t){try{const{data:e,error:r}=await z.from("flowers").select("*").eq("user_id",t).eq("is_bloomed",!0).order("bloomed_at",{ascending:!1});return r?(Ce.error("    ",{userId:t,operation:"fetchBloomedFlowers",error:De.fromSupabaseError(r,{userId:t,operation:"fetchBloomedFlowers"})}),Ut(De.fromSupabaseError(r,{userId:t,operation:"fetchBloomedFlowers"}))):(Ce.log("    ",{userId:t,operation:"fetchBloomedFlowers",count:(e||[]).length}),Or(e||[]))}catch(e){return Ce.error("      ",{userId:t,operation:"fetchBloomedFlowers",error:e}),Ut(De.fromNetworkError(e,{userId:t,operation:"fetchBloomedFlowers"}))}}const US=Object.freeze(Object.defineProperty({__proto__:null,ensureFlowerRow:Su,fetchBloomedFlowers:bp,getConsecutiveDays:_p,updateFlowerGrowth:hc},Symbol.toStringTag,{value:"Module"})),$S=[{id:"daily",emoji:"",label:""},{id:"worry",emoji:"",label:""},{id:"love",emoji:"",label:""},{id:"work",emoji:"",label:""},{id:"humor",emoji:"",label:""},{id:"growth",emoji:"",label:""},{id:"selfcare",emoji:"",label:""}];function MS(){const t=Re(),{user:e}=Ye(),r=Nt(),{requireAuthForAction:n}=ua(),{emotions:s,addEmotion:o,updateEmotion:i,fetchEmotions:a,checkTodayPrivateEmotion:c,getEmotionById:u}=bu({userId:(e==null?void 0:e.id)||null}),{refetch:d}=wp((e==null?void 0:e.id)||null),f=S.useCallback(()=>{window.history.length>1?t(-1):t("/")},[t]),[h]=du(),w=h.get("id"),p=!!w,b=S.useMemo(()=>{const B=new Date,je=B.getFullYear(),ye=String(B.getMonth()+1).padStart(2,"0"),Ue=String(B.getDate()).padStart(2,"0");return`${je}-${ye}-${Ue}`},[]),[y,v]=S.useState(null),[g,m]=S.useState(""),[_,x]=S.useState(!1),[k,E]=S.useState([]),[j,N]=S.useState([]),[P,M]=S.useState(!1),[X,R]=S.useState(!1),[A,I]=S.useState(b);S.useEffect(()=>{_||E([])},[_]);function V(B){v(B)}function re(B){const je=Array.from(B.target.files||[]),ye=2,Ue=j.length;if(Ue>=ye){r.warning("  2   ",""),B.currentTarget.value="";return}const _t=[],ut=ye-Ue;je.forEach(($e,Mr)=>{if(_t.length>=ut){Mr===ut&&r.warning(`  ${ye}   . ${ut} .`,"");return}if(!$e.type.startsWith("image/"))return;if($e.size>10*1024*1024){r.warning("10MB     ","");return}const Br=URL.createObjectURL($e);_t.push({id:`${$e.name}-${$e.size}-${Date.now()}`,file:$e,url:Br})}),_t.length&&N($e=>[...$e,..._t]),B.currentTarget.value=""}function T(B){N(je=>{const ye=je.find(Ue=>Ue.id===B);return ye!=null&&ye.file&&URL.revokeObjectURL(ye.url),je.filter(Ue=>Ue.id!==B)})}S.useEffect(()=>()=>{j.forEach(B=>{B.file&&URL.revokeObjectURL(B.url)})},[]);function L(B){E(je=>je[0]===B?[]:[B])}function U(B){x(B),e!=null&&e.id&&Wn(e.id,"record_visibility_changed",{isPublic:B}).catch(()=>{})}S.useEffect(()=>{!p||!w||!e||(console.log("[Record]   :",{editingRecordId:w,userId:e.id}),u(w).then(B=>{var Ue;if(!B){console.error("[Record]    :",{editingRecordId:w,userId:e.id}),r.warning("    ",""),f();return}console.log("[Record]   :",{id:B.id,mainEmotion:B.main_emotion,content:((Ue=B.content)==null?void 0:Ue.substring(0,20))+"..."});const je=es.find(_t=>_t.label===B.main_emotion);v(je??null),m(B.content),x(B.is_public??!1),E(B.category?[B.category]:[]);const ye=B.emotion_date||new Date(B.created_at).toISOString().split("T")[0];I(ye),B.image_url?N([{id:"existing",file:null,url:B.image_url}]):N([])}).catch(B=>{console.error("[Record]    :",{editingRecordId:w,error:B,errorMessage:B instanceof Error?B.message:String(B)}),r.error("    ",""),f()}))},[w,p,f,e,u,r]);const $=_,W=!!(y&&g.trim().length>=5),Q=!_||k.length>0,H=W&&Q,he=_&&k.length>0;async function Z(){!H||!y||n("save_record",async()=>{var B,je,ye,Ue,_t,ut,$e,Mr,Br,cr,fo,mo,go;if(e){if(!_&&!p){const F=new Date(A).toISOString().split("T")[0];if(await c(F)){r.warning("        ",""),M(!1),R(!1);return}}M(!0),R(j.some(F=>F.file!==null));try{let F=null;const ie=j.find(le=>le.file!==null);if(ie!=null&&ie.file){console.log("[Record]   :",{fileName:ie.file.name,fileSize:ie.file.size,userId:e.id});const le=await AS(ie.file,e.id);if(le.error){console.error("[Record]   :",{error:le.error,message:le.error.message}),r.error(le.error.message||"  ",""),M(!1),R(!1);return}if(!le.url||le.url.trim()===""){console.error("[Record]    URL :",{uploadResult:le}),r.error("   URL  ",""),M(!1),R(!1);return}if(F=le.url,console.log("[Record]   :",{imageUrl:F,urlLength:F.length}),p&&w){const ne=s.find(zt=>zt.id===w);ne!=null&&ne.image_url&&ne.image_url!==F&&await IS(ne.image_url)}}else j.length>0&&j[0].url&&!j[0].file?(F=j[0].url,console.log("[Record]   URL :",{imageUrl:F,urlLength:F.length})):console.log("[Record]  :",{photosLength:j.length,hasFile:j.some(le=>le.file!==null),hasUrl:j.some(le=>le.url&&!le.file)});R(!1);const ls=g.trim();if(ls.length<5){r.warning(" 5  ",""),M(!1),R(!1);return}const ae={emotion_type:y.label,content:ls,emotion_date:A,is_public:_||null,category:he&&k.length>0?k[0]:null,image_url:F&&F.trim()!==""?F:null};if(console.log("[Record]  payload :",{emotion_type:ae.emotion_type,emotion_type_length:(B=ae.emotion_type)==null?void 0:B.length,content:ae.content,content_length:ae.content.length,emotion_date:ae.emotion_date,is_public:ae.is_public,category:ae.category,image_url:ae.image_url,image_url_length:(je=ae.image_url)==null?void 0:je.length,has_image:!!ae.image_url,payload_keys:Object.keys(ae),payload_values:Object.values(ae)}),p&&w){const{data:le,error:ne}=await i(w,ae);if(ne){r.error("  .    .","");return}if(le){let zt=!1;try{const K=A||new Date().toISOString().split("T")[0],Wt=await hc(e.id,K,!1,!1);Wt&&(zt=!0,console.log("[Record]   flowers   (  ):",{userId:e.id,growthPercent:Wt.growth_percent,emotionDate:K}))}catch(K){console.error("[Record]   flowers   :",{error:K,errorMessage:K instanceof Error?K.message:String(K),userId:e.id})}try{await d(),console.log("[Record]     refetch  (flowers  ):",{flowerUpdated:zt,userId:e.id})}catch(K){console.error("[Record]     refetch :",{error:K,errorMessage:K instanceof Error?K.message:String(K),userId:e.id})}try{await Wn(e.id,"record_updated",{recordId:le.id}),typeof window.__refreshNotifications=="function"&&window.__refreshNotifications()}catch(K){console.error("[Record]    :",{error:K,errorMessage:K instanceof Error?K.message:String(K),userId:e.id})}r.success("    .",""),await a(),f()}}else{console.log("[Record] addEmotion  ",{payload:ae,userId:e==null?void 0:e.id,hasUser:!!e});const{data:le,error:ne}=await o(ae);if(ne){console.error("[Record] addEmotion :",{error:ne,errorMessage:ne.message,errorCode:ne==null?void 0:ne.code,errorDetails:ne==null?void 0:ne.details,errorHint:ne==null?void 0:ne.hint,payload:{...ae,content_length:ae.content.length,has_image:!!ae.image_url},userId:e==null?void 0:e.id,supabaseError:ne==null?void 0:ne.supabaseError,statusCode:ne==null?void 0:ne.statusCode}),((ne==null?void 0:ne.code)==="400"||(ne==null?void 0:ne.statusCode)===400)&&console.error("[Record] 400 Bad Request  - payload  :",{payload:ae,content:ae.content,content_length:ae.content.length,emotion_type:ae.emotion_type,image_url:ae.image_url,is_public:ae.is_public,category:ae.category,emotion_date:ae.emotion_date}),r.error(ne.message||"  .    .",""),M(!1),R(!1);return}if(!le){console.error("[Record] addEmotion  data null:",{payload:ae,userId:e==null?void 0:e.id,error:ne}),r.error("    .","");return}console.log("[Record] addEmotion :",{recordId:le.id,mainEmotion:le.main_emotion,userId:le.user_id});let zt=!1;try{const K=await hc(e.id,A,!0,he||_);K?(zt=!0,console.log("[Record] flowers   :",{userId:e.id,growthPercent:K.growth_percent,isBloomed:K.is_bloomed,emotionDate:A})):console.warn("[Record] flowers    (null ):",{userId:e.id,emotionDate:A})}catch(K){console.error("[Record] flowers    :",{error:K,errorMessage:K instanceof Error?K.message:String(K),userId:e.id,emotionDate:A})}try{console.log("[Record]   refetch :",{flowerUpdated:zt,userId:e.id}),await d(),console.log("[Record]   refetch  (flowers  ):",{flowerUpdated:zt,userId:e.id,timestamp:new Date().toISOString()})}catch(K){console.error("[Record]   refetch :",{error:K,errorMessage:K instanceof Error?K.message:String(K),errorCode:K==null?void 0:K.code,errorDetails:K==null?void 0:K.details,errorHint:K==null?void 0:K.hint,userId:e.id})}try{const K=s.length===0;let Wt,dn;K?(Wt="first_record",dn="  .    ."):he||_?(Wt="record_saved",dn="  .     ."):(Wt="record_saved",dn="     ."),await Wn(e.id,Wt,{recordId:le.id,isPublic:_,isSharedToForest:he},{message:dn}),console.log("[Record]     :",{userId:e.id,recordId:le.id,type:Wt,isFirstRecord:K,isPublic:_,isSharedToForest:he}),typeof window.__refreshNotifications=="function"&&window.__refreshNotifications()}catch(K){console.error("[Record]     :",{error:K,errorMessage:K instanceof Error?K.message:String(K),errorCode:K==null?void 0:K.code,errorDetails:K==null?void 0:K.details,errorHint:K==null?void 0:K.hint,userId:e.id})}he||_?r.success("  .     .",""):r.success("     .",""),await a(),v(null),m(""),N([]),E([]),t("/")}}catch(F){console.error("[Record]   -  :",{error:F,errorMessage:F instanceof Error?F.message:String(F),errorStack:F instanceof Error?F.stack:void 0,errorName:F instanceof Error?F.name:void 0,userId:e==null?void 0:e.id,isEditing:p,supabaseError:F==null?void 0:F.supabaseError,code:F==null?void 0:F.code,statusCode:F==null?void 0:F.statusCode,details:F==null?void 0:F.details,hint:F==null?void 0:F.hint,message:F==null?void 0:F.message,isNetworkError:F instanceof Error&&(((ye=F.message)==null?void 0:ye.includes("fetch"))||((Ue=F.message)==null?void 0:Ue.includes("network"))||((_t=F.message)==null?void 0:_t.includes("Failed to fetch"))||((ut=F.message)==null?void 0:ut.includes("400"))),isRLSError:(F==null?void 0:F.code)==="42501"||(($e=F==null?void 0:F.message)==null?void 0:$e.includes("permission denied"))||((Mr=F==null?void 0:F.message)==null?void 0:Mr.includes("RLS"))||((Br=F==null?void 0:F.message)==null?void 0:Br.includes("row-level security")),errorObject:F instanceof Error?{name:F.name,message:F.message,stack:F.stack}:F});let ie=" .     .";F instanceof Error&&((cr=F.message)!=null&&cr.includes("400")||(F==null?void 0:F.statusCode)===400?ie="   .   .":(fo=F.message)!=null&&fo.includes("network")||(mo=F.message)!=null&&mo.includes("fetch")?ie="  .":((F==null?void 0:F.code)==="42501"||(go=F.message)!=null&&go.includes("permission"))&&(ie="  .   .")),r.error(ie,"")}finally{M(!1),R(!1)}}},{customMessage:"      ."})}const Pt=y?` ${y.label}    .`:"    .",da=p?" ":"  ",Xe=p?"    .":"  ,   .",ho=p?" ":"";return l.jsx(Rr,{hideHeader:!0,children:l.jsxs("div",{className:"record-page",children:[l.jsxs("div",{className:"page-hero",children:[l.jsx("div",{className:"page-hero-icon","aria-hidden":"true",children:""}),l.jsxs("div",{children:[l.jsx("h1",{className:"page-hero-title",children:da}),l.jsx("p",{className:"page-hero-desc",children:Xe})]})]}),l.jsxs("section",{className:"ms-section",children:[l.jsxs("div",{className:"ms-section-label",children:[" ",l.jsx("span",{className:"helper",children:"    ."})]}),l.jsxs("div",{className:"ms-today-row",children:[l.jsx("div",{className:"ms-today-label",children:p?"  ":" "}),l.jsx("div",{className:"ms-today-date",children:A})]})]}),l.jsxs("section",{className:"ms-section",children:[l.jsxs("div",{className:"ms-section-label",children:["  ?",l.jsx("span",{className:"helper",children:"    1  ."})]}),l.jsx("div",{className:"ms-emotion-grid",children:es.map(B=>{const je=(y==null?void 0:y.code)===B.code;return l.jsxs("button",{type:"button",className:`ms-emotion-btn ${je?"selected":""}`,title:B.label,onClick:()=>V(B),children:[l.jsx("div",{className:"ms-emotion-emoji",children:B.emoji}),l.jsx("div",{className:"ms-emotion-label",children:B.label})]},B.code)})}),l.jsx("div",{className:"ms-emotion-helper",children:Pt})]}),l.jsxs("section",{className:"ms-section",children:[l.jsxs("div",{className:"ms-section-label",children:["   ",l.jsx("span",{className:"helper",children:"5    ."})]}),l.jsx("textarea",{className:"ms-textarea",maxLength:1e3,value:g,placeholder:` ,  ,     .
:       .`,onChange:B=>m(B.target.value)}),l.jsxs("div",{className:"ms-textarea-count",children:[g.length," / 1000"]}),l.jsxs("div",{className:"ms-photo-row",children:[l.jsxs("div",{className:"ms-photo-text",children:[l.jsx("div",{className:"ms-photo-title",children:"  ()"}),l.jsx("div",{className:"ms-photo-helper",children:"      . (JPG, PNG / 10MB  /  2)"})]}),l.jsxs("label",{className:"ms-photo-upload",children:[l.jsx("span",{children:"  "}),l.jsx("input",{type:"file",className:"ms-photo-hidden-input",accept:"image/*",multiple:!0,onChange:re})]})]}),l.jsx("div",{className:"ms-photo-preview-list",children:j.map(B=>l.jsx("div",{className:"ms-photo-thumb",style:{backgroundImage:`url(${B.url})`},children:l.jsx("button",{type:"button",className:"ms-photo-thumb-remove",onClick:()=>T(B.id),"aria-label":" ",children:""})},B.id))})]}),l.jsxs("section",{className:"ms-section",children:[l.jsxs("div",{className:"ms-section-label",children:[" ",l.jsx("span",{className:"helper",children:"    ."})]}),l.jsxs("div",{className:"ms-toggle-row",children:[l.jsxs("div",{className:"ms-toggle-text",children:[l.jsx("div",{className:"ms-toggle-title",children:_?" ":" "}),l.jsx("div",{className:"ms-toggle-sub",children:_?"       .":"     ."})]}),l.jsxs("label",{className:"ms-switch",children:[l.jsx("input",{type:"checkbox",checked:_,onChange:B=>U(B.target.checked)}),l.jsx("span",{className:"ms-switch-slider"})]})]}),l.jsx("div",{className:"ms-checkbox-row",style:{marginTop:8},children:l.jsx("span",{children:"     "})})]}),$&&l.jsxs("section",{className:"ms-section",children:[l.jsxs("div",{className:"ms-section-label",children:[" ",l.jsx("span",{className:"helper",children:"     ."})]}),l.jsx("div",{className:"ms-chip-row",children:$S.map(B=>{const je=k.includes(B.id);return l.jsxs("button",{type:"button",className:`ms-chip ${je?"selected":""}`,onClick:()=>L(B.id),children:[l.jsx("span",{style:{marginRight:6},children:B.emoji}),B.label]},B.id)})})]}),l.jsx("button",{className:"ms-btn ms-btn-primary",onClick:Z,disabled:!H||P,children:X?"  ...":P?" ":ho})]})})}function BS({className:t}){const[e,r]=S.useState(!1),n=Re(),{requireAuthForAction:s}=ua(),o=S.useRef(null);S.useEffect(()=>{if(!e)return;const u=d=>{o.current&&(o.current.contains(d.target)||r(!1))};return document.addEventListener("pointerdown",u),()=>document.removeEventListener("pointerdown",u)},[e]);const i=()=>r(u=>!u),a=u=>{n(u),r(!1)},c=()=>{s("write_post",()=>{a("/record")},{customMessage:"      ."})};return l.jsxs("div",{ref:o,className:`fab-menu ${e?"open":""} ${t??""}`.trim(),"aria-expanded":e,children:[l.jsxs("div",{className:"fab-actions",children:[l.jsxs("button",{type:"button",className:"fab-action-btn",style:{"--fab-order":2},onClick:()=>a("/forest/my-posts"),"aria-label":"   ",children:[l.jsx("span",{className:"fab-action-icon","aria-hidden":"true",children:""}),l.jsx("span",{className:"fab-action-label",children:"  "})]}),l.jsxs("button",{type:"button",className:"fab-action-btn",style:{"--fab-order":1},onClick:c,"aria-label":" ",children:[l.jsx("span",{className:"fab-action-icon","aria-hidden":"true",children:""}),l.jsx("span",{className:"fab-action-label",children:" "})]})]}),l.jsx("button",{type:"button",className:`fab-main ${e?"open":""}`,onClick:i,"aria-label":e?" ":" ",children:l.jsx("span",{"aria-hidden":"true",children:""})})]})}function FS(t){const[e,r]=S.useState({status:"loading",posts:[],errorMessage:null}),[n,s]=S.useState("latest"),[o,i]=S.useState(null),a=S.useCallback(async()=>{var p,b,y,v,g,m;r(_=>({..._,status:"loading",errorMessage:null}));try{const _="https://lbmtccfncnqdsrrtsspt.supabase.co",x="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxibXRjY2ZuY25xZHNycnRzc3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3OTcwMzQsImV4cCI6MjA3OTM3MzAzNH0.eUhOIwcCxFoqFysWMLpOhReXaVnyKfOVifiug_NTTSY";if(!_||!x||_.includes("placeholder")){const M="Supabase   . VITE_SUPABASE_URL VITE_SUPABASE_ANON_KEY .";console.error("[useCommunity] fetchPosts error - ENV ",{hasUrl:!!_,hasKey:!!x,url:_}),C.err("useCommunity: Supabase ENV ",{hasUrl:!!_,hasKey:!!x}),r({status:"error",posts:[],errorMessage:M});return}C.log("useCommunity: fetchPosts ",{userId:t||"guest",sortType:n,selectedCategory:o});let k=z.from("community_posts").select("*").eq("is_public",!0);o&&o!=="BEST"&&(k=k.eq("category",o)),n==="best"?k=k.order("like_count",{ascending:!1}):k=k.order("created_at",{ascending:!1}),C.log("useCommunity: Supabase  ",{table:"community_posts",filters:{is_public:!0,category:o},sort:n});let{data:E,error:j}=await k;if(j){console.error("[useCommunity] fetchPosts error - Supabase ",j),C.err("useCommunity: Supabase  ",{code:j.code,message:j.message,details:j.details,hint:j.hint});const M=j.code==="PGRST301"||j.code==="42501"||((p=j.message)==null?void 0:p.includes("permission"))||((b=j.message)==null?void 0:b.includes("policy"))||((y=j.message)==null?void 0:y.includes("RLS")),X=((v=j.message)==null?void 0:v.includes("Failed to fetch"))||((g=j.message)==null?void 0:g.includes("NetworkError"))||((m=j.message)==null?void 0:m.includes("fetch"));let R="  .";X?R=`  .

:
-    
- Supabase URL  
- CORS  `:M?R=`   .

[ ] RLS  :
CREATE POLICY "Allow public read for public posts" ON community_posts
FOR SELECT USING (is_public = true);`:R=j.message||R,r({status:"error",posts:[],errorMessage:R});return}const N=E||[];if(N.length===0){r({status:"empty",posts:[],errorMessage:null});return}const P=N.map(M=>({...M,profiles:M.profiles||{nickname:"",seed_name:null}}));if(t&&P.length>0){const M=N.map(V=>V.id),{data:X,error:R}=await z.from("community_likes").select("post_id").eq("user_id",t).in("post_id",M);R&&console.error("[FOREST_SUPABASE_ERROR] likes  :",R);const A=new Set((X==null?void 0:X.map(V=>V.post_id))||[]),I=P.map(V=>({...V,is_liked_by_me:A.has(V.id),is_mine:V.user_id===t}));r({status:"success",posts:I,errorMessage:null})}else r({status:"success",posts:P,errorMessage:null})}catch(_){console.error("[useCommunity] fetchPosts error -  ",_),C.err("useCommunity:  ",_);let x="    .";_ instanceof Error?(x=_.message,_.name==="TypeError"&&_.message.includes("fetch")&&(x=`  .

:
-    
- Supabase    
-     `)):typeof _=="string"&&(x=_),r({status:"error",posts:[],errorMessage:x})}},[t,n,o]),c=S.useCallback(async(p,b)=>{if(!t){console.warn("[FOREST] toggleLike: userId . useActionGuard  .");return}try{if(b){const{error:y}=await z.from("community_likes").delete().eq("post_id",p).eq("user_id",t);if(y)throw y;r(v=>({...v,posts:v.posts.map(g=>g.id===p?{...g,is_liked_by_me:!1,like_count:Math.max(0,g.like_count-1)}:g)}))}else{const{error:y}=await z.from("community_likes").insert({post_id:p,user_id:t});if(y)throw y;r(v=>({...v,posts:v.posts.map(g=>g.id===p?{...g,is_liked_by_me:!0,like_count:g.like_count+1}:g)}))}}catch(y){console.error("[FOREST_SUPABASE_ERROR]   :",y)}},[t]),u=S.useCallback(async(p,b,y)=>{if(!t){console.warn("[FOREST] reportPost: userId . useActionGuard  .");return}try{const{error:v}=await z.from("reports").insert({post_id:p,user_id:t,reason:b,details:y});if(v)throw v}catch(v){console.error("  :",v)}},[t]),d=S.useCallback(async p=>{if(!t){console.warn("[FOREST] deletePost: userId . useActionGuard  .");return}try{const{error:b}=await z.from("community_posts").delete().eq("id",p).eq("user_id",t);if(b)throw b;r(y=>({...y,posts:y.posts.filter(v=>v.id!==p)}))}catch(b){throw console.error("[FOREST_SUPABASE_ERROR]   :",b),b}},[t]);S.useEffect(()=>{if(!t){a();return}a();const p=z.channel("community_realtime").on("postgres_changes",{event:"*",schema:"public",table:"community_likes"},()=>{a()}).on("postgres_changes",{event:"*",schema:"public",table:"community_posts"},()=>{a()}).subscribe();return()=>{z.removeChannel(p)}},[a,t]);const f=e.status==="loading",h=e.status==="error"?e.errorMessage:null;return{posts:e.posts,loading:f,error:h,status:e.status,errorMessage:e.errorMessage,sortType:n,selectedCategory:o,setSortType:s,setSelectedCategory:i,fetchPosts:a,toggleLike:c,reportPost:u,deletePost:d}}const zS=["BEST","","","","","","",""],WS=[{label:"",value:"latest"},{label:"",value:"best"}],Ya=["/","/"," ",""];function VS(t){var n,s;const e=es.find(o=>o.label===t.emotion_type),r=t.category||"";return{id:t.id,userId:t.user_id,emotionCode:(e==null?void 0:e.code)||"CALM",emoji:(e==null?void 0:e.emoji)||"",label:(e==null?void 0:e.label)||t.emotion_type||"",content:t.content,imageUrl:t.image_url||void 0,category:r,likeCount:t.like_count,isLikedByMe:t.is_liked_by_me||!1,isMine:t.is_mine||!1,isReported:!1,createdAt:t.created_at,updatedAt:t.updated_at,nickname:((n=t.profiles)==null?void 0:n.nickname)||((s=t.profiles)==null?void 0:s.seed_name)||"",mbti:void 0,recordId:t.emotion_id||void 0,emotionEmoji:(e==null?void 0:e.emoji)||""}}const GS=20;function jh({mode:t="all"}){const e=t==="mine",r=Re(),{user:n}=Ye(),s=Nt(),{requireAuthForAction:o}=ua(),{posts:i,status:a,errorMessage:c,sortType:u,selectedCategory:d,setSortType:f,setSelectedCategory:h,fetchPosts:w,toggleLike:p,reportPost:b,deletePost:y}=FS((n==null?void 0:n.id)||null),[v,g]=S.useState(null),[m,_]=S.useState(null),[x,k]=S.useState(""),E=S.useMemo(()=>i.map(VS),[i]),j=S.useMemo(()=>{let $=E;return d&&($=$.filter(W=>W.category===d)),u==="best"?$=[...$].sort((W,Q)=>Q.likeCount===W.likeCount?new Date(Q.createdAt).getTime()-new Date(W.createdAt).getTime():Q.likeCount-W.likeCount):$=[...$].sort((W,Q)=>new Date(Q.createdAt).getTime()-new Date(W.createdAt).getTime()),e&&($=$.filter(W=>W.isMine)),$},[E,d,u,e]),N=S.useMemo(()=>v?E.find($=>$.id===v)??null:null,[v,E]),P=S.useMemo(()=>e?j.filter($=>$.isMine):j,[j,e]),M=$=>{h($==="BEST"?null:$)},X=$=>f($),R=async $=>{const W=E.find(H=>H.id===$);if(!W)return;const Q=W.isLikedByMe;o("like_post",async()=>{await p($,Q),Q?s.info(" ",""):s.success("  .","")},{customMessage:"     ."})},A=async($,W)=>{m&&o("report_post",async()=>{await b(m,$,W),s.success("  .  .",""),_(null),k("")},{customMessage:"     ."})},I=async $=>{o("delete_post",()=>{s.modal({title:" ",message:"   ?",confirmLabel:"",cancelLabel:"",onConfirm:async()=>{await y($),s.success(" .",""),v===$&&g(null)}})},{customMessage:"     ."})},V=async $=>{var H;const W=`${window.location.origin}/forest/${$.id}`,Q={title:" ",text:$.content,url:W};try{navigator.share?await navigator.share(Q):(H=navigator.clipboard)!=null&&H.writeText&&await navigator.clipboard.writeText(W),setToastMessage("  .")}catch(he){console.error(he),setToastMessage("   .")}},re=$=>{if($.isMine){if($.recordId){g(null),r(`/record?id=${$.recordId}`);return}setToastMessage("       .")}},T=e?"":"",L=e?"   ":"",U=e?"       .":"    .";return l.jsxs(Rr,{hideHeader:!0,children:[l.jsxs("section",{className:"forest-root",children:[l.jsxs("div",{className:"page-hero",children:[l.jsx("div",{className:"page-hero-icon","aria-hidden":"true",children:T}),l.jsxs("div",{children:[l.jsx("h1",{className:"page-hero-title",children:L}),l.jsx("p",{className:"page-hero-desc",children:U})]})]}),l.jsx("div",{className:"forest-tabs",children:zS.map($=>{const W=$==="BEST"?!d:d===$;return l.jsx("button",{type:"button",className:`forest-tab ${W?"active":""}`,onClick:()=>M($),children:$==="BEST"?"BEST":$},$)})}),l.jsx("div",{className:"forest-sort",children:WS.map($=>l.jsx("button",{type:"button",className:`forest-sort-btn ${$.value===u?"active":""}`,onClick:()=>X($.value),children:$.label},$.value))}),a==="loading"&&l.jsx("div",{className:"forest-state",children:"  "}),a==="error"&&l.jsxs("div",{className:"forest-state error",children:[l.jsx("div",{style:{marginBottom:8},children:c||"  ."}),!1,l.jsx("button",{type:"button",onClick:()=>{w()},className:"forest-retry",children:" "})]}),a==="empty"&&l.jsx("div",{className:"forest-empty",children:e?"    .   .":"    .    ?"}),a==="success"&&l.jsx("div",{className:"forest-list",children:P.length>0?P.map($=>l.jsx(HS,{post:$,onLike:R,onReport:W=>_(W),onOpen:W=>g(W),onShare:V,onDelete:I},$.id)):l.jsx("div",{className:"forest-empty",children:e?"    .   .":"    .    ?"})})]}),l.jsx(qS,{post:N,onClose:()=>g(null),onLike:R,onReport:()=>N&&_(N.id),onDelete:I,onShare:V,onEdit:re}),l.jsx(KS,{open:!!m,onClose:()=>{_(null),k("")},onSubmit:A,details:x,onDetailsChange:k}),!e&&!v&&l.jsx(BS,{})]})}function HS({post:t,onLike:e,onReport:r,onOpen:n,onShare:s,onDelete:o}){const i=Re(),a=u=>{u.target.closest("button")||n(t.id)},c=JS(t);return l.jsxs("article",{className:"forest-card",role:"button",tabIndex:0,onClick:a,children:[l.jsxs("div",{className:"forest-card-top",children:[l.jsxs("div",{className:"forest-card-meta-group",children:[l.jsx("span",{className:"forest-card-emoji","aria-hidden":"true",children:t.emotionEmoji}),l.jsx("span",{className:"forest-category-pill",children:t.category})]}),c&&l.jsx("span",{className:"forest-best-badge","aria-label":"best post",children:"best"})]}),l.jsx("p",{className:"forest-card-content",children:t.content}),t.imageUrl&&l.jsx("div",{className:"forest-card-image",children:l.jsx("img",{src:t.imageUrl,alt:"  "})}),l.jsxs("div",{className:"forest-card-author-line",children:[l.jsx("span",{className:"forest-card-author",children:t.nickname}),l.jsx("span",{className:"forest-card-dot",children:""}),l.jsx("span",{className:"forest-card-time",children:Sp(t.createdAt)})]}),l.jsxs("div",{className:"forest-card-footer",children:[t.isMine&&l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",className:"forest-sheet-owner-btn",onClick:u=>{u.stopPropagation(),t.recordId&&i(`/record?id=${t.recordId}`)},style:{marginRight:8},children:" "}),l.jsx("button",{type:"button",className:"forest-sheet-owner-btn danger",onClick:u=>{u.stopPropagation(),o&&confirm("   ?")&&o(t.id)},children:" "})]}),!t.isMine&&l.jsx("button",{type:"button",className:"forest-report-pill",onClick:u=>{u.stopPropagation(),r(t.id)},children:" "}),l.jsx("button",{type:"button",className:"forest-share-btn",onClick:u=>{u.stopPropagation(),s(t)},children:" "}),l.jsxs("button",{type:"button",disabled:t.isMine,className:`forest-like-chip ${t.isLikedByMe?"active":""}`,onClick:u=>{u.stopPropagation(),e(t.id)},children:[l.jsx("span",{role:"img","aria-label":"like drop",children:""}),t.likeCount]})]})]})}function qS({post:t,onClose:e,onLike:r,onReport:n,onDelete:s,onShare:o,onEdit:i}){if(!t)return null;const a=t.isMine,c=t.mbti??"INFJ";return l.jsx("div",{className:"forest-sheet-backdrop",role:"dialog","aria-modal":"true",onClick:u=>{u.currentTarget===u.target&&e()},children:l.jsxs("div",{className:"forest-sheet",children:[l.jsxs("div",{className:"forest-sheet-top",children:[l.jsxs("div",{children:[l.jsx("p",{className:"forest-sheet-label",children:"  "}),l.jsx("h2",{className:"forest-sheet-title",children:t.nickname}),l.jsxs("p",{className:"forest-sheet-meta",children:[c,"  ",Sp(t.createdAt)]})]}),l.jsx("button",{type:"button",className:"forest-sheet-close",onClick:e,children:""})]}),l.jsxs("div",{className:"forest-sheet-emotion-row",children:[l.jsx("span",{className:"forest-sheet-emotion",children:t.emotionEmoji}),l.jsx("span",{className:"forest-category-pill",children:t.category})]}),l.jsxs("div",{className:"forest-sheet-body",children:[l.jsx("p",{children:t.content}),t.imageUrl&&l.jsx("div",{className:"forest-sheet-image",children:l.jsx("img",{src:t.imageUrl,alt:"  "})}),t.isReported&&l.jsx("div",{className:"forest-sheet-flag",children:"  ."})]}),l.jsxs("div",{className:"forest-sheet-actions",children:[!a&&l.jsx("button",{type:"button",className:"forest-report-pill",onClick:n,children:""}),l.jsx("button",{type:"button",className:"forest-share-btn",onClick:()=>o(t),children:" "}),l.jsxs("button",{type:"button",disabled:t.isMine,className:`forest-like-chip ${t.isLikedByMe?"active":""}`,onClick:()=>r(t.id),children:[" ",t.likeCount]}),a&&l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",className:"forest-sheet-owner-btn",onClick:()=>i(t),children:""}),l.jsx("button",{type:"button",className:"forest-sheet-owner-btn danger",onClick:()=>s(t.id),children:""})]})]})]})})}function KS({open:t,onClose:e,onSubmit:r,details:n,onDetailsChange:s}){const[o,i]=S.useState(Ya[0]),[a,c]=S.useState(n||"");S.useEffect(()=>{t&&(i(Ya[0]),c(n||""))},[t,n]);const u=d=>{c(d),s&&s(d)};return t?l.jsx("div",{className:"forest-report-modal",role:"dialog","aria-modal":"true",children:l.jsxs("div",{className:"forest-report-panel",children:[l.jsxs("div",{className:"forest-report-header",children:[l.jsx("h3",{children:"  ?"}),l.jsx("button",{type:"button",className:"forest-report-close",onClick:e,"aria-label":"",children:""})]}),l.jsx("p",{className:"forest-report-desc",children:"   . ()"}),l.jsx("div",{className:"forest-report-reasons",children:Ya.map(d=>l.jsxs("label",{className:"forest-report-option",children:[l.jsx("input",{type:"radio",name:"report-reason",value:d,checked:o===d,onChange:()=>i(d)}),l.jsx("span",{children:d})]},d))}),l.jsx("textarea",{value:a,onChange:d=>u(d.target.value),placeholder:"     . ()",style:{width:"100%",minHeight:80,padding:"12px",borderRadius:12,border:"1px solid var(--ms-line)",fontSize:14,fontFamily:"inherit",resize:"vertical"}}),l.jsxs("div",{className:"forest-report-actions",children:[l.jsx("button",{type:"button",onClick:e,className:"ghost",children:""}),l.jsx("button",{type:"button",onClick:()=>{r(o,a.trim()?a:void 0)},children:""})]})]})}):null}function Sp(t){const e=Date.now()-new Date(t).getTime(),r=Math.floor(e/6e4);if(r<1)return" ";if(r<60)return`${r} `;const n=Math.floor(r/60);if(n<24)return`${n} `;const s=Math.floor(n/24);return s===1?"":s<7?`${s} `:t.split("T")[0].replace(/-/g,".")}function JS(t){return t.likeCount>=GS}const gr="profile-images",QS=5*1024*1024;async function YS(t,e){var r,n,s,o,i;if(t.size>QS)return{url:null,error:new Error("5MB     .")};if(!t.type.startsWith("image/"))return{url:null,error:new Error("    .")};try{console.log("[uploadProfileImage]  :",{userId:e,fileName:t.name,fileSize:t.size,fileType:t.type});const a=((r=t.name.split(".").pop())==null?void 0:r.toLowerCase())||"jpg",u=`profile.${Date.now()}.${a}`,d=`${e}/${u}`;console.log("[uploadProfileImage]  :",{filePath:d,bucket:gr,userId:e,fileName:u}),console.log("[uploadProfileImage]    ...");const{data:f,error:h}=await z.storage.from(gr).list(e,{limit:100});if(h&&h.message!=="Object not found")console.warn("[uploadProfileImage]      ():",h);else if(f&&f.length>0){const y=f.map(g=>`${e}/${g.name}`),{error:v}=await z.storage.from(gr).remove(y);v?console.warn("[uploadProfileImage]     ():",v):console.log("[uploadProfileImage]    :",{deletedCount:f.length})}else console.log("[uploadProfileImage]   ");console.log("[uploadProfileImage]   ...");const{data:w,error:p}=await z.storage.from(gr).upload(d,t,{cacheControl:"3600",upsert:!0});if(p){console.error("[uploadProfileImage]   :",{error:p,code:p.statusCode,message:p.message,errorCode:p.error});let y=p.message||"   .";throw(n=p.message)!=null&&n.includes("bucket")||(s=p.message)!=null&&s.includes("")||p.statusCode===404?(y=`Storage  '${gr}'     . Supabase Dashboard  .`,console.error("[uploadProfileImage]    :",{error:p.message,statusCode:p.statusCode,hint:"Supabase Dashboard > Storage profile-images   "})):(p.statusCode===403||(o=p.message)!=null&&o.includes("permission")||(i=p.message)!=null&&i.includes(""))&&(y="    .   .",console.error("[uploadProfileImage]    :",{error:p.message,statusCode:p.statusCode})),new Error(y)}console.log("[uploadProfileImage]   :",{uploadData:w});const{data:{publicUrl:b}}=z.storage.from(gr).getPublicUrl(d);return console.log("[uploadProfileImage] Public URL  :",{publicUrl:b,filePath:d}),{url:b,error:null}}catch(a){const c=a instanceof Error?a:new Error("   .");return console.error("[uploadProfileImage]    :",{userId:e,error:a,errorMessage:c.message,errorStack:c.stack}),{url:null,error:c}}}async function XS(t){try{console.log("[deleteProfileImage]  :",{userId:t});const{data:e,error:r}=await z.storage.from(gr).list(t,{limit:100,sortBy:{column:"created_at",order:"desc"}});if(r){console.error("[deleteProfileImage]    :",r);return}if(!e||e.length===0){console.log("[deleteProfileImage]   :",{userId:t});return}const n=e.map(o=>`${t}/${o.name}`),{error:s}=await z.storage.from(gr).remove(n);s?console.error("[deleteProfileImage]   :",s):console.log("[deleteProfileImage]   :",{userId:t,deletedCount:e.length})}catch(e){console.error("[deleteProfileImage]    :",e)}}async function Ch(t){const e=Array.isArray(t)?t.join(","):t,n=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(a=>a.toString(16).padStart(2,"0")).join("")}const xp={};function ZS(t){try{return localStorage.getItem(t)}catch(e){return console.warn("localStorage.getItem ,   :",e),xp[t]||null}}function ex(t,e){try{localStorage.setItem(t,e)}catch(r){console.warn("localStorage.setItem ,   :",r),xp[t]=e}}function ai(t,e){try{const r=ZS(t);return r?JSON.parse(r):e}catch{return e}}function ks(t,e){try{ex(t,JSON.stringify(e))}catch(r){console.error("lsSet :",r)}}function tx(t,e){const r=t.getContext("2d");if(!r)return;r.clearRect(0,0,t.width,t.height);const n=r.createLinearGradient(0,0,0,t.height);n.addColorStop(0,"#ffffff"),n.addColorStop(1,"#e2f7ee"),r.fillStyle=n,r.fillRect(0,0,t.width,t.height),r.fillStyle="#0f766e",r.font="700 28px system-ui",r.fillText(e.title,24,44),r.font="84px serif",r.fillText(e.emoji,24,132),r.fillStyle="#065f46",r.font="600 18px system-ui",r.fillText(": "+e.date,24,176);const s=(e.message??"").trim();if(s){r.fillStyle="#0f4233",r.font="500 20px system-ui";const o=`${s}`;r.fillText(o,24,210)}r.fillStyle="#7cc49b",r.fillRect(t.width-190,t.height-54,170,36),r.fillStyle="#064e3b",r.font="700 16px system-ui",r.fillText("  ",t.width-182,t.height-32)}const xu="ms_lock",li="ms_lock_session_unlocked",fc={enabled:!1,mode:"pattern",pattern:[],pin:"",biometricEnabled:!1};function rx(t){if(!t)return{...fc};const e=t.mode==="pin"?"pin":"pattern",r=Array.isArray(t.pattern)?t.pattern:[],n=typeof t.pin=="string"?t.pin:"",s=!!t.biometricEnabled;return{...fc,...t,mode:e,pattern:r,pin:n,biometricEnabled:s}}function ku(){const t=ai(xu,fc),e=rx(t);return(t.mode!==e.mode||t.pin!==e.pin||t.enabled!==e.enabled||t.biometricEnabled!==e.biometricEnabled||JSON.stringify(t.pattern??[])!==JSON.stringify(e.pattern))&&mc(e),e}function mc(t){ks(xu,t)}const Nh="ms_profile",Ph="ms_settings",Xa="ms_album",nx=[[1,2,3],[4,5,6],[7,8,9]];function sx(){const t=Re(),{user:e,isGuest:r,session:n,signOut:s}=Ye(),o=Nt(),{requireAuthForAction:i}=ua(),{emotions:a,loading:c,fetchEmotions:u}=bu({userId:(e==null?void 0:e.id)||null}),{settings:d,updateSettings:f}=yp((e==null?void 0:e.id)||null),[h,w]=S.useState(()=>d?{name:d.nickname||"",mbti:d.mbti||"ENFJ",img:d.profile_url||null}:ai(Nh,{name:"",mbti:"ENFJ",img:null})),[p,b]=S.useState(ai(Ph,{emp:!0,time:"21:00"})),[y,v]=S.useState(()=>d&&d.lock_type?{enabled:!0,mode:d.lock_type,pattern:[],pin:"",biometricEnabled:!1}:ku());S.useEffect(()=>{d&&!r&&(w({name:d.nickname||"",mbti:d.mbti||"ENFJ",img:d.profile_url||null}),d.lock_type&&v(O=>({...O,enabled:!0,mode:d.lock_type})))},[d,r]),S.useEffect(()=>{e&&!r&&u()},[e,r,u]);const[g,m]=S.useState([]),[_,x]=S.useState(!1);S.useEffect(()=>{(async()=>{if(!e||r){m([]);return}x(!0);try{const Y=await bp(e.id),{data:oe}=await z.from("user_settings").select("seed_name").eq("user_id",e.id).maybeSingle(),ce=(oe==null?void 0:oe.seed_name)||" ",He=Y.map((ke,vo)=>{const Ap=ke.bloomed_at?new Date(ke.bloomed_at).toISOString().split("T")[0]:new Date(ke.created_at).toISOString().split("T")[0];let hn="";return ke.growth_percent>=100?hn="":ke.growth_percent>=70?hn="":ke.growth_percent>=50?hn="":ke.growth_percent>=30?hn="":hn="",{id:ke.id,title:ce||` ${vo+1}`,date:Ap,water:Math.floor(ke.growth_percent/10),emoji:hn,message:""}});m(He),ks(Xa,He)}catch(Y){console.error("  :",Y);const oe=ai(Xa,[]);m(oe)}finally{x(!1)}})()},[e,r]);const[k,E]=S.useState(!1),[j,N]=S.useState(!1),[P,M]=S.useState(!1),[X,R]=S.useState(!1),[A,I]=S.useState(!1),[V,re]=S.useState(!1),[T,L]=S.useState(!1);S.useEffect(()=>{ks(Nh,h)},[h]),S.useEffect(()=>{ks(Ph,p)},[p]),S.useEffect(()=>{mc(y)},[y]),S.useEffect(()=>{ks(Xa,g)},[g]);const U=S.useRef(null),[$,W]=S.useState(!1),Q=()=>{i("upload_profile_image",()=>{var O;(O=U.current)==null||O.click()},{customMessage:"      ."})};async function H(O){var oe;const Y=(oe=O.target.files)==null?void 0:oe[0];if(!Y){U.current&&(U.current.value="");return}e&&i("upload_profile_image_file",async()=>{if($){o.warning("  .  .","");return}W(!0);try{console.log("[MyPage]    :",{userId:e.id,fileName:Y.name,fileSize:Y.size,fileType:Y.type});const ce=await YS(Y,e.id);if(ce.error){console.error("[MyPage]    :",{userId:e.id,error:ce.error,errorMessage:ce.error.message}),o.error(ce.error.message||"   ",""),U.current&&(U.current.value="");return}if(ce.url){console.log("[MyPage]    , DB  :",{userId:e.id,url:ce.url});const He=await f({profile_url:ce.url});if(He.error){console.error("[MyPage]  URL DB  :",{userId:e.id,error:He.error}),o.error("  URL  ",""),U.current&&(U.current.value="");return}console.log("[MyPage]      :",{userId:e.id,url:ce.url}),w(ke=>({...ke,img:ce.url})),o.success("  ","")}else o.error("  URL   ","");U.current&&(U.current.value="")}catch(ce){console.error("[MyPage]      :",{userId:e.id,error:ce,errorMessage:ce instanceof Error?ce.message:String(ce)}),o.error("   ",""),U.current&&(U.current.value="")}finally{W(!1)}},{customMessage:"      ."})}async function he(){i("set_default_emoji",async()=>{if(e)try{await XS(e.id),await f({profile_url:null}),w(O=>({...O,img:null})),o.success("   ","")}catch(O){console.error("   :",O),o.error("   ","")}},{customMessage:"      ."})}async function Z(){i("edit_nickname",async()=>{const O=h.name||"",Y=window.prompt("   (1~12)",O);if(Y===null)return;const oe=Y.trim();if(!oe)return o.warning("   ","");if(oe.length>12)return o.warning(" 1~12  ","");if(["","","","","fuck","shit"].some(He=>oe.toLowerCase().includes(He)))return o.warning("    ?","");try{await f({nickname:oe}),w(He=>({...He,name:oe})),o.success("  ","")}catch(He){console.error("  :",He),o.error("  ","")}},{customMessage:"     ."})}async function Pt(O){i("change_mbti",async()=>{try{await f({mbti:O}),w(Y=>({...Y,mbti:O}))}catch(Y){console.error("MBTI  :",Y),o.error("MBTI  ","")}},{customMessage:"MBTI     ."})}function da(){N(!1),o.success("  ","")}const[Xe,ho]=S.useState(y.enabled),[B,je]=S.useState(y.mode),[ye,Ue]=S.useState(y.pattern??[]),[_t,ut]=S.useState(""),[$e,Mr]=S.useState(y.pin??""),[Br,cr]=S.useState("");S.useEffect(()=>{V&&(ho(y.enabled),je(y.mode),Ue(y.pattern??[]),Mr(y.pin??""),ut(""),cr(""))},[V,y]),S.useEffect(()=>{Xe||(ut(""),cr(""))},[Xe]);const fo=O=>{ut(""),Ue(Y=>Y.length?Y[Y.length-1]===O?Y.slice(0,-1):Y.includes(O)?Y:[...Y,O]:[O])},mo=()=>{Ue([]),ut("")},go=O=>{const Y=O.replace(/\D/g,"").slice(0,4);Mr(Y),cr("")},F=async()=>{i("save_lock_settings",async()=>{if(Xe){if(B==="pattern"&&ye.length<4){ut("  4   .");return}if(B==="pin"&&$e.length!==4){cr("PIN 4  .");return}}try{let O=null,Y=null;Xe&&(O=B,B==="pattern"?Y=await Ch(ye):Y=await Ch($e)),await f({lock_type:O,lock_value:Y});const oe=new Date().toISOString(),ce={...y,enabled:Xe,mode:B,pattern:Xe&&B==="pattern"?ye:[],pin:Xe&&B==="pin"?$e:"",updatedAt:oe,createdAt:y.createdAt||(Xe?oe:y.createdAt),biometricEnabled:y.biometricEnabled};Xe||(ce.pattern=[],ce.pin=""),sessionStorage.removeItem(li),v(ce),mc(ce),re(!1),o.success(Xe?"  ":"  ","")}catch(O){console.error("   :",O),o.error("   ","")}},{customMessage:"      ."})},[ie,ls]=S.useState(null),ae=S.useRef(null),[le,ne]=S.useState("");S.useEffect(()=>{X&&ie&&ae.current&&tx(ae.current,{title:ie.title,date:ie.date,water:ie.water,emoji:ie.emoji,message:le||ie.message})},[X,ie,le]);function zt(O){ls(O),ne(O.message??""),M(!1),setTimeout(()=>R(!0),0)}function K(){if(ie){if(le.length>15){o.warning("   15   .","");return}m(O=>O.map(Y=>Y.id===ie.id?{...Y,message:le}:Y)),ls(O=>O&&{...O,message:le}),o.success("   .","")}}function Wt(){const O=ae.current;if(!O||!ie)return;const Y=O.toDataURL("image/png"),oe=document.createElement("a");oe.href=Y,oe.download=((ie==null?void 0:ie.title)||"maeumssi_flower")+".png",oe.click()}function dn(){const O=ae.current;if(!O||!ie)return;const Y=O.toDataURL("image/png");if(navigator.share)navigator.share({title:" ",text:`${ie.title}   ${ie.water}`}).catch(()=>{});else{const oe=document.createElement("a");oe.href=Y,oe.download=((ie==null?void 0:ie.title)||"maeumssi_flower")+".png",oe.click()}}function jp(){i("download_json",()=>{const O=a.map(ce=>({date:new Date(ce.created_at).toISOString().split("T")[0],mood:ce.emotion_type,text:ce.content,public:ce.is_public,category:ce.category||null,image_url:ce.image_url||null,created_at:ce.created_at,updated_at:ce.updated_at})),Y=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),oe=document.createElement("a");oe.href=URL.createObjectURL(Y),oe.download=`maeumssi_records_${new Date().toISOString().split("T")[0]}.json`,oe.click(),o.success("JSON  .","")},{customMessage:"     ."})}function Cp(){i("download_csv",()=>{const O=a.map(ke=>({date:new Date(ke.created_at).toISOString().split("T")[0],mood:ke.emotion_type,text:ke.content,public:ke.is_public?"":"",category:ke.category||"",image_url:ke.image_url||"",created_at:ke.created_at,updated_at:ke.updated_at}));if(O.length===0){o.info("  .","");return}const Y=Object.keys(O[0]).join(","),oe=O.map(ke=>Object.values(ke).map(vo=>`"${String(vo).replace(/"/g,'""')}"`).join(",")).join(`
`),ce=new Blob([Y+`
`+oe],{type:"text/csv;charset=utf-8;"}),He=document.createElement("a");He.href=URL.createObjectURL(ce),He.download=`maeumssi_records_${new Date().toISOString().split("T")[0]}.csv`,He.click(),o.success("CSV  .","")},{customMessage:"     ."})}const[ha,Np]=S.useState(""),[fa,Pp]=S.useState(""),[po,Tp]=S.useState("");function Rp(){if(!po.trim()){o.warning("  .","");return}const O=encodeURIComponent(fa||" "),Y=encodeURIComponent(po||"");if(ha.trim())location.href=`mailto:${ha}?subject=${O}&body=${Y}`;else{const oe=`: ${fa||" "}

${po}`;navigator.clipboard.writeText(oe).then(()=>{o.success("   .    .","")}).catch(()=>{o.info("     .","")})}}const Op=!Xe||(B==="pattern"?ye.length>=4:$e.length===4);return l.jsxs(Rr,{hideHeader:!0,children:[l.jsxs("div",{className:"mypage-root",children:[l.jsx("section",{className:"mypage-profile",children:l.jsxs("div",{className:"mypage-profile-main",children:[l.jsx("div",{className:"avatar","data-has":h.img?"img":"emo",children:h.img?l.jsx("img",{alt:"",src:h.img}):l.jsx("div",{className:"emo",children:""})}),l.jsxs("div",{children:[l.jsxs("div",{className:"nickname-row",children:[l.jsx("div",{className:"nickname",children:h.name}),l.jsx("button",{type:"button",className:"name-edit","aria-label":" ",onClick:Z,children:""})]}),l.jsxs("div",{className:"bio",children:["MBTI ",h.mbti]}),l.jsxs("div",{className:"badges",children:[l.jsxs("div",{className:"badge",children:[l.jsx("span",{className:"badge-icon",children:""})," ",l.jsx("b",{children:c?"...":a.length})]}),l.jsxs("div",{className:"badge",children:[l.jsx("span",{className:"badge-icon",children:""})," ",l.jsx("b",{children:c?"...":a.filter(O=>O.is_public).length})]}),l.jsxs("div",{className:"badge",children:[l.jsx("span",{className:"badge-icon",children:""})," ",l.jsx("b",{children:g.length})]})]})]})]})}),e&&n&&l.jsxs("section",{className:"mypage-profile",style:{marginTop:20},children:[l.jsx("div",{style:{fontSize:15,fontWeight:700,marginBottom:16,color:"var(--ms-text-main)"},children:" "}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"var(--ms-ink-soft)"},children:" "}),l.jsxs("div",{style:{display:"grid",gap:8,fontSize:13},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:" ID"}),l.jsxs("span",{style:{color:"var(--ms-ink-soft)",fontFamily:"monospace",fontSize:12},children:[e.id.substring(0,8),"..."]})]}),(d==null?void 0:d.nickname)&&l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:""}),l.jsx("span",{style:{color:"var(--ms-ink-soft)"},children:d.nickname})]}),(d==null?void 0:d.birthdate)&&l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:""}),l.jsx("span",{style:{color:"var(--ms-ink-soft)"},children:d.birthdate})]}),(d==null?void 0:d.gender)&&l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:""}),l.jsx("span",{style:{color:"var(--ms-ink-soft)"},children:d.gender})]})]})]}),l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"var(--ms-ink-soft)"},children:" "}),l.jsxs("div",{style:{display:"grid",gap:8,fontSize:13},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:" "}),l.jsx("span",{style:{color:"var(--ms-ink-soft)"},children:(()=>{var oe;const O=(oe=n.user.app_metadata)==null?void 0:oe.provider;return{google:"Google",apple:"Apple",kakao:"Kakao",facebook:"Facebook",line:"LINE"}[O||""]||O||"  "})()})]}),e.email&&l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("span",{style:{color:"var(--ms-ink-muted)"},children:""}),l.jsx("span",{style:{color:"var(--ms-ink-soft)",fontSize:12},children:e.email})]}),l.jsx("div",{style:{marginTop:8},children:l.jsx("button",{onClick:()=>o.info("    .",""),style:{width:"100%",padding:"8px 12px",borderRadius:8,border:"1px solid var(--ms-line)",background:"#fff",color:"var(--ms-ink-soft)",fontSize:12,fontWeight:500,cursor:"pointer"},children:"  "})})]})]})]}),l.jsxs("div",{className:"card sub",onClick:()=>E(!0),children:[l.jsxs("div",{children:[l.jsx("div",{className:"tt",children:" "}),l.jsx("div",{className:"sub",children:", MBTI,      "})]}),l.jsx("div",{className:"chev",children:""})]}),l.jsxs("div",{className:"card",onClick:()=>N(!0),children:[l.jsxs("div",{children:[l.jsx("div",{className:"tt",children:" "}),l.jsx("div",{className:"sub",children:"    "})]}),l.jsx("div",{className:"chev",children:""})]}),l.jsxs("div",{className:"card",onClick:()=>M(!0),children:[l.jsx("div",{children:l.jsx("div",{className:"tt",children:" "})}),l.jsx("div",{className:"chev",children:""})]}),l.jsxs("div",{className:"card",onClick:()=>I(!0),children:[l.jsx("div",{children:l.jsx("div",{className:"tt",children:" "})}),l.jsx("div",{className:"chev",children:""})]}),l.jsxs("div",{className:"card",onClick:()=>re(!0),children:[l.jsx("div",{children:l.jsx("div",{className:"tt",children:" "})}),l.jsx("div",{className:"chev",children:""})]}),l.jsxs("div",{className:"card",onClick:()=>L(!0),children:[l.jsx("div",{children:l.jsx("div",{className:"tt",children:" "})}),l.jsx("div",{className:"chev",children:""})]}),e&&n&&l.jsxs("div",{className:"card",onClick:async()=>{if(confirm(" ?"))try{await s(),t("/login",{replace:!0})}catch(O){console.error(" :",O),o.error(" .    .","")}},children:[l.jsx("div",{className:"tt",children:""}),l.jsx("div",{className:"chev",children:""})]}),e&&n&&l.jsxs("div",{className:"card danger",onClick:()=>{t("/delete-account")},children:[l.jsx("div",{className:"tt",style:{color:"#ef4444"},children:""}),l.jsx("div",{className:"chev",style:{borderColor:"#fecaca",background:"#fff5f5"},children:""})]})]}),k&&l.jsxs(Wr,{onClose:()=>E(!1),children:[l.jsx("h3",{children:" "}),l.jsx("p",{className:"hint",children:"     .     ."}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:"MBTI"}),l.jsx("div",{children:l.jsx("select",{value:h.mbti,onChange:O=>Pt(O.target.value),className:"input",disabled:r,children:["ENFJ","ENFP","ENTJ","ENTP","ESFJ","ESFP","ESTJ","ESTP","INFJ","INFP","INTJ","INTP","ISFJ","ISFP","ISTJ","ISTP"].map(O=>l.jsx("option",{children:O},O))})})]}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:" "}),l.jsxs("div",{children:[l.jsxs("div",{className:"grid2",style:{marginBottom:8},children:[l.jsx("button",{type:"button",className:"btn",onClick:Q,disabled:r,children:" "}),l.jsx("button",{type:"button",className:"btn",onClick:he,disabled:r,children:"  "})]}),l.jsx("input",{type:"file",ref:U,accept:"image/*",onChange:H,style:{display:"none"}})]})]}),l.jsxs("div",{className:"grid2",style:{marginTop:10},children:[l.jsx("button",{className:"btn",onClick:()=>E(!1),children:""}),l.jsx("button",{className:"btn primary",onClick:async()=>{i("save_profile",()=>{E(!1),o.success("  ","")},{customMessage:"      ."})},disabled:r,children:""})]})]}),j&&l.jsxs(Wr,{onClose:()=>N(!1),children:[l.jsx("h3",{children:" "}),l.jsx("p",{className:"hint",children:"     ."}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:" "}),l.jsx("div",{children:l.jsxs("label",{className:"tog",children:[l.jsx("input",{type:"checkbox",checked:p.emp,onChange:O=>b(Y=>({...Y,emp:O.target.checked}))}),l.jsx("span",{className:"tog-ball"})]})})]}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:"  "}),l.jsx("div",{children:l.jsx("input",{type:"time",value:p.time,onChange:O=>b(Y=>({...Y,time:O.target.value||"21:00"})),className:"input"})})]}),l.jsxs("div",{className:"grid2",style:{marginTop:10},children:[l.jsx("button",{className:"btn",onClick:()=>N(!1),children:""}),l.jsx("button",{className:"btn primary",onClick:da,children:""})]})]}),P&&l.jsxs(Wr,{onClose:()=>M(!1),children:[l.jsx("h3",{children:" "}),l.jsx("p",{className:"hint",children:"     ."}),_?l.jsx("div",{style:{textAlign:"center",padding:"40px 16px",color:"var(--ms-ink-soft)"},children:"  ..."}):g.length===0?l.jsx("div",{style:{textAlign:"center",padding:"40px 16px",color:"var(--ms-ink-soft)"},children:"   .       "}):l.jsx("div",{className:"album",id:"albumList",children:g.map(O=>l.jsxs("div",{className:"item",onClick:()=>zt(O),children:[l.jsx("div",{className:"flower",children:O.emoji}),l.jsx("div",{className:"meta",children:l.jsx("span",{children:O.title})}),l.jsxs("div",{className:"meta",style:{fontWeight:600},children:[l.jsx("span",{children:O.date}),l.jsx("span",{})]})]},O.id))}),l.jsxs("div",{className:"grid2",style:{marginTop:10},children:[l.jsx("button",{className:"btn",onClick:()=>M(!1),children:""}),g.length>0&&l.jsx("button",{className:"btn primary",onClick:()=>o.info("    /  ",""),children:""})]})]}),X&&ie&&l.jsxs(Wr,{onClose:()=>R(!1),children:[l.jsxs("div",{className:"flower-modal-header",children:[l.jsx("h3",{id:"flowerTitle",children:" "}),l.jsx("button",{type:"button",className:"flower-close-btn",onClick:()=>R(!1),"aria-label":"",children:""})]}),l.jsx("canvas",{ref:ae,id:"flowerCanvas",width:600,height:360,className:"flower-canvas"}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:" "}),l.jsx("div",{id:"flowerDate",children:ie.date})]}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:"  "}),l.jsxs("div",{children:[l.jsx("input",{value:le,onChange:O=>{O.target.value.length>15||ne(O.target.value)},placeholder:"15  ",className:"input"}),l.jsxs("div",{className:"ms-input-help",style:{fontSize:11,color:"var(--ms-ink-muted)",marginTop:4},children:[le.length," / 15"]})]})]}),l.jsxs("div",{className:"grid2 flower-actions",style:{marginTop:10},children:[l.jsx("button",{className:"btn",onClick:K,children:" "}),l.jsxs("div",{className:"grid2",children:[l.jsx("button",{className:"btn",onClick:Wt,children:"PNG "}),l.jsx("button",{className:"btn",onClick:dn,children:""})]})]})]}),A&&l.jsxs(Wr,{onClose:()=>I(!1),children:[l.jsx("h3",{children:" "}),l.jsxs("p",{className:"hint",children:["       .",c?"   ...":`  ${a.length}  .`]}),a.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid2",children:[l.jsx("button",{className:"btn",onClick:jp,disabled:c,children:"JSON "}),l.jsx("button",{className:"btn",onClick:Cp,disabled:c,children:"CSV "})]}),l.jsxs("div",{style:{marginTop:16,fontSize:13,color:"var(--ms-ink-soft)"},children:[l.jsxs("div",{children:["  : ",a.length,""]}),l.jsxs("div",{children:["  : ",a.filter(O=>O.is_public).length,""]}),l.jsxs("div",{children:["  : ",a.filter(O=>!O.is_public).length,""]})]})]}):l.jsx("div",{style:{textAlign:"center",padding:"20px 0",color:"var(--ms-ink-soft)"},children:c?"  ...":"  .    ?"}),l.jsx("div",{className:"grid2",style:{marginTop:10},children:l.jsx("button",{className:"btn",onClick:()=>I(!1),children:""})})]}),V&&l.jsx(Wr,{onClose:()=>re(!1),children:l.jsxs("div",{className:"lock-modal",children:[l.jsxs("div",{className:"lock-modal-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" "}),l.jsx("p",{className:"hint",children:"   ."})]}),l.jsxs("div",{className:"lock-toggle-row",children:[l.jsxs("div",{children:[l.jsx("div",{className:"lock-toggle-title",children:"  "}),l.jsx("div",{className:"lock-toggle-desc",children:"     ."})]}),l.jsxs("label",{className:"tog",children:[l.jsx("input",{type:"checkbox",checked:Xe,onChange:O=>ho(O.target.checked)}),l.jsx("span",{className:"tog-ball"})]})]})]}),l.jsxs("div",{className:"lock-modal-body",children:[Xe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"lock-mode-tabs",children:[l.jsxs("button",{type:"button",className:`lock-mode-tab ${B==="pattern"?"active":""}`,onClick:()=>{je("pattern"),ut("")},children:[l.jsx("span",{className:"lock-mode-icon",children:""}),l.jsxs("div",{className:"lock-mode-text",children:[l.jsx("div",{className:"title",children:" "}),l.jsx("div",{className:"desc",children:" "})]})]}),l.jsxs("button",{type:"button",className:`lock-mode-tab ${B==="pin"?"active":""}`,onClick:()=>{je("pin"),cr("")},children:[l.jsx("span",{className:"lock-mode-icon",children:""}),l.jsxs("div",{className:"lock-mode-text",children:[l.jsx("div",{className:"title",children:"PIN (4)"}),l.jsx("div",{className:"desc",children:"  "})]})]})]}),B==="pattern"&&l.jsxs("div",{className:"lock-pattern-panel",children:[l.jsx("div",{className:"lock-pattern-grid",children:nx.flat().map(O=>{const Y=ye.indexOf(O);return l.jsx("button",{type:"button",className:`lock-pattern-node ${Y>=0?"active":""}`,onClick:()=>fo(O),children:Y>=0?Y+1:""},O)})}),l.jsx("div",{className:"lock-pattern-seq",children:ye.length?ye.map((O,Y)=>l.jsx("span",{className:"lock-seq-chip",children:Y+1},O)):l.jsx("span",{className:"lock-pattern-placeholder",children:"   ."})}),_t&&l.jsx("div",{className:"lock-error",children:_t}),l.jsx("button",{type:"button",className:"lock-pattern-reset",onClick:mo,children:"  "}),l.jsx("p",{className:"lock-helper",children:" 4    ."})]}),B==="pin"&&l.jsxs("div",{className:"lock-pin-panel",children:[l.jsx("div",{className:"lock-pin-dots",children:[0,1,2,3].map(O=>l.jsx("div",{className:`lock-pin-dot ${O<$e.length?"filled":""}`},O))}),l.jsx("input",{value:$e,onChange:O=>go(O.target.value),maxLength:4,className:"input lock-pin-input",placeholder:"****",inputMode:"numeric"}),Br&&l.jsx("div",{className:"lock-error",children:Br}),l.jsx("p",{className:"lock-helper",children:" 4  ."})]})]}),l.jsxs("div",{className:"lock-info-box",children:[l.jsx("div",{className:"lock-info-title",children:"  "}),l.jsxs("div",{className:"lock-info-text",children:["        .",l.jsx("br",{})," PIN/    ."]})]})]}),l.jsxs("div",{className:"lock-modal-footer",children:[l.jsx("button",{type:"button",className:"lock-btn lock-btn-secondary",onClick:()=>re(!1),children:""}),l.jsx("button",{type:"button",className:"lock-btn lock-btn-primary",disabled:!Op,onClick:F,children:""})]})]})}),T&&l.jsxs(Wr,{onClose:()=>L(!1),children:[l.jsx("h3",{children:" "}),l.jsx("p",{className:"hint",children:"        ."}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:""}),l.jsx("div",{children:l.jsx("input",{className:"input",value:ha,onChange:O=>Np(O.target.value),placeholder:" (: hello@maeumssi.app)"})})]}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:""}),l.jsx("div",{children:l.jsx("input",{className:"input",value:fa,onChange:O=>Pp(O.target.value),placeholder:""})})]}),l.jsxs("div",{className:"row",children:[l.jsx("div",{children:""}),l.jsx("div",{children:l.jsx("textarea",{className:"input",value:po,onChange:O=>Tp(O.target.value),rows:5,placeholder:"  "})})]}),l.jsxs("div",{className:"grid2",style:{marginTop:10},children:[l.jsx("button",{className:"btn",onClick:()=>L(!1),children:""}),l.jsx("button",{className:"btn primary",onClick:Rp,children:""})]})]})]})}function Wr({children:t,onClose:e}){return l.jsx("div",{className:"modal show",onClick:r=>{r.target===r.currentTarget&&e()},children:l.jsx("div",{className:"sheet",children:t})})}async function ox(t,e){try{const{data:r,error:n}=await z.from("community_posts").select(`
        *,
        profiles:user_id (
          nickname,
          seed_name,
          mbti
        )
      `).eq("id",t).eq("is_public",!0).maybeSingle();if(n)return console.error("[fetchCommunityPost]  :",{code:n.code,message:n.message,details:n.details,hint:n.hint,postId:t}),null;if(!r)return null;const s=r;if(s.profiles||(s.profiles={nickname:"",seed_name:null,mbti:null}),e){const{data:o}=await z.from("community_likes").select("id").eq("post_id",t).eq("user_id",e).maybeSingle();s.is_liked_by_me=!!o,s.is_mine=s.user_id===e}return s}catch(r){return console.error("[fetchCommunityPost]  :",{error:r,errorMessage:r instanceof Error?r.message:String(r),postId:t}),null}}async function ix(t,e){try{const{error:r}=await z.from("community_posts").delete().eq("id",t).eq("user_id",e);if(r)throw console.error("[deleteCommunityPost]  :",{code:r.code,message:r.message,details:r.details,hint:r.hint,postId:t,userId:e}),r;return!0}catch(r){throw console.error("[deleteCommunityPost]  :",{error:r,errorMessage:r instanceof Error?r.message:String(r),postId:t,userId:e}),r}}async function ax(t,e,r){try{if(r){const{error:n}=await z.from("community_likes").delete().eq("post_id",t).eq("user_id",e);if(n)throw console.error("[toggleLike]   :",{code:n.code,message:n.message,details:n.details,hint:n.hint,postId:t,userId:e}),n}else{const{error:n}=await z.from("community_likes").insert({post_id:t,user_id:e});if(n){if(n.code==="23505")return console.log("[toggleLike]   :",{postId:t,userId:e}),!0;throw console.error("[toggleLike]   :",{code:n.code,message:n.message,details:n.details,hint:n.hint,postId:t,userId:e}),n}}return!0}catch(n){throw console.error("[toggleLike]  :",{error:n,errorMessage:n instanceof Error?n.message:String(n),postId:t,userId:e,isLiked:r}),n}}async function lx(t,e,r,n){try{const{data:s,error:o}=await z.from("reports").insert({post_id:t,reporter_id:e,reason:r,memo:n||null,status:"pending"}).select().single();if(o)throw console.error("[reportPost]  :",{code:o.code,message:o.message,details:o.details,hint:o.hint,postId:t,reporterId:e,reason:r}),o;return s}catch(s){throw console.error("[reportPost]  :",{error:s,errorMessage:s instanceof Error?s.message:String(s),postId:t,reporterId:e,reason:r}),s}}function cx(t){var r,n,s;const e=es.find(o=>o.label===t.emotion_type);return{id:t.id,userId:t.user_id,emotionCode:(e==null?void 0:e.code)||"CALM",emoji:(e==null?void 0:e.emoji)||"",label:(e==null?void 0:e.label)||t.emotion_type||"",content:t.content,imageUrl:t.image_url||void 0,category:t.category||"",likeCount:t.like_count,isLikedByMe:t.is_liked_by_me||!1,isMine:t.is_mine||!1,isReported:!1,createdAt:t.created_at,updatedAt:t.updated_at,nickname:((r=t.profiles)==null?void 0:r.nickname)||((n=t.profiles)==null?void 0:n.seed_name)||"",mbti:((s=t.profiles)==null?void 0:s.mbti)||void 0,recordId:t.emotion_id||void 0,emotionEmoji:(e==null?void 0:e.emoji)||""}}function ux(){const{postId:t}=M0(),e=Re(),{user:r}=Ye(),n=Nt(),[s,o]=S.useState(null),[i,a]=S.useState(!1),[c,u]=S.useState(!0);S.useEffect(()=>{if(!t)return;(async()=>{u(!0);try{const v=await ox(t,(r==null?void 0:r.id)||null);if(!v){a(!0);return}o(cx(v))}catch(v){console.error("  :",v),n.error("  ",""),a(!0)}finally{u(!1)}})()},[t,r==null?void 0:r.id,n]);const d=S.useMemo(()=>s?s.createdAt.split("T")[0].replace(/-/g,"."):"",[s]);if(i)return l.jsx(Rr,{children:l.jsx("div",{className:"forest-detail",style:{padding:"10px 2px 72px"},children:l.jsxs("div",{style:{textAlign:"center",padding:"40px 16px"},children:[l.jsx("div",{style:{fontSize:16,marginBottom:8},children:"   "}),l.jsx("button",{onClick:()=>e("/forest"),style:{padding:"8px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"#fff",cursor:"pointer"},children:" "})]})})});if(c||!s)return l.jsx(Rr,{children:l.jsx("div",{className:"forest-detail",style:{padding:"10px 2px 72px"},children:l.jsx("div",{style:{textAlign:"center",padding:"40px 16px"},children:" ..."})})});const f=s.isMine;async function h(){if(!s||!r){n.warning(" ","");return}try{const y=s.isLikedByMe;await ax(s.id,r.id,y),o(v=>v?{...v,isLikedByMe:!y,likeCount:y?v.likeCount-1:v.likeCount+1}:null)}catch(y){console.error("  :",y),n.error("  ","")}}async function w(){if(!(!s||!r)&&confirm(" ?"))try{await ix(s.id,r.id),n.success(" ",""),e("/forest")}catch(y){console.error("  :",y),n.error("  ","")}}async function p(){if(!s||!r)return;const y=prompt(`  :
1. /
2. /
3.  
4. `);if(y)try{await lx(s.id,r.id,y,""),n.success(" .   .","")}catch(v){console.error(" :",v),n.error("  ","")}}function b(){s&&(f?w():p())}return l.jsx(Rr,{children:l.jsxs("div",{className:"forest-detail",style:{padding:"10px 2px 72px"},children:[l.jsx("div",{className:"forest-detail-header",style:{margin:"0 0 10px 0"},children:l.jsx("button",{onClick:()=>e(-1),style:{border:"1px solid var(--ms-line)",background:"#fff",borderRadius:10,fontSize:12,padding:"6px 10px",cursor:"pointer"},children:"  "})}),l.jsxs("div",{className:"forest-detail-author",style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[l.jsx("div",{style:{fontSize:20},children:s.emotionEmoji}),l.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{fontSize:14,fontWeight:600},children:s.nickname}),l.jsx("div",{style:{fontSize:12,color:"var(--ms-ink-muted)"},children:d})]}),l.jsx("button",{onClick:b,style:{marginLeft:"auto",border:"1px solid var(--ms-line)",borderRadius:8,background:"#fff",padding:"2px 6px",cursor:"pointer"},children:""})]}),l.jsx("div",{className:"forest-detail-emotion",style:{margin:"6px 0 10px 0"},children:l.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,padding:"4px 8px",borderRadius:999,background:"#E6FFF6",border:"1px solid #BBF7D0",color:"#166534"},children:[l.jsx("span",{children:s.emotionEmoji}),l.jsx("span",{children:s.emotionLabel??""})]})}),l.jsx("div",{className:"forest-detail-text",style:{whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.7,color:"var(--ms-ink-soft)"},children:s.content}),s.imageUrl&&l.jsx("div",{className:"forest-detail-image",style:{marginTop:10},children:l.jsx("img",{src:s.imageUrl,alt:" ",style:{width:"100%",maxHeight:360,objectFit:"cover",borderRadius:14,border:"1px solid var(--ms-line)"}})}),l.jsxs("div",{className:"forest-detail-actions",style:{display:"flex",alignItems:"center",gap:8,marginTop:12},children:[!f&&l.jsxs("button",{onClick:h,className:`forest-like ${s.isLikedByMe?"active":""}`,style:{display:"inline-flex",alignItems:"center",gap:6,padding:"7px 11px",borderRadius:999,border:`1px solid ${s.isLikedByMe?"var(--ms-primary)":"var(--ms-line)"}`,background:s.isLikedByMe?"var(--ms-primary-soft)":"#fff",color:s.isLikedByMe?"var(--ms-primary)":"var(--ms-ink-soft)",fontSize:12,cursor:"pointer"},children:[l.jsx("span",{children:""}),l.jsx("span",{style:{fontWeight:700,fontSize:13},children:s.likeCount})]}),l.jsx("button",{onClick:b,style:{border:"1px solid var(--ms-line)",borderRadius:10,background:"#fff",padding:"6px 10px",fontSize:12,cursor:"pointer"},children:""})]})]})})}const Za="authFlowType";function dx(){const t=Re();return S.useEffect(()=>{C.log("AuthCallback: OAuth   "),(async()=>{var r,n,s;try{C.log("AuthCallback: getSession ");const{data:{session:o},error:i}=await z.auth.getSession();if(i){C.err("AuthCallback:   :",i),t("/login",{replace:!0});return}if(!(o!=null&&o.user)){C.log("AuthCallback:  ,   "),t("/login",{replace:!0});return}const a=o.user.id,c=o.user.email,u=((r=o.user.app_metadata)==null?void 0:r.provider)||"unknown";C.log("AuthCallback:   ",{userId:a,email:c,provider:u}),console.log("[AuthCallback] users   ",{userId:a}),C.log("AuthCallback: users   ");const{data:d,error:f}=await z.from("users").select("id, onboarding_completed, is_deleted, deleted_at").eq("id",a).single();if(f)if(console.error("[AuthCallback] users   :",{code:f.code,message:f.message,details:f.details,hint:f.hint,userId:a}),f.code==="PGRST116")console.log("[AuthCallback] users  row  ( )"),C.log("AuthCallback: users  row  ( )");else if(f.code==="42501"||(n=f.message)!=null&&n.includes("permission denied")||(s=f.message)!=null&&s.includes("RLS"))console.error("[AuthCallback] RLS   - users    "),C.err("AuthCallback: RLS   - users    :",f);else{C.err("AuthCallback: users   :",f),t("/login",{replace:!0});return}if(d){const h=d.is_deleted===!0,w=d.onboarding_completed===!0;if(h){C.log("AuthCallback:     ,  ",{userId:a,deletedAt:d.deleted_at}),te.setItem(Za,"SIGNUP");const{error:p}=await z.from("users").update({is_deleted:!1,deleted_at:null,onboarding_completed:!1,updated_at:new Date().toISOString()}).eq("id",a);if(p){C.err("AuthCallback:   :",p),t("/login",{replace:!0});return}C.log("AuthCallback:   ,   "),t("/onboarding?step=5",{replace:!0});return}C.log("AuthCallback:    (LOGIN)",{userId:a,onboardingCompleted:w}),te.setItem(Za,"LOGIN"),w?(C.log("AuthCallback:   , /home "),t("/home",{replace:!0})):(C.log("AuthCallback:   ,   "),t("/onboarding?step=5",{replace:!0}))}else{C.log("AuthCallback:    (SIGNUP)",{userId:a}),te.setItem(Za,"SIGNUP"),C.log("AuthCallback: users  row  ");const{error:h}=await z.from("users").upsert({id:a,email:c,onboarding_completed:!1,is_deleted:!1,deleted_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id"});if(h){C.err("AuthCallback: users  upsert :",h),t("/login",{replace:!0});return}C.log("AuthCallback:    , /   "),t("/onboarding?step=5",{replace:!0})}}catch(o){C.err("AuthCallback:    :",o),t("/login",{replace:!0})}})()},[t]),l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",fontSize:14,color:"var(--ms-ink-soft)"},children:"  ..."})}const ys="onboardingComplete",Ho="isGuest";function hx(){const t=Re(),{user:e,session:r,loading:n,sessionInitialized:s,isGuest:o}=Ye(),[i,a]=S.useState(te.test()),[c,u]=S.useState({hasUrl:!0,hasKey:!0});S.useEffect(()=>{C.log("Debug:  ")},[]);const d=()=>{a(te.test())},f=()=>{te.setItem(Ho,"true"),te.setItem(ys,"true"),C.log("Debug:   "),d()},h=()=>{te.removeItem(Ho),C.log("Debug:   "),d()},w=()=>{te.setItem(ys,"true"),C.log("Debug:   "),d()},p=()=>{te.removeItem(ys),C.log("Debug:   "),d()},b=()=>{te.removeItem(Ho),te.removeItem(ys),C.log("Debug:   "),d()},y=te.getItem(ys)==="true",v=te.getItem(Ho)==="true";return l.jsx(Rr,{hideHeader:!0,children:l.jsxs("div",{style:{padding:"24px",maxWidth:800,margin:"0 auto"},children:[l.jsx("h1",{style:{fontSize:24,fontWeight:700,marginBottom:24},children:"   "}),l.jsxs("section",{style:{marginBottom:32},children:[l.jsx("h2",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:" (ENV)"}),l.jsx("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--ms-surface)",borderRadius:12,overflow:"hidden"},children:l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:"VITE_SUPABASE_URL"}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:c.hasUrl?" ":" "})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:"VITE_SUPABASE_ANON_KEY"}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:c.hasKey?" ":" "})]})]})})]}),l.jsxs("section",{style:{marginBottom:32},children:[l.jsx("h2",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:" "}),l.jsx("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--ms-surface)",borderRadius:12,overflow:"hidden"},children:l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:" "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:n?" ":" "})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:" "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:s?" ":"  "})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:" "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:r?" ":" "})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:" ID"}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontFamily:"monospace",fontSize:12},children:(e==null?void 0:e.id)||"-"})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:" "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:o?" ":" "})]})]})})]}),l.jsxs("section",{style:{marginBottom:32},children:[l.jsx("h2",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:" "}),l.jsx("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--ms-surface)",borderRadius:12,overflow:"hidden",marginBottom:12},children:l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:"Storage "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:i.available?" localStorage":" "})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:"  "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:v?" true":" false"})]}),l.jsxs("tr",{children:[l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)",fontWeight:600},children:"  "}),l.jsx("td",{style:{padding:"12px",borderBottom:"1px solid var(--ms-line)"},children:y?" true":" false"})]})]})}),l.jsx("button",{onClick:d,style:{padding:"8px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-surface)",cursor:"pointer",fontSize:14},children:"  "})]}),l.jsxs("section",{style:{marginBottom:32},children:[l.jsx("h2",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:" "}),l.jsx("div",{style:{padding:"12px",background:"var(--ms-surface)",borderRadius:12,fontFamily:"monospace",fontSize:14},children:window.location.pathname})]}),l.jsxs("section",{style:{marginBottom:32},children:[l.jsx("h2",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:""}),l.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[l.jsx("button",{onClick:f,style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-primary)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:600},children:"  "}),l.jsx("button",{onClick:h,style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-surface)",cursor:"pointer",fontSize:14},children:"  "}),l.jsx("button",{onClick:w,style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-primary)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:600},children:"  "}),l.jsx("button",{onClick:p,style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-surface)",cursor:"pointer",fontSize:14},children:"  "}),l.jsx("button",{onClick:b,style:{padding:"10px 16px",borderRadius:8,border:"1px solid #ef4444",background:"#fff5f5",color:"#ef4444",cursor:"pointer",fontSize:14,fontWeight:600},children:"  "}),l.jsx("button",{onClick:()=>t("/",{replace:!0}),style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-surface)",cursor:"pointer",fontSize:14},children:" "}),l.jsx("button",{onClick:()=>t("/onboarding",{replace:!0}),style:{padding:"10px 16px",borderRadius:8,border:"1px solid var(--ms-line)",background:"var(--ms-surface)",cursor:"pointer",fontSize:14},children:" "})]})]})]})})}function kp({mode:t,disabled:e=!1}){const r=async()=>{if(!e){if(C.log("SocialLoginButtons: Google   ",{mode:t}),!dc()){const o="      . VITE_SUPABASE_URL VITE_SUPABASE_ANON_KEY .env  .";C.err("SocialLoginButtons: Supabase  ",{hasConfig:!1}),console.error("Supabase  :",o),Ie.error("  .   .","");return}try{const o=`${window.location.origin}/auth/callback`;C.log("SocialLoginButtons: signInWithOAuth  ",{provider:"google",redirectTo:o,currentOrigin:window.location.origin,currentHref:window.location.href,currentPathname:window.location.pathname,currentHash:window.location.hash,supabaseUrl:"https://lbmtccfncnqdsrrtsspt.supabase.co"}),console.log("[OAuth Debug]  :",{provider:"google",redirectTo:o,origin:window.location.origin,pathname:window.location.pathname,hash:window.location.hash,supabaseUrl:"https://lbmtccfncnqdsrrtsspt.supabase.co"});const{data:i,error:a}=await z.auth.signInWithOAuth({provider:"google",options:{redirectTo:o,queryParams:{access_type:"offline",prompt:"select_account"}}});if(C.log("SocialLoginButtons: signInWithOAuth  ",{hasData:!!i,hasError:!!a,dataKeys:i?Object.keys(i):[],dataUrl:i!=null&&i.url?i.url.substring(0,100)+"...":null,errorMessage:a==null?void 0:a.message,errorCode:a==null?void 0:a.status}),console.log("[OAuth Debug]  :",{hasData:!!i,hasError:!!a,data:i,error:a,dataUrl:i==null?void 0:i.url}),a){C.err("SocialLoginButtons: Google  ",a),console.error("[OAuth Debug] Google  :",a),Ie.error(`  . ${a.message||"    ."}`,"");return}if(i!=null&&i.url){const c=i.url;C.log("SocialLoginButtons: OAuth URL  ",{url:c.substring(0,100)+"...",fullUrl:c}),console.log("[OAuth Debug] OAuth URL :",c),console.log("[OAuth Debug]    URL:",window.location.href),window.location.href=c}else C.err("SocialLoginButtons: data.url ",{data:i}),console.error("[OAuth Debug] data.url :",{data:i,error:a}),console.error("[OAuth Debug] Supabase   :",{supabaseUrl:"https://lbmtccfncnqdsrrtsspt.supabase.co",hasAnonKey:!0,redirectUrl:o}),Ie.error(`  URL  .

 :
1. Supabase  > Authentication > URL Configuration
   "${o}"  URL   .
2. Google OAuth Provider   .`,"")}catch(o){C.err("SocialLoginButtons: Google  ",o),console.error("[OAuth Debug] Google  :",o),Ie.error("  .     .","")}}},n=async()=>{if(!e){if(C.log("SocialLoginButtons: Apple   ",{mode:t}),!dc()){const o="      . VITE_SUPABASE_URL VITE_SUPABASE_ANON_KEY .env  .";C.err("SocialLoginButtons: Supabase  ",{hasConfig:!1}),console.error("Supabase  :",o),Ie.error("Apple  .   .","");return}try{C.log("SocialLoginButtons: signInWithOAuth  ",{provider:"apple",redirectTo:`${window.location.origin}/auth/callback`});const{data:o,error:i}=await z.auth.signInWithOAuth({provider:"apple",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(C.log("SocialLoginButtons: signInWithOAuth  ",{hasData:!!o,hasError:!!i,dataUrl:o!=null&&o.url?o.url.substring(0,100)+"...":null}),i){C.err("SocialLoginButtons: Apple  ",i),console.error("Apple  :",i),Ie.error("Apple  .     .","");return}o!=null&&o.url?(C.log("SocialLoginButtons: OAuth URL  ",{url:o.url.substring(0,100)+"..."}),console.log("OAuth  URL:",o.url),window.location.href=o.url):C.log("SocialLoginButtons:    ...")}catch(o){C.err("SocialLoginButtons: Apple  ",o),console.error("Apple  :",o),Ie.error("Apple  .     .","")}}},s=async()=>{if(!e)try{console.warn("Kakao    .")}catch(o){console.error("Kakao  :",o)}};return l.jsxs("div",{className:"auth-social-list",children:[l.jsxs("button",{className:"auth-btn auth-btn-google",onClick:r,type:"button",disabled:e,children:[l.jsx("span",{className:"icon",children:"G"}),l.jsx("span",{children:t==="login"?"Google ":"Google "})]}),l.jsxs("button",{className:"auth-btn auth-btn-apple",onClick:n,type:"button",disabled:e,children:[l.jsx("span",{className:"icon",children:""}),l.jsx("span",{children:t==="login"?"Apple ":"Apple "})]}),l.jsxs("button",{className:"auth-btn auth-btn-kakao",onClick:s,type:"button",disabled:e,children:[l.jsx("span",{className:"icon",children:""}),l.jsx("span",{children:t==="login"?"Kakao ":"Kakao "})]})]})}function fx(){const t=Re(),{isGuest:e}=Ye(),r=()=>{e?t("/home",{replace:!0}):t(-1)},n=()=>{t("/signup",{replace:!0})};return l.jsx("div",{className:"auth-shell",children:l.jsxs("section",{className:"auth-page login",children:[l.jsxs("header",{className:"auth-header",children:[l.jsx("button",{className:"auth-back",onClick:r,"aria-label":"",children:""}),l.jsx("h1",{className:"auth-title",children:""})]}),l.jsxs("div",{className:"auth-hero",children:[l.jsx("div",{className:"auth-mascot-wrap",children:l.jsx("div",{className:"auth-mascot",children:""})}),l.jsx("p",{className:"auth-hero-title",children:" ,  "}),l.jsxs("p",{className:"auth-hero-desc",children:["   ",`
`,"       ."]})]}),l.jsx(kp,{mode:"login"}),l.jsxs("div",{className:"auth-footer",children:[", ?",l.jsx("button",{type:"button",onClick:n,children:"  "})]})]})})}function mx(){const t=Re(),{isGuest:e}=Ye();Nt();const[r,n]=S.useState(!1),[s,o]=S.useState(!1),i=()=>{e?t("/home",{replace:!0}):t(-1)},a=()=>{t("/login",{replace:!0})};return l.jsx("div",{className:"auth-shell",children:l.jsxs("section",{className:"auth-page signup",children:[l.jsxs("header",{className:"auth-header",children:[l.jsx("button",{className:"auth-back",onClick:i,"aria-label":"",children:""}),l.jsx("h1",{className:"auth-title",children:""})]}),l.jsxs("div",{className:"auth-hero",children:[l.jsx("div",{className:"auth-mascot-wrap",children:l.jsx("div",{className:"auth-mascot",children:""})}),l.jsx("p",{className:"auth-hero-title",children:",  ?"}),l.jsxs("p",{className:"auth-hero-desc",children:["    ",`
`,"    ."]})]}),l.jsxs("div",{className:"policy-wrap",children:[l.jsxs("div",{className:"policy-item",children:[l.jsx("input",{type:"checkbox",id:"policy-required",checked:r,onChange:c=>n(c.target.checked)}),l.jsx("label",{htmlFor:"policy-required",children:"()      ."})]}),l.jsxs("div",{className:"policy-item",children:[l.jsx("input",{type:"checkbox",id:"policy-optional",checked:s,onChange:c=>o(c.target.checked)}),l.jsx("label",{htmlFor:"policy-optional",children:"()    ."})]})]}),l.jsx(kp,{mode:"signup",disabled:!r}),l.jsxs("div",{className:"auth-footer",children:["  ?",l.jsx("button",{type:"button",onClick:a,children:""})]})]})})}function gx(){const t=Re(),{user:e,signOut:r}=Ye(),n=Nt(),[s,o]=S.useState(""),[i,a]=S.useState(""),[c,u]=S.useState(!1),[d,f]=S.useState(!1),h=[{id:"not_using",label:" "},{id:"privacy",label:"  "},{id:"features",label:"  "},{id:"difficult",label:" "},{id:"other",label:""}],w=()=>{t(-1)},p=async()=>{var b;if(!c||!e){n.warning("  .","");return}if(confirm("  ?     .")){f(!0),C.log("DeleteAccountPage:  ",{userId:e.id,reason:s});try{const y=s==="other"?i.trim():((b=h.find(m=>m.id===s))==null?void 0:b.label)||s,v={is_deleted:!0,deleted_at:new Date().toISOString(),onboarding_completed:!1,updated_at:new Date().toISOString()};y&&(v.delete_reason=y);const{error:g}=await z.from("users").update(v).eq("id",e.id);if(g)throw C.err("DeleteAccountPage: users  soft delete ",g),g;C.log("DeleteAccountPage: users  soft delete ",{deleteReason:y});try{await Wn(e.id,"account_deleted",{reason:s,reasonText:y}),C.log("DeleteAccountPage: account_deleted   ")}catch(m){C.err("DeleteAccountPage: account_deleted   ",m),console.error("   :",m)}C.log("DeleteAccountPage:  "),n.success(" .   .",""),await r(),t("/login",{replace:!0})}catch(y){C.err("DeleteAccountPage:  ",y),n.error(" .    .",""),f(!1)}}};return l.jsxs("div",{className:"delete-account-page",children:[l.jsxs("div",{className:"delete-account-header",children:[l.jsx("button",{className:"delete-account-back",onClick:w,"aria-label":"",children:""}),l.jsx("h1",{className:"delete-account-title",children:""})]}),l.jsxs("div",{className:"delete-account-content",children:[l.jsxs("div",{className:"delete-account-hero",children:[l.jsx("div",{className:"delete-account-icon",children:""}),l.jsx("h2",{className:"delete-account-hero-title",children:" ?"}),l.jsx("p",{className:"delete-account-hero-desc",children:"     ,   ."})]}),l.jsxs("div",{className:"delete-account-reasons",children:[l.jsx("h3",{className:"delete-account-reasons-title",children:"  "}),l.jsx("div",{className:"delete-account-reasons-list",children:h.map(b=>l.jsxs("label",{className:"delete-account-reason-item",children:[l.jsx("input",{type:"radio",name:"reason",value:b.id,checked:s===b.id,onChange:y=>{o(y.target.value),y.target.value!=="other"&&a("")}}),l.jsx("span",{children:b.label})]},b.id))}),s==="other"&&l.jsx("input",{type:"text",className:"delete-account-other-input",placeholder:" ",value:i,onChange:b=>a(b.target.value),maxLength:200})]}),l.jsx("div",{className:"delete-account-confirm",children:l.jsxs("label",{className:"delete-account-confirm-item",children:[l.jsx("input",{type:"checkbox",checked:c,onChange:b=>u(b.target.checked)}),l.jsx("span",{children:"  ,  ."})]})}),l.jsxs("div",{className:"delete-account-actions",children:[l.jsx("button",{className:"delete-account-btn delete-account-btn-cancel",onClick:w,disabled:d,children:""}),l.jsx("button",{className:"delete-account-btn delete-account-btn-delete",onClick:p,disabled:!c||d,children:d?"  ...":""})]})]})]})}const px=[[1,2,3],[4,5,6],[7,8,9]];function vx({onUnlock:t}){const[e,r]=S.useState(null),[n,s]=S.useState(""),[o,i]=S.useState(""),[a,c]=S.useState(!1),[u,d]=S.useState([]),[f,h]=S.useState(""),w=S.useRef(null);S.useEffect(()=>{const _=ku();r(_)},[]),S.useEffect(()=>{if((e==null?void 0:e.mode)==="pin"&&e.enabled){const _=setTimeout(()=>{var x;(x=w.current)==null||x.focus()},300);return()=>clearTimeout(_)}},[e]);const p=()=>{navigator.vibrate&&navigator.vibrate(50),c(!0),setTimeout(()=>t(),200)},b=_=>{const x=_.replace(/\D/g,"").slice(0,4);s(x),i(""),x.length===4&&(e!=null&&e.pin)&&(x===e.pin?p():(i("PIN  "),s(""),navigator.vibrate&&navigator.vibrate([80,50,80]),setTimeout(()=>{var k;return(k=w.current)==null?void 0:k.focus()},120)))},y=()=>{e!=null&&e.biometricEnabled&&alert("   .")},v=_=>{h(""),d(x=>x.length?x[x.length-1]===_?x.slice(0,-1):x.includes(_)?x:[...x,_]:[_])},g=()=>{d([]),h("")},m=()=>{var x;if(!((x=e==null?void 0:e.pattern)!=null&&x.length)){p();return}if(u.length!==e.pattern.length){h("   .   ."),g();return}e.pattern.every((k,E)=>k===u[E])?p():(h("  ."),g(),navigator.vibrate&&navigator.vibrate([80,50,80]))};return!e||!e.enabled?null:e.mode==="pattern"?l.jsx("div",{className:"lock-screen lock-screen-pattern",children:l.jsxs("div",{className:"lock-screen-content",children:[l.jsx("div",{className:"lock-screen-icon",children:""}),l.jsx("div",{className:"lock-screen-title",children:" "}),l.jsx("div",{className:"lock-screen-desc",children:"    ."}),l.jsx("div",{className:"lock-pattern-grid",children:px.map(_=>_.map(x=>{const k=u.indexOf(x);return l.jsx("button",{type:"button",className:`lock-pattern-node ${k>=0?"active":""}`,onClick:()=>v(x),children:k>=0?k+1:""},x)}))}),f&&l.jsx("div",{className:"lock-pin-error",children:f}),l.jsxs("div",{className:"lock-pattern-actions",children:[l.jsx("button",{type:"button",className:"lock-btn lock-btn-secondary",onClick:g,children:""}),l.jsx("button",{type:"button",className:"lock-btn lock-btn-primary",disabled:u.length<1||a,onClick:m,children:""})]})]})}):l.jsx("div",{className:"lock-screen lock-screen-pin",children:l.jsxs("div",{className:"lock-screen-content",children:[l.jsx("div",{className:"lock-screen-icon",children:""}),l.jsx("div",{className:"lock-screen-title",children:" "}),l.jsx("div",{className:"lock-screen-desc",children:"PIN "}),l.jsx("div",{className:"lock-pin-dots",children:[0,1,2,3].map(_=>l.jsx("div",{className:`lock-pin-dot ${_<n.length?"filled":""} ${o?"error":""}`},_))}),o&&l.jsx("div",{className:"lock-pin-error",children:o}),l.jsx("input",{ref:w,type:"password",inputMode:"numeric",maxLength:4,value:n,onChange:_=>b(_.target.value),className:"lock-pin-hidden-input",autoFocus:!0,disabled:a}),e.biometricEnabled&&l.jsx("button",{type:"button",className:"lock-biometric-btn",onClick:y,children:"  "})]})})}class yx{constructor(){Me(this,"listeners",new Set)}subscribe(e){this.listeners.add(e)}unsubscribe(e){this.listeners.delete(e)}emit(e){this.listeners.forEach(r=>r(e))}}const qo=new yx;function Th(){const[t,e]=S.useState(null);return S.useEffect(()=>{const r=n=>{e(n),window.clearTimeout(qo._t),qo._t=window.setTimeout(()=>e(null),2e3)};return qo.subscribe(r),()=>qo.unsubscribe(r)},[]),t?l.jsxs("div",{style:{position:"fixed",left:"50%",transform:"translateX(-50%)",bottom:72,background:"#1F2B52",color:"#F6F9F8",padding:"10px 14px",borderRadius:12,border:"1px solid #2A355A",boxShadow:"0 10px 20px rgba(0,0,0,.35)",fontSize:13,display:"inline-flex",alignItems:"center",gap:6,zIndex:40,maxWidth:320,textAlign:"center"},children:[l.jsx("span",{children:""}),l.jsx("span",{children:t})]}):null}function wx({onBack:t,onSocialClick:e,onOpenLogin:r,loading:n=!1}){const[s,o]=S.useState(!1),[i,a]=S.useState(!1),c=h=>{o(h)},u=h=>{a(h)},d=h=>{s&&e(h)},f=[{provider:"google",label:"Google ",icon:"G",className:"auth-btn-google"},{provider:"apple",label:"Apple ",icon:"",className:"auth-btn-apple"},{provider:"kakao",label:"  ",icon:"",className:"auth-btn-kakao"},{provider:"facebook",label:"Facebook ",icon:"f",className:"auth-btn-facebook"},{provider:"line",label:"LINE  ",icon:"L",className:"auth-btn-line"}];return l.jsxs("div",{className:"signup-onboarding-step",children:[l.jsxs("header",{className:"auth-header",children:[l.jsx("button",{className:"auth-back",onClick:t,"aria-label":"",children:""}),l.jsx("h1",{className:"auth-title",children:""})]}),l.jsxs("div",{className:"auth-hero",children:[l.jsx("div",{className:"auth-mascot-wrap",children:l.jsx("div",{className:"auth-mascot",children:""})}),l.jsx("p",{className:"auth-hero-title",children:",  ?"}),l.jsxs("p",{className:"auth-hero-desc",children:["    ",`
`,"    ."]})]}),l.jsxs("div",{className:"policy-wrap",children:[l.jsxs("div",{className:"policy-item",children:[l.jsx("input",{type:"checkbox",id:"policy-required",checked:s,onChange:h=>c(h.target.checked)}),l.jsx("label",{htmlFor:"policy-required",children:"()      ."})]}),l.jsxs("div",{className:"policy-item",children:[l.jsx("input",{type:"checkbox",id:"policy-optional",checked:i,onChange:h=>u(h.target.checked)}),l.jsx("label",{htmlFor:"policy-optional",children:"()    ."})]})]}),l.jsx("div",{className:"auth-social-list",children:f.map(h=>l.jsxs("button",{className:`auth-btn ${h.className}`,onClick:()=>d(h.provider),disabled:!s||n,children:[l.jsx("span",{className:"icon",children:h.icon}),l.jsx("span",{children:h.label})]},h.provider))}),l.jsxs("div",{className:"auth-footer",children:["  ?",l.jsx("button",{type:"button",onClick:r||(()=>{}),children:""})]})]})}const _n="onboardingComplete",el="isGuest";function _x(){const t=Re(),[e]=du(),{user:r,session:n,loading:s,isGuest:o,signInWithGoogle:i,signInWithApple:a,signInWithKakao:c,setGuestMode:u,refreshUserProfile:d}=Ye(),f=Nt(),[h,w]=S.useState(0),[p,b]=S.useState(""),[y,v]=S.useState(!1),[g,m]=S.useState("     .");S.useEffect(()=>{const I=e.get("step");if(console.log("[OnboardingGuest] URL  ",{stepParam:I,currentStep:h,search:window.location.search,hash:window.location.hash,pathname:window.location.pathname}),C.log("OnboardingGuest: URL  ",{stepParam:I,currentStep:h,search:window.location.search,hash:window.location.hash}),I){const V=parseInt(I,10);console.log("[OnboardingGuest] step  ",{stepParam:I,stepValue:V,isValid:!isNaN(V)&&V>=0&&V<=7}),!isNaN(V)&&V>=0&&V<=7?V!==h?(console.log("[OnboardingGuest] step  (URL )",{from:h,to:V}),C.log("OnboardingGuest: step  step ",{from:h,to:V}),w(V)):console.log("[OnboardingGuest] step  ",{step:h}):console.warn("[OnboardingGuest]   step ",{stepParam:I,stepValue:V})}else if(h>0){console.log("[OnboardingGuest] step  , URL ",{currentStep:h});const V=new URLSearchParams;V.set("step",String(h)),t(`/onboarding?${V.toString()}`,{replace:!0})}},[e,t]),S.useEffect(()=>{const I=e.get("step");!s&&n&&r&&!I&&te.getItem(_n)==="true"&&(C.log("OnboardingGuest:   +  ,   (step  )"),t("/",{replace:!0}))},[s,n,r,t,e]);const _=I=>{w(I);const V=new URLSearchParams(e);V.set("step",String(I)),t(`/onboarding?${V.toString()}`,{replace:!0}),console.log("[OnboardingGuest] showStep - step  URL ",{step:I,url:`/onboarding?${V.toString()}`})},x=()=>{_(1)},k=()=>{const I=e.get("step");if(h===4&&I==="4"){console.log("[OnboardingGuest] Step 4   ,  "),C.log("OnboardingGuest: Step 4   ,  "),t("/",{replace:!0});return}h>0&&_(h-1)},E=()=>{console.log("[Onboarding] handleNext ",{currentStep:h}),h<7&&_(h+1)},j=()=>{C.log("OnboardingGuest: handleBrowse "),te.setItem(el,"true"),te.setItem(_n,"true"),C.log("OnboardingGuest:     ",{guestMode:te.getItem(el),onboardingComplete:te.getItem(_n)}),u(!0),f.success("  "),C.log("OnboardingGuest:  "),t("/home",{replace:!0})},N=()=>{_(4)},P=async I=>{C.log(`OnboardingGuest: ${I}  `);try{if(I==="google")await i();else if(I==="apple")await a();else if(I==="kakao")await c();else if(I==="facebook"||I==="line"){f.info(`${I==="facebook"?"Facebook":"LINE"}   .`,"");return}}catch(V){C.err("OnboardingGuest:  :",V),f.error(" .    .","")}},M=I=>/^[--a-zA-Z0-9]{1,12}$/.test(I.trim()),X=I=>{b(I),y&&v(!M(I))},R=()=>{const I=p.trim();if(!M(I)){v(!0);return}v(!1),m(`  "${I}"    .`),_(7)},A=async()=>{if(C.log("OnboardingGuest: handleGoHome "),n&&r&&p.trim())try{console.log("[OnboardingGuest]   :",{userId:r.id,seedName:p.trim()});const{supabase:I}=await Bi(async()=>{const{supabase:re}=await Promise.resolve().then(()=>vh);return{supabase:re}},void 0),{error:V}=await I.from("user_settings").upsert({user_id:r.id,seed_name:p.trim(),updated_at:new Date().toISOString()},{onConflict:"user_id"});V?(console.error("[OnboardingGuest]   :",V),C.err("OnboardingGuest:   :",V)):console.log("[OnboardingGuest]   :",{seedName:p.trim()})}catch(I){console.error("[OnboardingGuest]    :",I),C.err("OnboardingGuest:    :",I)}if(te.setItem(_n,"true"),C.log("OnboardingGuest:    ",{onboardingComplete:te.getItem(_n)}),o||te.removeItem(el),n&&r)try{C.log("OnboardingGuest: users   ");const{supabase:I}=await Bi(async()=>{const{supabase:re}=await Promise.resolve().then(()=>vh);return{supabase:re}},void 0),{error:V}=await I.from("users").update({onboarding_completed:!0,updated_at:new Date().toISOString()}).eq("id",r.id);V?(console.error("[OnboardingGuest] users   :",V),C.err("OnboardingGuest: users   :",V)):(console.log("[OnboardingGuest] users    - onboarding_completed: true"),C.log("OnboardingGuest: users   "),te.setItem(_n,"true"),console.log("[OnboardingGuest]   onboarding_completed : true"),console.log("[OnboardingGuest] userProfile  ..."),await d(),await new Promise(re=>setTimeout(re,300)),await d(),console.log("[OnboardingGuest] userProfile  , /home "))}catch(I){C.err("OnboardingGuest: users    :",I)}f.success("  "),C.log("OnboardingGuest:  "),t("/home",{replace:!0})};return l.jsx("div",{className:"onboarding-shell",children:l.jsxs("div",{className:"onboarding-app",children:[l.jsxs("header",{className:"onboarding-brand",children:[l.jsx("div",{className:"onboarding-logo",children:""}),l.jsxs("div",{children:[l.jsx("div",{className:"onboarding-brand-title",children:", "}),l.jsx("div",{className:"onboarding-brand-sub",children:" ,   "})]})]}),l.jsxs("main",{className:"onboarding-card",children:[l.jsxs("section",{className:`onboarding-panel ${h!==0?"hidden":""}`,"data-step":"0",children:[l.jsx("div",{className:"onboarding-eyebrow",children:",  "}),l.jsxs("h1",{children:[" ",`
`," ."]}),l.jsx("p",{className:"onboarding-desc",children:"   ,     ."}),l.jsxs("div",{className:"onboarding-tags",children:[l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"})]}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsx("div",{className:"onboarding-bottom onboarding-center",children:l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-full",onClick:x,children:", "})})]}),l.jsxs("section",{className:`onboarding-panel ${h!==1?"hidden":""}`,"data-step":"1",children:[l.jsxs("div",{className:"onboarding-bar",children:[l.jsx("div",{className:"onboarding-dot active"}),l.jsx("div",{className:"onboarding-dot"}),l.jsx("div",{className:"onboarding-dot"})]}),l.jsx("h1",{children:"  "}),l.jsx("p",{className:"onboarding-desc",children:"   ,   ."}),l.jsxs("div",{className:"onboarding-tags",children:[l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"})]}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsxs("div",{className:"onboarding-row onboarding-bottom",children:[l.jsx("button",{className:"onboarding-btn-ghost",onClick:k,children:""}),l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-wide",onClick:E,children:""})]})]}),l.jsxs("section",{className:`onboarding-panel ${h!==2?"hidden":""}`,"data-step":"2",children:[l.jsxs("div",{className:"onboarding-bar",children:[l.jsx("div",{className:"onboarding-dot active"}),l.jsx("div",{className:"onboarding-dot active"}),l.jsx("div",{className:"onboarding-dot"})]}),l.jsx("h1",{children:" "}),l.jsx("p",{className:"onboarding-desc",children:"    .    ."}),l.jsxs("div",{className:"onboarding-tags",children:[l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"}),l.jsx("span",{className:"onboarding-tag",children:"#"})]}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsxs("div",{className:"onboarding-row onboarding-bottom",children:[l.jsx("button",{className:"onboarding-btn-ghost",onClick:k,children:""}),l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-wide",onClick:E,children:""})]})]}),l.jsxs("section",{className:`onboarding-panel ${h!==3?"hidden":""}`,"data-step":"3",children:[l.jsxs("div",{className:"onboarding-bar",children:[l.jsx("div",{className:"onboarding-dot active"}),l.jsx("div",{className:"onboarding-dot active"}),l.jsx("div",{className:"onboarding-dot active"})]}),l.jsx("h1",{children:"   ?"}),l.jsx("p",{className:"onboarding-desc",children:" ,     ."}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsxs("div",{className:"onboarding-bottom",children:[l.jsxs("div",{className:"onboarding-row",style:{marginBottom:"12px"},children:[l.jsx("button",{className:"onboarding-btn-ghost",onClick:k,children:""}),l.jsx("button",{className:"onboarding-btn onboarding-btn-outline onboarding-btn-wide",onClick:j,children:" !"})]}),l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-full",onClick:N,children:""})]})]}),l.jsx("section",{className:`onboarding-panel ${h!==4?"hidden":""}`,"data-step":"4",children:l.jsx(wx,{onBack:k,onSocialClick:P,onOpenLogin:()=>{console.log("[OnboardingGuest]   "),C.log("OnboardingGuest:   "),t("/login",{replace:!0})},loading:s})}),l.jsxs("section",{className:`onboarding-panel ${h!==5?"hidden":""}`,"data-step":"5",children:[l.jsx("div",{className:"onboarding-eyebrow",children:"  "}),l.jsx("h1",{children:" "}),l.jsx("p",{className:"onboarding-desc",children:"      ."}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsxs("div",{className:"onboarding-bottom onboarding-row",children:[l.jsx("button",{className:"onboarding-btn-ghost",onClick:k,children:""}),l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-wide",onClick:I=>{console.log("[Onboarding]     ",{step:h,event:I}),I.preventDefault(),I.stopPropagation(),E()},type:"button",style:{position:"relative",zIndex:10},children:"  "})]})]}),l.jsxs("section",{className:`onboarding-panel ${h!==6?"hidden":""}`,"data-step":"6",children:[l.jsx("div",{className:"onboarding-eyebrow",children:"  "}),l.jsxs("h1",{children:["  ",`
`,"?"]}),l.jsx("div",{className:"onboarding-desc",children:" 12,  "}),l.jsxs("div",{style:{margin:"12px 0"},children:[l.jsx("input",{id:"seedName",className:"onboarding-input",maxLength:12,placeholder:": , , ",value:p,onChange:I=>X(I.target.value)}),l.jsx("div",{className:`onboarding-error ${y?"show":""}`,children:" 1~12 //  ."})]}),l.jsx("div",{className:"onboarding-bottom",children:l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-full",onClick:R,disabled:p.trim().length===0,style:{opacity:p.trim().length===0?.5:1,cursor:p.trim().length===0?"not-allowed":"pointer"},children:"  "})})]}),l.jsxs("section",{className:`onboarding-panel ${h!==7?"hidden":""}`,"data-step":"7",children:[l.jsx("div",{className:"onboarding-eyebrow onboarding-center",children:" "}),l.jsx("div",{className:"onboarding-hero",children:l.jsxs("div",{className:"onboarding-circle",children:[l.jsx("div",{className:"onboarding-orbit"}),l.jsx("div",{className:"onboarding-emoji",children:""})]})}),l.jsx("h1",{className:"onboarding-center",children:"  "}),l.jsx("p",{className:"onboarding-desc onboarding-center",id:"finalCopy",children:g}),l.jsx("div",{className:"onboarding-bottom",children:l.jsx("button",{className:"onboarding-btn onboarding-btn-primary onboarding-btn-full",onClick:A,children:"  "})})]})]})]})})}function Rh({message:t=" ..."}){return l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--ms-surface)",color:"var(--ms-ink)"},children:[l.jsx("div",{style:{fontSize:48,marginBottom:16,animation:"spin 1s linear infinite"},children:""}),l.jsx("p",{style:{fontSize:14,color:"var(--ms-ink-soft)",fontWeight:500},children:t}),l.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const bn="onboardingComplete",bx="isGuest";function Sx({children:t}){const e=Re(),r=Ft(),{session:n,loading:s,sessionInitialized:o,isGuest:i,userProfile:a,refreshUserProfile:c}=Ye(),u=S.useRef(null),d=S.useRef(null),f=S.useRef(r.pathname),h=S.useRef(!1),w=S.useRef(a),p=S.useRef(0),b=500;S.useEffect(()=>{s?d.current||(d.current=Date.now()):d.current=null},[s]),S.useEffect(()=>{if(s&&d.current){const j=setTimeout(()=>{const N=Date.now()-d.current;console.error("[Guard]  10  :",{elapsed:N,path:r.pathname,sessionInitialized:o,hasSession:!!n})},1e4);return()=>clearTimeout(j)}},[s,r.pathname,o,n]),S.useEffect(()=>{var T;if(f.current!==r.pathname&&(console.log("[Guard]   , redirectedRef :",{from:f.current,to:r.pathname}),u.current=null,f.current=r.pathname),w.current!==a&&(console.log("[Guard] userProfile  :",{from:w.current,to:a}),w.current=a,a!==null&&(h.current=!1)),console.log("[Guard] useEffect ",{path:r.pathname,loading:s,sessionInitialized:o,hasSession:!!n,userId:(T=n==null?void 0:n.user)==null?void 0:T.id,isGuest:i,userProfile:a,redirected:u.current,refreshAttempted:h.current}),C.log("Guard: useEffect ",{path:r.pathname,loading:s,sessionInitialized:o,hasSession:!!n,isGuest:i,redirected:u.current}),s){console.log("[Guard] loading=true,   ( )"),C.log("Guard: loading=true,   ( )");return}if(!o){console.log("[Guard] sessionInitialized=false,  "),C.log("Guard: sessionInitialized=false,  ");return}const j=te.getItem(bx)==="true";let N=!1;if(n&&a!==null)N=a.onboarding_completed===!0,console.log("[Guard] userProfile onboarding_completed :",{onboarding_completed:a.onboarding_completed,is_deleted:a.is_deleted,onboardingComplete:N}),a.onboarding_completed===!0?te.setItem(bn,"true"):te.removeItem(bn);else if(n&&a===null){const L=te.getItem(bn)==="true";console.warn("[Guard] userProfile null. DB  :",{localOnboarding:L,userId:n.user.id,note:"DB userProfile  ..."}),c&&!u.current&&!h.current?(console.log("[Guard] userProfile null   ( )"),h.current=!0,c().catch(U=>{console.error("[Guard] refreshUserProfile :",U),h.current=!1})):h.current&&console.log("[Guard]    skip (  )"),N=L}else j&&(N=te.getItem(bn)==="true");const P=(a==null?void 0:a.is_deleted)===!0;console.log("[Guard]  ",{path:r.pathname,hasSession:!!n,isGuest:i,guestMode:j,onboardingComplete:N,isDeleted:P,userProfile:a,userProfileIsNull:a===null}),C.log("Guard:  ",{path:r.pathname,hasSession:!!n,isGuest:i,guestMode:j,onboardingComplete:N,isDeleted:P,userProfile:a});const M=r.pathname.startsWith("/onboarding"),X=r.pathname==="/debug",R=r.pathname.startsWith("/auth/callback"),A=r.pathname==="/login",I=r.pathname==="/signup";if(X||R||A||I){C.log("Guard:  ,  ",{path:r.pathname}),u.current=null;return}const re=["/","/home","/record","/forest","/mypage"].some(L=>L==="/"?r.pathname==="/"||r.pathname==="":r.pathname===L||r.pathname.startsWith(L+"/"));if(re){console.log("[Guard]     ( ):",{path:r.pathname,userProfileIsNull:a===null,userProfileOnboardingCompleted:a==null?void 0:a.onboarding_completed,onboardingComplete:N}),C.log("Guard:     ( )",{path:r.pathname}),u.current=null;return}if(M){if(n&&a!==null&&a.onboarding_completed===!0){console.log("[Guard]       ,  :",{path:r.pathname,userProfileOnboardingCompleted:a.onboarding_completed});const L=Date.now();u.current!=="/home"&&L-p.current>b&&(C.log("GUARD -> to /home",{reason:"  ,    "}),u.current="/home",p.current=L,e("/home",{replace:!0}));return}if(n&&a===null&&te.getItem(bn)==="true"){console.log("[Guard] userProfile null   onboarding_completed=true .  :",{path:r.pathname});const U=Date.now();u.current!=="/home"&&U-p.current>b&&(C.log("GUARD -> to /home",{reason:"  onboarding_completed=true (userProfile null)"}),u.current="/home",p.current=U,e("/home",{replace:!0}));return}console.log("[Guard]   -   ,   ",{path:r.pathname,hasSession:!!n,userProfileIsNull:a===null,onboardingCompleted:a==null?void 0:a.onboarding_completed}),C.log("Guard:  ,  ",{path:r.pathname}),u.current=null;return}if(n&&P&&!M){const L=Date.now();u.current!=="/onboarding"&&L-p.current>b&&(C.log("GUARD -> to /onboarding",{reason:" ,  "}),u.current="/onboarding",p.current=L,e("/onboarding?step=5",{replace:!0}));return}if(C.log("Guard:   ",{atOnboarding:M,hasSession:!!n,isGuest:i,guestMode:j,onboardingComplete:N,isAllowedPath:re}),n&&!N&&!M&&!re){if(a!==null&&a.onboarding_completed===!1){console.log("[Guard] DB  false,  :",{userProfileOnboardingCompleted:a.onboarding_completed,path:r.pathname});const $=Date.now();u.current!=="/onboarding"&&$-p.current>b&&(C.log("GUARD -> to /onboarding",{reason:"DB  false (  )"}),u.current="/onboarding",p.current=$,e("/onboarding?step=5",{replace:!0}));return}const L=te.getItem(bn)==="true";if(a===null&&L){console.log("[Guard] userProfile null   onboarding_completed=true .    ()"),u.current=null;return}if(a===null&&u.current==="/onboarding"){console.warn("[Guard] userProfile null  /onboarding .   ");return}const U=Date.now();u.current!=="/onboarding"&&U-p.current>b&&(console.log("[Guard] -> to /onboarding",{reason:"  +  ",userProfileIsNull:a===null,localOnboarding:L,path:r.pathname}),C.log("GUARD -> to /onboarding",{reason:"  +  "}),u.current="/onboarding",p.current=U,e("/onboarding?step=5",{replace:!0}));return}if(!n&&!j&&!M&&!N){const L=Date.now();u.current!=="/onboarding"&&L-p.current>b&&(C.log("GUARD -> to /onboarding",{reason:"  +   +  "}),u.current="/onboarding",p.current=L,e("/onboarding",{replace:!0}));return}if(N&&re){C.log("Guard:   ,    ",{path:r.pathname,isGuest:j,hasSession:!!n}),u.current=null;return}C.log("Guard:  ",{path:r.pathname}),u.current=null},[r.pathname,e,n,o,s,i,a,c]);const y=r.pathname.startsWith("/onboarding"),v=r.pathname==="/debug",g=r.pathname.startsWith("/auth/callback"),m=r.pathname==="/login",_=r.pathname==="/signup",x=y||v||g||m||_,k=y?!1:s,E=y?!0:o;return k&&!x?(console.log("[Guard] loading=true,  "),C.log("Guard: loading=true,   ( )"),l.jsx(Rh,{message:"   ..."})):!E&&!x?(console.log("[Guard] sessionInitialized=false,  "),C.log("Guard: sessionInitialized=false,  "),l.jsx(Rh,{message:"   ..."})):(C.log("Guard: children ",{path:r.pathname}),l.jsx(l.Fragment,{children:t}))}function xx(){const t=Ft(),[e,r]=S.useState(!1),[n,s]=S.useState(!0);S.useEffect(()=>{C.log("AppRoutes: ",{path:t.pathname});const i=()=>{const c=ku(),u=sessionStorage.getItem(li)==="true";c.enabled?r(!u):(sessionStorage.removeItem(li),r(!1)),s(!1),C.log("AppRoutes:   ",{isLocked:c.enabled&&!u})};i();const a=c=>{c.key===xu&&i()};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)},[t.pathname]);const o=()=>{sessionStorage.setItem(li,"true"),r(!1)};return n?null:e?l.jsxs(l.Fragment,{children:[l.jsx(vx,{onUnlock:o}),l.jsx(Th,{})]}):l.jsxs(Sx,{children:[l.jsxs(rw,{children:[l.jsx(Ze,{path:"/auth/callback",element:l.jsx(dx,{})}),l.jsx(Ze,{path:"/debug",element:l.jsx(hx,{})}),l.jsx(Ze,{path:"/onboarding",element:l.jsx(_x,{})}),l.jsx(Ze,{path:"/login",element:l.jsx(fx,{})}),l.jsx(Ze,{path:"/signup",element:l.jsx(mx,{})}),l.jsx(Ze,{path:"/delete-account",element:l.jsx(gx,{})}),l.jsx(Ze,{path:"/",element:l.jsx(Eh,{})}),l.jsx(Ze,{path:"/home",element:l.jsx(Eh,{})}),l.jsx(Ze,{path:"/record",element:l.jsx(MS,{})}),l.jsx(Ze,{path:"/forest",element:l.jsx(jh,{})}),l.jsx(Ze,{path:"/forest/my-posts",element:l.jsx(jh,{mode:"mine"})}),l.jsx(Ze,{path:"/forest/:postId",element:l.jsx(ux,{})}),l.jsx(Ze,{path:"/mypage",element:l.jsx(sx,{})}),l.jsx(Ze,{path:"*",element:l.jsx(ew,{to:"/",replace:!0})})]}),l.jsx(Th,{})]})}function kx(){return l.jsx(xx,{})}C.log("main.tsx:   ");const Ex=te.test();C.log("main.tsx: Storage :",Ex);const Ep=document.getElementById("root");if(!Ep)throw C.err("main.tsx: Root element not found"),new Error("Root element not found");C.log("main.tsx: Root element ,  ");let Fi=!1,xt=null;const jx=new PerformanceObserver(t=>{for(const e of t.getEntries())(e.name==="first-contentful-paint"||e.name==="first-paint")&&(Fi=!0,C.log("main.tsx: First paint ",{time:e.startTime}),xt&&(xt.remove(),xt=null))});try{jx.observe({entryTypes:["paint"]})}catch{}const Eu=()=>{xt&&(xt.remove(),xt=null,C.log("main.tsx:   "))};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{Fi&&Eu()},1e3)}):Fi=!0;setTimeout(()=>{!Fi&&!xt&&(C.warn("main.tsx: 5   paint  -   "),xt=document.createElement("div"),xt.id="loading-delay-banner",xt.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: #fffbe6;
      border-bottom: 1px solid #fbbf24;
      padding: 12px 16px;
      z-index: 10000;
      font-size: 14px;
      color: #92400e;
      text-align: center;
    `,xt.innerHTML=`
             <a href="/debug" style="color: #d97706; font-weight: 600;">/debug</a>   
    `,document.body.appendChild(xt),setTimeout(()=>{Eu()},1e4))},5e3);window.__removeLoadingBanner=Eu;qm(Ep).render(l.jsx(Wh.StrictMode,{children:l.jsx(Qb,{children:l.jsx(dw,{children:l.jsx(Vb,{children:l.jsx(Kb,{children:l.jsx(kx,{})})})})})}));C.log("main.tsx:  ");
