# 이미지 2개 제한 기능 테스트 리포트

## 테스트 일시
- 시작: [날짜/시간]
- 종료: [날짜/시간]

## 테스트 환경
- 브라우저: Chrome/Edge
- 개발 서버: `http://localhost:5173`
- 기능: 감정 기록 이미지 업로드 (최대 2개 제한)

---

## 코드 검토 결과

### ✅ 구현 상태
- ✅ `onPhotosChange` 함수에 최대 2개 제한 로직 구현 완료
- ✅ 현재 이미지 개수 확인 로직 구현 완료
- ✅ 남은 슬롯 계산 로직 구현 완료
- ✅ 경고 메시지 표시 로직 구현 완료
- ✅ UI 안내 문구 업데이트 완료 ("최대 2개" 추가)

### 📝 코드 분석

#### `onPhotosChange` 함수 로직
```typescript
const MAX_PHOTOS = 2; // 최대 이미지 개수 제한
const currentPhotoCount = photos.length;

// 이미 2개가 있으면 추가 불가
if (currentPhotoCount >= MAX_PHOTOS) {
  notify.warning('이미지는 최대 2개까지 첨부할 수 있어요', '⚠️');
  return;
}

const remainingSlots = MAX_PHOTOS - currentPhotoCount; // 남은 슬롯 개수
// 남은 슬롯만큼만 추가
```

**동작 방식**:
1. 현재 이미지 개수 확인
2. 2개 이상이면 경고 메시지 표시 후 종료
3. 남은 슬롯 개수 계산
4. 남은 슬롯만큼만 추가

---

## 기능 테스트 결과

### 테스트 1: 이미지 0개 → 1개 추가
- [ ] 기록 화면에서 "📷 사진 추가" 버튼 클릭
- [ ] 이미지 파일 1개 선택
- [ ] 이미지 미리보기 1개 표시 확인
- [ ] 추가 성공 확인

**예상 결과**: ✅ 이미지 1개 추가 성공

### 테스트 2: 이미지 1개 → 2개 추가
- [ ] 이미지 1개가 있는 상태에서 "📷 사진 추가" 버튼 클릭
- [ ] 이미지 파일 1개 선택
- [ ] 이미지 미리보기 2개 표시 확인
- [ ] 추가 성공 확인

**예상 결과**: ✅ 이미지 2개 추가 성공

### 테스트 3: 이미지 2개 → 추가 불가
- [ ] 이미지 2개가 있는 상태에서 "📷 사진 추가" 버튼 클릭
- [ ] 이미지 파일 선택 시도
- [ ] 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요 ⚠️"
- [ ] 이미지가 추가되지 않음 확인 (여전히 2개)

**예상 결과**: ✅ 경고 메시지 표시, 추가 차단

### 테스트 4: 이미지 삭제 후 다시 추가
- [ ] 이미지 2개가 있는 상태
- [ ] 이미지 1개 삭제 (X 버튼 클릭)
- [ ] 이미지 미리보기 1개로 감소 확인
- [ ] "📷 사진 추가" 버튼 클릭
- [ ] 이미지 파일 1개 선택
- [ ] 이미지 미리보기 2개로 증가 확인
- [ ] 추가 성공 확인

**예상 결과**: ✅ 삭제 후 다시 추가 가능

### 테스트 5: 여러 파일 선택 시 슬롯 제한
- [ ] 이미지 1개가 있는 상태
- [ ] "📷 사진 추가" 버튼 클릭
- [ ] 이미지 파일 3개 동시 선택
- [ ] 이미지 미리보기 2개만 표시 확인 (1개 추가됨)
- [ ] 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요. 1개만 추가되었어요. ⚠️"

**예상 결과**: ✅ 남은 슬롯만큼만 추가, 경고 메시지 표시

### 테스트 6: UI 안내 문구 확인
- [ ] 기록 화면에서 "사진 첨부 (선택)" 섹션 확인
- [ ] 안내 문구에 "최대 2개" 표시 확인: "(JPG, PNG / 10MB 이하 / 최대 2개)"

**예상 결과**: ✅ 안내 문구에 "최대 2개" 표시

---

## 테스트 결과 요약

### 통과한 테스트
- [ ] 테스트 1: 이미지 0개 → 1개 추가
- [ ] 테스트 2: 이미지 1개 → 2개 추가
- [ ] 테스트 3: 이미지 2개 → 추가 불가
- [ ] 테스트 4: 이미지 삭제 후 다시 추가
- [ ] 테스트 5: 여러 파일 선택 시 슬롯 제한
- [ ] 테스트 6: UI 안내 문구 확인

### 실패한 테스트
- [ ] [테스트 항목] - [실패 이유]

### 발견된 이슈
1. [이슈 설명]
   - 재현 단계:
   - 예상 결과:
   - 실제 결과:
   - 스크린샷:

---

## 코드 품질 평가

### 강점
1. ✅ 명확한 제한 로직 (MAX_PHOTOS = 2)
2. ✅ 사용자 친화적인 경고 메시지
3. ✅ 남은 슬롯 계산 로직 정확함
4. ✅ UI 안내 문구 업데이트 완료

### 개선 가능 사항
1. ⚠️ 현재는 첫 번째 이미지만 DB에 저장됨 (`photoToUpload = photos.find(...)`)
   - 향후 여러 이미지 지원 시 DB 스키마 변경 필요 (`image_urls` 배열 또는 별도 테이블)
2. ⚠️ 여러 이미지 선택 시 경고 메시지가 정확히 표시되는지 확인 필요

---

## 다음 단계

1. [ ] 실제 브라우저에서 테스트 진행
2. [ ] 발견된 이슈 수정
3. [ ] 재테스트 진행
4. [ ] 프로덕션 배포 준비

---

## 참고사항

### 현재 구현 제한사항
- DB 스키마: `emotions.image_url`은 단일 URL만 저장
- 코드: `photos.find((p) => p.file !== null)`로 첫 번째 파일만 업로드
- 향후 여러 이미지 지원 시:
  - DB 스키마: `image_urls` 배열 또는 `emotion_images` 별도 테이블
  - 코드: 모든 `photos` 배열의 파일 업로드

### 현재 동작
- 사용자는 최대 2개까지 선택 가능
- 실제로는 첫 번째 이미지만 업로드 및 저장됨
- 2개 제한은 UI 레벨에서만 적용됨
