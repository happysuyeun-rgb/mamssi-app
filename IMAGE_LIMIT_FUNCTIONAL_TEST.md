# 이미지 2개 제한 기능 테스트 가이드

## 테스트 준비

### 1. 개발 서버 실행 확인
```bash
npm run dev
```

### 2. 브라우저 접속
- URL: `http://localhost:5173`
- 로그인 상태 확인

### 3. 기록 화면 접속
- `/record` 또는 홈 화면에서 기록 버튼 클릭

---

## 테스트 시나리오

### ✅ 시나리오 1: 이미지 0개 → 1개 추가

**단계**:
1. 기록 화면 접속 (`/record`)
2. "📷 사진 추가" 버튼 클릭
3. 이미지 파일 1개 선택 (JPG, 5MB 이하)
4. 이미지 미리보기 1개 표시 확인
5. 추가 성공 확인

**예상 결과**: ✅ 이미지 1개 추가 성공

**확인 사항**:
- [ ] 이미지 미리보기 썸네일 표시
- [ ] X 버튼으로 삭제 가능
- [ ] 안내 문구에 "최대 2개" 표시 확인

---

### ✅ 시나리오 2: 이미지 1개 → 2개 추가

**단계**:
1. 이미지 1개가 있는 상태
2. "📷 사진 추가" 버튼 클릭
3. 이미지 파일 1개 선택
4. 이미지 미리보기 2개 표시 확인
5. 추가 성공 확인

**예상 결과**: ✅ 이미지 2개 추가 성공

**확인 사항**:
- [ ] 이미지 미리보기 2개 표시
- [ ] 각 이미지에 X 버튼 표시
- [ ] 두 이미지 모두 삭제 가능

---

### ✅ 시나리오 3: 이미지 2개 → 추가 불가

**단계**:
1. 이미지 2개가 있는 상태
2. "📷 사진 추가" 버튼 클릭
3. 이미지 파일 선택 시도
4. 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요 ⚠️"
5. 이미지가 추가되지 않음 확인 (여전히 2개)

**예상 결과**: ✅ 경고 메시지 표시, 추가 차단

**확인 사항**:
- [ ] 경고 토스트 메시지 표시
- [ ] 이미지 개수 변화 없음 (여전히 2개)
- [ ] 파일 선택 다이얼로그가 닫힘

---

### ✅ 시나리오 4: 이미지 삭제 후 다시 추가

**단계**:
1. 이미지 2개가 있는 상태
2. 이미지 1개 삭제 (X 버튼 클릭)
3. 이미지 미리보기 1개로 감소 확인
4. "📷 사진 추가" 버튼 클릭
5. 이미지 파일 1개 선택
6. 이미지 미리보기 2개로 증가 확인
7. 추가 성공 확인

**예상 결과**: ✅ 삭제 후 다시 추가 가능

**확인 사항**:
- [ ] 이미지 삭제 시 미리보기 제거
- [ ] 삭제 후 다시 추가 가능
- [ ] 최대 2개 제한 유지

---

### ✅ 시나리오 5: 여러 파일 선택 시 슬롯 제한

**단계**:
1. 이미지 1개가 있는 상태
2. "📷 사진 추가" 버튼 클릭
3. 이미지 파일 3개 동시 선택
4. 이미지 미리보기 2개만 표시 확인 (1개 추가됨)
5. 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요. 1개만 추가되었어요. ⚠️"

**예상 결과**: ✅ 남은 슬롯만큼만 추가, 경고 메시지 표시

**확인 사항**:
- [ ] 이미지 미리보기 2개만 표시
- [ ] 경고 토스트 메시지 표시
- [ ] 선택한 3개 중 1개만 추가됨

---

### ✅ 시나리오 6: UI 안내 문구 확인

**단계**:
1. 기록 화면에서 "사진 첨부 (선택)" 섹션 확인
2. 안내 문구 확인: "오늘을 떠올리게 하는 사진이 있다면 함께 남겨보세요. (JPG, PNG / 10MB 이하 / 최대 2개)"

**예상 결과**: ✅ 안내 문구에 "최대 2개" 표시

**확인 사항**:
- [ ] 안내 문구에 "최대 2개" 포함
- [ ] 파일 형식 및 크기 제한 안내 포함

---

### ✅ 시나리오 7: 이미지 업로드 및 저장

**단계**:
1. 이미지 2개 선택
2. 감정 선택 (예: 기쁨 😊)
3. 내용 입력 (예: "오늘 날씨가 좋아서 기분이 좋아요")
4. "저장" 버튼 클릭
5. 콘솔에서 `[uploadEmotionImage] 파일 업로드 성공` 로그 확인
6. Supabase Dashboard > Storage에서 파일 확인
7. Supabase Dashboard > `emotions` 테이블에서 `image_url` 확인
8. 홈 화면에서 기록 상세 확인 시 이미지 표시 확인

**예상 결과**: ✅ 이미지 업로드 및 저장 성공, 상세 화면에서 이미지 표시

**확인 사항**:
- [ ] Storage에 이미지 파일 저장됨
- [ ] `emotions.image_url`에 URL 저장됨
- [ ] 홈 화면 주간 달력에서 기록 클릭 시 이미지 표시
- [ ] **참고**: 현재는 첫 번째 이미지만 저장됨 (DB 스키마 제한)

---

## 테스트 체크리스트

### 기본 기능
- [ ] 시나리오 1: 이미지 0개 → 1개 추가
- [ ] 시나리오 2: 이미지 1개 → 2개 추가
- [ ] 시나리오 3: 이미지 2개 → 추가 불가
- [ ] 시나리오 4: 이미지 삭제 후 다시 추가
- [ ] 시나리오 5: 여러 파일 선택 시 슬롯 제한
- [ ] 시나리오 6: UI 안내 문구 확인
- [ ] 시나리오 7: 이미지 업로드 및 저장

### 경고 메시지
- [ ] 2개 초과 시: "이미지는 최대 2개까지 첨부할 수 있어요 ⚠️"
- [ ] 여러 파일 선택 시: "이미지는 최대 2개까지 첨부할 수 있어요. {남은개수}개만 추가되었어요. ⚠️"

### UI 확인
- [ ] 안내 문구에 "최대 2개" 표시
- [ ] 이미지 미리보기 정상 표시
- [ ] X 버튼으로 삭제 가능

---

## 예상 결과 요약

### ✅ 정상 동작
1. 이미지 0개 → 1개 추가: 성공
2. 이미지 1개 → 2개 추가: 성공
3. 이미지 2개 → 추가 시도: 경고 메시지, 추가 차단
4. 이미지 삭제 후 다시 추가: 성공
5. 여러 파일 선택: 남은 슬롯만큼만 추가, 경고 메시지
6. UI 안내 문구: "최대 2개" 표시
7. 이미지 업로드 및 저장: 성공 (첫 번째 이미지만 저장)

### ⚠️ 참고사항
- 현재 DB 스키마는 단일 이미지만 저장 (`emotions.image_url`)
- 코드는 첫 번째 이미지만 업로드 (`photos.find((p) => p.file !== null)`)
- 사용자는 최대 2개까지 선택 가능하지만, 실제로는 첫 번째 이미지만 저장됨

---

## 테스트 완료 후

### 통과한 테스트
- [ ] 시나리오 1
- [ ] 시나리오 2
- [ ] 시나리오 3
- [ ] 시나리오 4
- [ ] 시나리오 5
- [ ] 시나리오 6
- [ ] 시나리오 7

### 실패한 테스트
- [ ] [테스트 항목] - [실패 이유]

### 발견된 이슈
1. [이슈 설명]
   - 재현 단계:
   - 예상 결과:
   - 실제 결과:

---

## 다음 단계

1. [ ] 테스트 결과 기록
2. [ ] 발견된 이슈 수정
3. [ ] 재테스트 진행
4. [ ] 프로덕션 배포 준비
