# 최근 추가 기능 테스트 가이드

## 테스트 일시
- 시작: [날짜/시간]
- 종료: [날짜/시간]

## 테스트 환경
- 브라우저: Chrome/Edge
- 개발 서버: `http://localhost:5173`
- 데이터베이스: Supabase

---

## 최근 추가된 기능 목록

### 1. 이미지 업로드 2개 제한 기능
### 2. 기록 상세 화면 이미지 표시 (썸네일 스트립) ⭐ 신규
### 3. 이미지 첨부 후 저장 기능 개선

---

## 테스트 시나리오

### 시나리오 1: 이미지 업로드 2개 제한

#### 테스트 1-1: 이미지 0개 → 1개 추가
1. [ ] 기록 화면(`/record`) 접속
2. [ ] 감정 선택 (예: 기쁨)
3. [ ] 내용 입력 (5자 이상)
4. [ ] "📷 사진 추가" 버튼 클릭
5. [ ] 이미지 파일 1개 선택
6. [ ] 이미지 미리보기 1개 표시 확인
7. [ ] 안내 문구에 "최대 2개" 표시 확인: "(JPG, PNG / 10MB 이하 / 최대 2개)"
8. [ ] 저장 버튼 클릭
9. [ ] 저장 성공 확인

**예상 결과**: ✅ 이미지 1개 추가 성공, 저장 성공

#### 테스트 1-2: 이미지 1개 → 2개 추가
1. [ ] 이미지 1개가 있는 상태
2. [ ] "📷 사진 추가" 버튼 클릭
3. [ ] 이미지 파일 1개 선택
4. [ ] 이미지 미리보기 2개 표시 확인
5. [ ] 저장 버튼 클릭
6. [ ] 저장 성공 확인

**예상 결과**: ✅ 이미지 2개 추가 성공, 저장 성공

#### 테스트 1-3: 이미지 2개 → 추가 불가
1. [ ] 이미지 2개가 있는 상태
2. [ ] "📷 사진 추가" 버튼 클릭
3. [ ] 이미지 파일 선택 시도
4. [ ] 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요 ⚠️"
5. [ ] 이미지가 추가되지 않음 확인 (여전히 2개)

**예상 결과**: ✅ 경고 메시지 표시, 추가 차단

#### 테스트 1-4: 이미지 삭제 후 다시 추가
1. [ ] 이미지 2개가 있는 상태
2. [ ] 이미지 1개 삭제 (X 버튼 클릭)
3. [ ] 이미지 미리보기 1개로 감소 확인
4. [ ] "📷 사진 추가" 버튼 클릭
5. [ ] 이미지 파일 1개 선택
6. [ ] 이미지 미리보기 2개로 증가 확인
7. [ ] 저장 버튼 클릭
8. [ ] 저장 성공 확인

**예상 결과**: ✅ 삭제 후 다시 추가 가능, 저장 성공

#### 테스트 1-5: 여러 파일 선택 시 슬롯 제한
1. [ ] 이미지 1개가 있는 상태
2. [ ] "📷 사진 추가" 버튼 클릭
3. [ ] 이미지 파일 3개 동시 선택
4. [ ] 이미지 미리보기 2개만 표시 확인 (1개 추가됨)
5. [ ] 경고 메시지 확인: "이미지는 최대 2개까지 첨부할 수 있어요. 1개만 추가되었어요. ⚠️"

**예상 결과**: ✅ 남은 슬롯만큼만 추가, 경고 메시지 표시

---

### 시나리오 2: 기록 상세 화면 이미지 표시 (썸네일 스트립) ⭐ 신규

#### 테스트 2-1: 이미지가 있는 기록 상세 확인
1. [ ] 홈 화면(`/home`) 접속
2. [ ] 주간 달력에서 이미지가 있는 기록 날짜 클릭
3. [ ] 기록 상세 모달 표시 확인
4. [ ] 이미지가 썸네일 스트립 형태로 표시되는지 확인
5. [ ] 이미지 크기 확인: 60px x 60px
6. [ ] 이미지 border-radius 확인: 14px
7. [ ] 이미지 간 gap 확인: 10px
8. [ ] 입력 필드 형태의 박스 UI가 아닌지 확인
9. [ ] 이미지가 자연스럽게 배치되어 있는지 확인

**예상 결과**: ✅ 이미지가 썸네일 스트립 형태로 자연스럽게 표시

#### 테스트 2-2: 이미지가 없는 기록 상세 확인
1. [ ] 홈 화면(`/home`) 접속
2. [ ] 주간 달력에서 이미지가 없는 기록 날짜 클릭
3. [ ] 기록 상세 모달 표시 확인
4. [ ] 이미지 영역이 렌더링되지 않는지 확인

**예상 결과**: ✅ 이미지 영역이 렌더링되지 않음

#### 테스트 2-3: 이미지 hover 효과 확인
1. [ ] 이미지가 있는 기록 상세 모달 열기
2. [ ] 이미지에 마우스 호버
3. [ ] 이미지 확대 효과 확인 (scale: 1.05)
4. [ ] 그림자 효과 확인

**예상 결과**: ✅ hover 효과 정상 동작

---

### 시나리오 3: 이미지 첨부 후 저장 기능

#### 테스트 3-1: 이미지 1개 첨부 후 저장
1. [ ] 기록 화면(`/record`) 접속
2. [ ] 감정 선택 (예: 기쁨)
3. [ ] 내용 입력 (5자 이상)
4. [ ] 이미지 1개 첨부
5. [ ] 저장 버튼 클릭
6. [ ] 콘솔에서 `[Record] 이미지 업로드 성공` 로그 확인
7. [ ] 콘솔에서 `[addEmotion] insert 성공` 로그 확인
8. [ ] 400 에러가 발생하지 않는지 확인
9. [ ] 성공 토스트 메시지 확인
10. [ ] 홈 화면으로 리다이렉트 확인
11. [ ] 홈 화면에서 기록 날짜 클릭
12. [ ] 기록 상세 모달에서 이미지 표시 확인

**예상 결과**: ✅ 이미지 업로드 및 저장 성공, 상세 화면에서 이미지 표시

#### 테스트 3-2: 이미지 2개 첨부 후 저장
1. [ ] 기록 화면(`/record`) 접속
2. [ ] 감정 선택
3. [ ] 내용 입력
4. [ ] 이미지 2개 첨부
5. [ ] 저장 버튼 클릭
6. [ ] 콘솔에서 `[Record] 이미지 업로드 성공` 로그 확인
7. [ ] 콘솔에서 `[addEmotion] insert 성공` 로그 확인
8. [ ] 400 에러가 발생하지 않는지 확인
9. [ ] 성공 토스트 메시지 확인
10. [ ] 홈 화면으로 리다이렉트 확인
11. [ ] 홈 화면에서 기록 날짜 클릭
12. [ ] 기록 상세 모달에서 이미지 1개만 표시 확인 (첫 번째 이미지만 저장됨)

**예상 결과**: ✅ 이미지 업로드 및 저장 성공, 상세 화면에서 첫 번째 이미지만 표시

#### 테스트 3-3: 기록 수정 시 이미지 첨부 후 수정 완료
1. [ ] 홈 화면에서 기존 기록 날짜 클릭
2. [ ] 기록 상세 모달에서 "수정" 버튼 클릭
3. [ ] 기록 수정 화면 진입 확인
4. [ ] 기존 이미지 미리보기 확인 (있는 경우)
5. [ ] 새 이미지 1개 첨부
6. [ ] 새 이미지 미리보기 확인
7. [ ] "수정 완료" 버튼 클릭
8. [ ] 콘솔에서 `[updateEmotion] Supabase update 호출 후` 로그 확인
9. [ ] 400 에러가 발생하지 않는지 확인
10. [ ] 성공 토스트 메시지 확인
11. [ ] 홈 화면으로 리다이렉트 확인
12. [ ] 홈 화면에서 기록 날짜 클릭
13. [ ] 기록 상세 모달에서 새 이미지 표시 확인

**예상 결과**: ✅ 이미지 수정 및 저장 성공, 상세 화면에서 새 이미지 표시

---

## 테스트 체크리스트

### 이미지 업로드 2개 제한
- [ ] 테스트 1-1: 이미지 0개 → 1개 추가
- [ ] 테스트 1-2: 이미지 1개 → 2개 추가
- [ ] 테스트 1-3: 이미지 2개 → 추가 불가
- [ ] 테스트 1-4: 이미지 삭제 후 다시 추가
- [ ] 테스트 1-5: 여러 파일 선택 시 슬롯 제한

### 기록 상세 화면 이미지 표시
- [ ] 테스트 2-1: 이미지가 있는 기록 상세 확인
- [ ] 테스트 2-2: 이미지가 없는 기록 상세 확인
- [ ] 테스트 2-3: 이미지 hover 효과 확인

### 이미지 첨부 후 저장 기능
- [ ] 테스트 3-1: 이미지 1개 첨부 후 저장
- [ ] 테스트 3-2: 이미지 2개 첨부 후 저장
- [ ] 테스트 3-3: 기록 수정 시 이미지 첨부 후 수정 완료

---

## 예상 결과 요약

### ✅ 정상 동작
1. 이미지 업로드 2개 제한 정상 동작
2. 기록 상세 화면에서 이미지가 썸네일 스트립 형태로 표시
3. 이미지 첨부 후 저장 성공 (400 에러 없음)
4. 기록 수정 시 이미지 첨부 후 수정 완료 성공

### ⚠️ 참고사항
- 현재 DB 스키마는 단일 이미지만 저장 (`emotions.image_url`)
- 코드는 첫 번째 이미지만 업로드 (`photos.find((p) => p.file !== null)`)
- 사용자는 최대 2개까지 선택 가능하지만, 실제로는 첫 번째 이미지만 저장됨

---

## 테스트 완료 후

### 통과한 테스트
- [ ] 테스트 1-1
- [ ] 테스트 1-2
- [ ] 테스트 1-3
- [ ] 테스트 1-4
- [ ] 테스트 1-5
- [ ] 테스트 2-1
- [ ] 테스트 2-2
- [ ] 테스트 2-3
- [ ] 테스트 3-1
- [ ] 테스트 3-2
- [ ] 테스트 3-3

### 실패한 테스트
- [ ] [테스트 항목] - [실패 이유]

### 발견된 이슈
1. [이슈 설명]
   - 재현 단계:
   - 예상 결과:
   - 실제 결과:

---

## 다음 단계

1. [ ] 테스트 결과 기록
2. [ ] 발견된 이슈 수정
3. [ ] 재테스트 진행
4. [ ] 프로덕션 배포 준비
